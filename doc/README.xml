<?xml version="1.0" encoding="UTF-8"?>
<xpan:report xmlns:xpan="https://www.daliboris.cz/ns/xproc/analysis">
   <analysis file-name="alto.xpl"
             path="file:///V:/Projekty/Github/MZK/libri-augmentati/src/xproc/alto.xpl"
             xmlns="https://www.daliboris.cz/ns/xproc/analysis"
             xmlns:xhtml="http://www.w3.org/1999/xhtml">
      <library semver="1.0.0">
         <prolog>
            <documentation length="176">
               <xhtml:meta name="version"
                           content="1.0.0"
                           xmlns:lar="https://www.mzk.cz/ns/libri-augmentati/report/1.0"
                           xmlns:laa="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"
                           xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                           xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0"/>
               <xhtml:section xml:lang="en"
                              xmlns:lar="https://www.mzk.cz/ns/libri-augmentati/report/1.0"
                              xmlns:laa="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"
                              xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                              xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                  <xhtml:h1>Library for ALTO format manipulation</xhtml:h1>
                  <xhtml:p>Steps for standalone ALTO data operations.</xhtml:p>
               </xhtml:section>
               <xhtml:section xml:lang="cs"
                              xmlns:lar="https://www.mzk.cz/ns/libri-augmentati/report/1.0"
                              xmlns:laa="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"
                              xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                              xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                  <xhtml:h1>Knihovna pro zpracování dat ve formátu ALTO</xhtml:h1>
                  <xhtml:p>Kroky pro samostatné operace s daty ve formátu ALTO.</xhtml:p>
               </xhtml:section>
            </documentation>
            <namespaces>
               <namespace prefix="laa"
                          value="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"/>
               <namespace prefix="lad"
                          value="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"/>
               <namespace prefix="lar"
                          value="https://www.mzk.cz/ns/libri-augmentati/report/1.0"/>
               <namespace prefix="las"
                          value="https://www.mzk.cz/ns/libri-augmentati/settings/1.0"/>
               <namespace prefix="p"
                          value="http://www.w3.org/ns/xproc"/>
               <namespace prefix="xhtml"
                          value="http://www.w3.org/1999/xhtml"/>
               <namespace prefix="xs"
                          value="http://www.w3.org/2001/XMLSchema"/>
               <namespace prefix="xml"
                          value="http://www.w3.org/XML/1998/namespace"/>
            </namespaces>
         </prolog>
         <body>
            <documentation length="176">
               <xhtml:meta name="version"
                           content="1.0.0"
                           xmlns:lar="https://www.mzk.cz/ns/libri-augmentati/report/1.0"
                           xmlns:laa="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"
                           xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                           xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0"/>
               <xhtml:section xml:lang="en"
                              xmlns:lar="https://www.mzk.cz/ns/libri-augmentati/report/1.0"
                              xmlns:laa="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"
                              xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                              xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                  <xhtml:h1>Library for ALTO format manipulation</xhtml:h1>
                  <xhtml:p>Steps for standalone ALTO data operations.</xhtml:p>
               </xhtml:section>
               <xhtml:section xml:lang="cs"
                              xmlns:lar="https://www.mzk.cz/ns/libri-augmentati/report/1.0"
                              xmlns:laa="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"
                              xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                              xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                  <xhtml:h1>Knihovna pro zpracování dat ve formátu ALTO</xhtml:h1>
                  <xhtml:p>Kroky pro samostatné operace s daty ve formátu ALTO.</xhtml:p>
               </xhtml:section>
            </documentation>
            <step type="laa:combine-alto-pages"
                  name="combining-alto-pages">
               <prolog>
                  <documentation length="253">
                     <xhtml:section xml:lang="en"
                                    xmlns:lar="https://www.mzk.cz/ns/libri-augmentati/report/1.0"
                                    xmlns:laa="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Merge multiple pages</xhtml:h2>
                        <xhtml:p>Merges separate ALTO documents into one document, including metadata (styles) and textcontent (pages).</xhtml:p>
                     </xhtml:section>
                     <xhtml:section xml:lang="cs"
                                    xmlns:lar="https://www.mzk.cz/ns/libri-augmentati/report/1.0"
                                    xmlns:laa="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Spojení stran</xhtml:h2>
                        <xhtml:p>Spojí samostatné dokumenty ve formátu ALTO do jednoho dokumentu, včetně metadat (stylu) a textového obsahu (stran).</xhtml:p>
                     </xhtml:section>
                  </documentation>
                  <namespaces>
                     <namespace prefix="laa"
                                value="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"/>
                     <namespace prefix="lad"
                                value="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"/>
                     <namespace prefix="lar"
                                value="https://www.mzk.cz/ns/libri-augmentati/report/1.0"/>
                     <namespace prefix="las"
                                value="https://www.mzk.cz/ns/libri-augmentati/settings/1.0"/>
                     <namespace prefix="p"
                                value="http://www.w3.org/ns/xproc"/>
                     <namespace prefix="xhtml"
                                value="http://www.w3.org/1999/xhtml"/>
                     <namespace prefix="xs"
                                value="http://www.w3.org/2001/XMLSchema"/>
                     <namespace prefix="xml"
                                value="http://www.w3.org/XML/1998/namespace"/>
                  </namespaces>
                  <options>
                     <option name="debug-path"
                             select="()"
                             as="xs:string?"/>
                     <option name="base-uri"
                             as="xs:anyURI"
                             select="static-base-uri()"/>
                     <option name="output-directory"
                             required="true"
                             as="xs:string"/>
                  </options>
                  <ports>
                     <input port="source"
                            primary="true"
                            sequence="true"/>
                     <input port="report-in"
                            sequence="true"/>
                     <output port="result"
                             primary="true"
                             sequence="true"
                             pipe="@final"/>
                     <output port="report"
                             pipe="report-in@combining-alto-pages"/>
                  </ports>
               </prolog>
               <body>
                  <documentation length="253">
                     <xhtml:section xml:lang="en"
                                    xmlns:lar="https://www.mzk.cz/ns/libri-augmentati/report/1.0"
                                    xmlns:laa="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Merge multiple pages</xhtml:h2>
                        <xhtml:p>Merges separate ALTO documents into one document, including metadata (styles) and textcontent (pages).</xhtml:p>
                     </xhtml:section>
                     <xhtml:section xml:lang="cs"
                                    xmlns:lar="https://www.mzk.cz/ns/libri-augmentati/report/1.0"
                                    xmlns:laa="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Spojení stran</xhtml:h2>
                        <xhtml:p>Spojí samostatné dokumenty ve formátu ALTO do jednoho dokumentu, včetně metadat (stylu) a textového obsahu (stran).</xhtml:p>
                     </xhtml:section>
                  </documentation>
                  <call step="p:variable"
                        name="debug">
                     <parameter name="select"
                                value="$debug-path || '' ne ''"/>
                  </call>
                  <call step="p:variable"
                        name="debug-path-uri">
                     <parameter name="select"
                                value="resolve-uri($debug-path, $base-uri)"/>
                  </call>
                  <call step="p:variable"
                        name="library-code">
                     <parameter name="select"
                                value="/lad:document/las:library/@code"/>
                  </call>
                  <call step="p:variable"
                        name="id">
                     <parameter name="select"
                                value="if(exists(/lad:document/@nickname))    then /lad:document/@nickname     else if(starts-with(/lad:document/@id, 'uuid:'))     then substring-after(/lad:document/@id, 'uuid:')     else  /lad:document/@id"/>
                  </call>
                  <call step="p:variable"
                        name="result-directory-path">
                     <parameter name="select"
                                value="$output-directory"/>
                     <parameter name="p:documentation"
                                value="&#xA;    &#xA;     The folder where generated documents are saved. The path to the folder can be absolute or relative.&#xA;    &#xA;    &#xA;     Složka, do níž se uloží vygenerované dokumenty. Cesta ke složce může být absolutní i relativní.&#xA;    &#xA;   "/>
                  </call>
                  <call step="p:variable"
                        name="result-directory-uri">
                     <parameter name="select"
                                value="resolve-uri($result-directory-path, $base-uri)"/>
                  </call>
                  <call step="p:variable"
                        name="alto-pages">
                     <parameter name="select"
                                value="/lad:document/lad:pages[lad:page[lad:resource[@type='alto']]]"/>
                  </call>
                  <call step="p:if">
                     <parameter name="test"
                                value="$debug"/>
                     <parameter name="p:store"
                                value=""/>
                  </call>
                  <call step="p:if">
                     <parameter name="test"
                                value="exists($alto-pages)"/>
                     <parameter name="p:variable"
                                value=""/>
                     <parameter name="p:variable"
                                value=""/>
                     <parameter name="p:variable"
                                value=""/>
                     <parameter name="p:variable"
                                value=""/>
                     <parameter name="p:if"
                                value="&#xA;    &#xA;     &#xA;     &#xA;    &#xA;    &#xA;    &#xA;    &#xA;    &#xA;     &#xA;    &#xA;    &#xA;    &#xA;     &#xA;    &#xA;    &#xA;    &#xA;     &#xA;    &#xA;    &#xA;    &#xA;     &#xA;    &#xA;    &#xA;    &#xA;     &#xA;    &#xA;    &#xA;    &#xA;     &#xA;    &#xA;    &#xA;    &#xA;     &#xA;    &#xA;    &#xA;    &#xA;     &#xA;       &#xA;    &#xA;    &#xA;     &#xA;      &#xA;     &#xA;    &#xA;    &#xA;    &#xA;    &#xA;    &#xA;     &#xA;     &#xA;    &#xA;    &#xA;   "/>
                     <parameter name="p:namespace-delete"
                                value=""/>
                  </call>
                  <call step="p:identity"
                        name="final"/>
                  <call step="p:identity"
                        name="final-report">
                     <port name="source">
                        <parameter name="pipe"
                                   value="report-in@combining-alto-pages"/>
                     </port>
                  </call>
               </body>
            </step>
            <step type="laa:process-page"
                  name="processing-page">
               <prolog>
                  <documentation length="293">
                     <xhtml:section xml:lang="en"
                                    xmlns:lar="https://www.mzk.cz/ns/libri-augmentati/report/1.0"
                                    xmlns:laa="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Proces single page</xhtml:h2>
                        <xhtml:p>Aplies modifications on one ALTO document to prepare it for merging, especialy assigning unique indentifires.</xhtml:p>
                     </xhtml:section>
                     <xhtml:section xml:lang="cs"
                                    xmlns:lar="https://www.mzk.cz/ns/libri-augmentati/report/1.0"
                                    xmlns:laa="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Zpracování jedné strany</xhtml:h2>
                        <xhtml:p>Aplikuje úpravy na jeden dokument ve formátu ALTO, aby ho bylo možné spojit s ostatními, zejména jde o přiřazení jedinečných identifikátorů.</xhtml:p>
                     </xhtml:section>
                  </documentation>
                  <namespaces>
                     <namespace prefix="laa"
                                value="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"/>
                     <namespace prefix="lad"
                                value="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"/>
                     <namespace prefix="lar"
                                value="https://www.mzk.cz/ns/libri-augmentati/report/1.0"/>
                     <namespace prefix="las"
                                value="https://www.mzk.cz/ns/libri-augmentati/settings/1.0"/>
                     <namespace prefix="p"
                                value="http://www.w3.org/ns/xproc"/>
                     <namespace prefix="xhtml"
                                value="http://www.w3.org/1999/xhtml"/>
                     <namespace prefix="xs"
                                value="http://www.w3.org/2001/XMLSchema"/>
                     <namespace prefix="xml"
                                value="http://www.w3.org/XML/1998/namespace"/>
                  </namespaces>
                  <ports>
                     <input port="source"
                            primary="true"/>
                     <output port="result"
                             primary="true"/>
                  </ports>
               </prolog>
               <body>
                  <documentation length="293">
                     <xhtml:section xml:lang="en"
                                    xmlns:lar="https://www.mzk.cz/ns/libri-augmentati/report/1.0"
                                    xmlns:laa="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Proces single page</xhtml:h2>
                        <xhtml:p>Aplies modifications on one ALTO document to prepare it for merging, especialy assigning unique indentifires.</xhtml:p>
                     </xhtml:section>
                     <xhtml:section xml:lang="cs"
                                    xmlns:lar="https://www.mzk.cz/ns/libri-augmentati/report/1.0"
                                    xmlns:laa="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Zpracování jedné strany</xhtml:h2>
                        <xhtml:p>Aplikuje úpravy na jeden dokument ve formátu ALTO, aby ho bylo možné spojit s ostatními, zejména jde o přiřazení jedinečných identifikátorů.</xhtml:p>
                     </xhtml:section>
                  </documentation>
                  <call step="p:viewport">
                     <parameter name="match"
                                value="lad:page"/>
                     <parameter name="p:variable"
                                value=""/>
                     <parameter name="p:variable"
                                value=""/>
                     <parameter name="p:xslt"
                                value="&#xA;   &#xA;   &#xA;   &#xA;  "/>
                  </call>
               </body>
            </step>
         </body>
      </library>
   </analysis>
   <analysis file-name="conversion.xpl"
             path="file:///V:/Projekty/Github/MZK/libri-augmentati/src/xproc/conversion.xpl"
             xmlns="https://www.daliboris.cz/ns/xproc/analysis"
             xmlns:xhtml="http://www.w3.org/1999/xhtml">
      <library semver="1.0.0">
         <prolog>
            <documentation length="194">
               <xhtml:meta name="version"
                           content="1.0.0"
                           xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                           xmlns:lac="https://www.mzk.cz/ns/libri-augmentati/conversion/1.0"/>
               <xhtml:section xml:lang="en"
                              xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                              xmlns:lac="https://www.mzk.cz/ns/libri-augmentati/conversion/1.0">
                  <xhtml:h1>Library for data conversion</xhtml:h1>
                  <xhtml:p>Steps for standalone data operations and conversion to other formats.</xhtml:p>
               </xhtml:section>
               <xhtml:section xml:lang="cs"
                              xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                              xmlns:lac="https://www.mzk.cz/ns/libri-augmentati/conversion/1.0">
                  <xhtml:h1>Knihovna pro konverzi dat</xhtml:h1>
                  <xhtml:p>Kroky pro samostatné operace s daty a jejich převod do jiných formátů.</xhtml:p>
               </xhtml:section>
            </documentation>
            <namespaces>
               <namespace prefix="c"
                          value="http://www.w3.org/ns/xproc-step"/>
               <namespace prefix="lac"
                          value="https://www.mzk.cz/ns/libri-augmentati/conversion/1.0"/>
               <namespace prefix="lad"
                          value="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"/>
               <namespace prefix="p"
                          value="http://www.w3.org/ns/xproc"/>
               <namespace prefix="xhtml"
                          value="http://www.w3.org/1999/xhtml"/>
               <namespace prefix="xs"
                          value="http://www.w3.org/2001/XMLSchema"/>
               <namespace prefix="xml"
                          value="http://www.w3.org/XML/1998/namespace"/>
            </namespaces>
         </prolog>
         <body>
            <documentation length="194">
               <xhtml:meta name="version"
                           content="1.0.0"
                           xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                           xmlns:lac="https://www.mzk.cz/ns/libri-augmentati/conversion/1.0"/>
               <xhtml:section xml:lang="en"
                              xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                              xmlns:lac="https://www.mzk.cz/ns/libri-augmentati/conversion/1.0">
                  <xhtml:h1>Library for data conversion</xhtml:h1>
                  <xhtml:p>Steps for standalone data operations and conversion to other formats.</xhtml:p>
               </xhtml:section>
               <xhtml:section xml:lang="cs"
                              xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                              xmlns:lac="https://www.mzk.cz/ns/libri-augmentati/conversion/1.0">
                  <xhtml:h1>Knihovna pro konverzi dat</xhtml:h1>
                  <xhtml:p>Kroky pro samostatné operace s daty a jejich převod do jiných formátů.</xhtml:p>
               </xhtml:section>
            </documentation>
            <step type="lac:convert-conllu-to-tei"
                  name="converting-conllu-to-tei">
               <prolog>
                  <documentation length="174">
                     <xhtml:section xml:lang="en"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:lac="https://www.mzk.cz/ns/libri-augmentati/conversion/1.0">
                        <xhtml:h2>Convert CoNLL-U to TEI</xhtml:h2>
                        <xhtml:p>Converts <xhtml:a href="https://universaldependencies.org/docs/format.html"
                                    title="CoNLLLu">CoNLLLu</xhtml:a> data generated by <xhtml:a href="https://ufal.mff.cuni.cz/udpipe/1/users-manual"
                                    title="UDPipe">UDPipe</xhtml:a> to <xhtml:a href="https://tei-c.org/release/doc/tei-p5-doc/en/html/index.html"
                                    title="TEI">TEI P5</xhtml:a>.</xhtml:p>
                     </xhtml:section>
                     <xhtml:section xml:lang="cs"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:lac="https://www.mzk.cz/ns/libri-augmentati/conversion/1.0">
                        <xhtml:h2>Konverze CoNLL-U na TEI</xhtml:h2>
                        <xhtml:p>Převede data ve formátu <xhtml:a href="https://universaldependencies.org/docs/format.html"
                                    title="CoNLLLu">CoNLLLu</xhtml:a>, který generuje <xhtml:a href="https://ufal.mff.cuni.cz/udpipe/1/users-manual"
                                    title="UDPipe">UDPipe</xhtml:a>, do formátu <xhtml:a href="https://tei-c.org/release/doc/tei-p5-doc/en/html/index.html"
                                    title="TEI">TEI P5</xhtml:a>.</xhtml:p>
                     </xhtml:section>
                  </documentation>
                  <namespaces>
                     <namespace prefix="c"
                                value="http://www.w3.org/ns/xproc-step"/>
                     <namespace prefix="lac"
                                value="https://www.mzk.cz/ns/libri-augmentati/conversion/1.0"/>
                     <namespace prefix="lad"
                                value="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"/>
                     <namespace prefix="p"
                                value="http://www.w3.org/ns/xproc"/>
                     <namespace prefix="xhtml"
                                value="http://www.w3.org/1999/xhtml"/>
                     <namespace prefix="xs"
                                value="http://www.w3.org/2001/XMLSchema"/>
                     <namespace prefix="xml"
                                value="http://www.w3.org/XML/1998/namespace"/>
                  </namespaces>
                  <options>
                     <option name="debug-path"
                             select="()"
                             as="xs:string?"/>
                     <option name="base-uri"
                             as="xs:anyURI"
                             select="static-base-uri()"/>
                  </options>
                  <ports>
                     <input port="source"
                            primary="true"/>
                     <output port="result"
                             primary="true"/>
                  </ports>
               </prolog>
               <body>
                  <documentation length="174">
                     <xhtml:section xml:lang="en"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:lac="https://www.mzk.cz/ns/libri-augmentati/conversion/1.0">
                        <xhtml:h2>Convert CoNLL-U to TEI</xhtml:h2>
                        <xhtml:p>Converts <xhtml:a href="https://universaldependencies.org/docs/format.html"
                                    title="CoNLLLu">CoNLLLu</xhtml:a> data generated by <xhtml:a href="https://ufal.mff.cuni.cz/udpipe/1/users-manual"
                                    title="UDPipe">UDPipe</xhtml:a> to <xhtml:a href="https://tei-c.org/release/doc/tei-p5-doc/en/html/index.html"
                                    title="TEI">TEI P5</xhtml:a>.</xhtml:p>
                     </xhtml:section>
                     <xhtml:section xml:lang="cs"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:lac="https://www.mzk.cz/ns/libri-augmentati/conversion/1.0">
                        <xhtml:h2>Konverze CoNLL-U na TEI</xhtml:h2>
                        <xhtml:p>Převede data ve formátu <xhtml:a href="https://universaldependencies.org/docs/format.html"
                                    title="CoNLLLu">CoNLLLu</xhtml:a>, který generuje <xhtml:a href="https://ufal.mff.cuni.cz/udpipe/1/users-manual"
                                    title="UDPipe">UDPipe</xhtml:a>, do formátu <xhtml:a href="https://tei-c.org/release/doc/tei-p5-doc/en/html/index.html"
                                    title="TEI">TEI P5</xhtml:a>.</xhtml:p>
                     </xhtml:section>
                  </documentation>
                  <call step="p:variable"
                        name="debug">
                     <parameter name="select"
                                value="$debug-path || '' ne ''"/>
                  </call>
                  <call step="p:variable"
                        name="debug-path-uri">
                     <parameter name="select"
                                value="resolve-uri($debug-path, $base-uri)"/>
                  </call>
                  <call step="p:variable"
                        name="udpipe-text">
                     <parameter name="select"
                                value="."/>
                  </call>
                  <call step="p:xslt">
                     <parameter name="parameters"
                                value="map{'input': $udpipe-text}"/>
                     <port name="stylesheet">
                        <parameter name="href"
                                   value="../xslt/conversion/conllu-to-xml.xsl"/>
                     </port>
                  </call>
                  <call step="p:xslt">
                     <port name="stylesheet">
                        <parameter name="href"
                                   value="../xslt/conversion/conllu-xml-to-hierarchy.xsl"/>
                     </port>
                  </call>
                  <call step="p:xslt">
                     <port name="stylesheet">
                        <parameter name="href"
                                   value="../xslt/conversion/conllu-xml-hierarchy-to-tei.xsl"/>
                     </port>
                  </call>
               </body>
            </step>
            <step type="lac:convert-nametag-xml-to-tei"
                  name="converting-nametag-xml-to-tei">
               <prolog>
                  <documentation length="176">
                     <xhtml:section xml:lang="en"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:lac="https://www.mzk.cz/ns/libri-augmentati/conversion/1.0">
                        <xhtml:h2>Convert NameTag XML to TEI</xhtml:h2>
                        <xhtml:p>Converts <xhtml:a href="https://ufal.mff.cuni.cz/nametag/2/formats#output_formats"
                                    title="XML">XML</xhtml:a> data generated by <xhtml:a href="https://ufal.mff.cuni.cz/nametag/2"
                                    title="UDPipe">NameTag</xhtml:a> to <xhtml:a href="https://tei-c.org/release/doc/tei-p5-doc/en/html/index.html"
                                    title="TEI">TEI P5</xhtml:a>.</xhtml:p>
                     </xhtml:section>
                     <xhtml:section xml:lang="cs"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:lac="https://www.mzk.cz/ns/libri-augmentati/conversion/1.0">
                        <xhtml:h2>Konverze NameTag XML na TEI</xhtml:h2>
                        <xhtml:p>Převede data ve formátu <xhtml:a href="https://ufal.mff.cuni.cz/nametag/2/formats#output_formats"
                                    title="XML">XML</xhtml:a>, který generuje <xhtml:a href="https://ufal.mff.cuni.cz/nametag/2"
                                    title="UDPipe">NameTag</xhtml:a>, do formátu <xhtml:a href="https://tei-c.org/release/doc/tei-p5-doc/en/html/index.html"
                                    title="TEI">TEI P5</xhtml:a>.</xhtml:p>
                     </xhtml:section>
                  </documentation>
                  <namespaces>
                     <namespace prefix="c"
                                value="http://www.w3.org/ns/xproc-step"/>
                     <namespace prefix="lac"
                                value="https://www.mzk.cz/ns/libri-augmentati/conversion/1.0"/>
                     <namespace prefix="lad"
                                value="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"/>
                     <namespace prefix="p"
                                value="http://www.w3.org/ns/xproc"/>
                     <namespace prefix="xhtml"
                                value="http://www.w3.org/1999/xhtml"/>
                     <namespace prefix="xs"
                                value="http://www.w3.org/2001/XMLSchema"/>
                     <namespace prefix="xml"
                                value="http://www.w3.org/XML/1998/namespace"/>
                  </namespaces>
                  <options>
                     <option name="debug-path"
                             select="()"
                             as="xs:string?"/>
                     <option name="base-uri"
                             as="xs:anyURI"
                             select="static-base-uri()"/>
                  </options>
                  <ports>
                     <input port="source"
                            primary="true"/>
                     <output port="result"
                             primary="true"/>
                  </ports>
               </prolog>
               <body>
                  <documentation length="176">
                     <xhtml:section xml:lang="en"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:lac="https://www.mzk.cz/ns/libri-augmentati/conversion/1.0">
                        <xhtml:h2>Convert NameTag XML to TEI</xhtml:h2>
                        <xhtml:p>Converts <xhtml:a href="https://ufal.mff.cuni.cz/nametag/2/formats#output_formats"
                                    title="XML">XML</xhtml:a> data generated by <xhtml:a href="https://ufal.mff.cuni.cz/nametag/2"
                                    title="UDPipe">NameTag</xhtml:a> to <xhtml:a href="https://tei-c.org/release/doc/tei-p5-doc/en/html/index.html"
                                    title="TEI">TEI P5</xhtml:a>.</xhtml:p>
                     </xhtml:section>
                     <xhtml:section xml:lang="cs"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:lac="https://www.mzk.cz/ns/libri-augmentati/conversion/1.0">
                        <xhtml:h2>Konverze NameTag XML na TEI</xhtml:h2>
                        <xhtml:p>Převede data ve formátu <xhtml:a href="https://ufal.mff.cuni.cz/nametag/2/formats#output_formats"
                                    title="XML">XML</xhtml:a>, který generuje <xhtml:a href="https://ufal.mff.cuni.cz/nametag/2"
                                    title="UDPipe">NameTag</xhtml:a>, do formátu <xhtml:a href="https://tei-c.org/release/doc/tei-p5-doc/en/html/index.html"
                                    title="TEI">TEI P5</xhtml:a>.</xhtml:p>
                     </xhtml:section>
                  </documentation>
                  <call step="p:variable"
                        name="debug">
                     <parameter name="select"
                                value="$debug-path || '' ne ''"/>
                  </call>
                  <call step="p:variable"
                        name="debug-path-uri">
                     <parameter name="select"
                                value="resolve-uri($debug-path, $base-uri)"/>
                  </call>
                  <call step="p:variable"
                        name="udpipe-text">
                     <parameter name="select"
                                value="."/>
                  </call>
                  <call step="p:xslt">
                     <port name="stylesheet">
                        <parameter name="href"
                                   value="../xslt/namegtag/nametag-xml-to-tei.xsl"/>
                     </port>
                  </call>
               </body>
            </step>
            <step type="lac:convert-djvu">
               <prolog>
                  <documentation length="224">
                     <xhtml:section xml:lang="en"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:lac="https://www.mzk.cz/ns/libri-augmentati/conversion/1.0">
                        <xhtml:h2>Convert DjVu</xhtml:h2>
                        <xhtml:p>Prepares script for conversion images from one virtual document in <xhtml:a href="https://en.wikipedia.org/wiki/DjVu">DjVu</xhtml:a> format to PDF or TIFF.</xhtml:p>
                     </xhtml:section>
                     <xhtml:section xml:lang="cs"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:lac="https://www.mzk.cz/ns/libri-augmentati/conversion/1.0">
                        <xhtml:h2>Konverze DjVu</xhtml:h2>
                        <xhtml:p>Připraví skript pro konverzi obrázků z jednoho virtuálního dokumentu ve formátu <xhtml:a href="https://en.wikipedia.org/wiki/DjVu">DjVu</xhtml:a> do PDF nebo TIFF.</xhtml:p>
                     </xhtml:section>
                  </documentation>
                  <namespaces>
                     <namespace prefix="c"
                                value="http://www.w3.org/ns/xproc-step"/>
                     <namespace prefix="lac"
                                value="https://www.mzk.cz/ns/libri-augmentati/conversion/1.0"/>
                     <namespace prefix="lad"
                                value="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"/>
                     <namespace prefix="p"
                                value="http://www.w3.org/ns/xproc"/>
                     <namespace prefix="xhtml"
                                value="http://www.w3.org/1999/xhtml"/>
                     <namespace prefix="xs"
                                value="http://www.w3.org/2001/XMLSchema"/>
                     <namespace prefix="xml"
                                value="http://www.w3.org/XML/1998/namespace"/>
                  </namespaces>
                  <options>
                     <option name="debug-path"
                             select="()"
                             as="xs:string?"/>
                     <option name="base-uri"
                             as="xs:anyURI"
                             select="static-base-uri()"/>
                     <option name="main-input-directory"
                             as="xs:anyURI"
                             required="true"/>
                     <option name="main-output-directory"
                             as="xs:anyURI"
                             required="true"/>
                     <option name="output-file"
                             as="xs:string"
                             required="true"/>
                     <option name="format"
                             values="('pdf', 'tiff')"
                             select="'pdf'"/>
                     <option name="pdfbox-path"
                             as="xs:string"
                             required="true"/>
                     <option name="ddjvu-path"
                             as="xs:string"
                             required="true"/>
                  </options>
                  <ports>
                     <input port="source"
                            primary="true"
                            sequence="true"/>
                     <output port="result"
                             primary="true"
                             sequence="true"/>
                  </ports>
               </prolog>
               <body>
                  <documentation length="224">
                     <xhtml:section xml:lang="en"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:lac="https://www.mzk.cz/ns/libri-augmentati/conversion/1.0">
                        <xhtml:h2>Convert DjVu</xhtml:h2>
                        <xhtml:p>Prepares script for conversion images from one virtual document in <xhtml:a href="https://en.wikipedia.org/wiki/DjVu">DjVu</xhtml:a> format to PDF or TIFF.</xhtml:p>
                     </xhtml:section>
                     <xhtml:section xml:lang="cs"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:lac="https://www.mzk.cz/ns/libri-augmentati/conversion/1.0">
                        <xhtml:h2>Konverze DjVu</xhtml:h2>
                        <xhtml:p>Připraví skript pro konverzi obrázků z jednoho virtuálního dokumentu ve formátu <xhtml:a href="https://en.wikipedia.org/wiki/DjVu">DjVu</xhtml:a> do PDF nebo TIFF.</xhtml:p>
                     </xhtml:section>
                  </documentation>
                  <call step="p:variable"
                        name="debug">
                     <parameter name="select"
                                value="$debug-path || '' ne ''"/>
                  </call>
                  <call step="p:variable"
                        name="debug-path-uri">
                     <parameter name="select"
                                value="resolve-uri($debug-path, $base-uri)"/>
                  </call>
                  <call step="p:viewport">
                     <parameter name="match"
                                value="lad:document"/>
                     <parameter name="p:variable"
                                value=""/>
                     <parameter name="lac:convert-djvu-item"
                                value=""/>
                  </call>
               </body>
            </step>
            <step type="lac:convert-djvu-item">
               <prolog>
                  <documentation length="229">
                     <xhtml:section xml:lang="en"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:lac="https://www.mzk.cz/ns/libri-augmentati/conversion/1.0">
                        <xhtml:h2>Convert DjVu item</xhtml:h2>
                        <xhtml:p>Prepares script for conversion idividual images from folder in <xhtml:a href="https://en.wikipedia.org/wiki/DjVu">DjVu</xhtml:a> format to PDF or TIFF.</xhtml:p>
                     </xhtml:section>
                     <xhtml:section xml:lang="cs"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:lac="https://www.mzk.cz/ns/libri-augmentati/conversion/1.0">
                        <xhtml:h2>Konverze jednotlivých DjVu</xhtml:h2>
                        <xhtml:p>Připraví skript pro konverzi jednotlivých obrázků ve složce ve formátu <xhtml:a href="https://en.wikipedia.org/wiki/DjVu">DjVu</xhtml:a> do PDF nebo TIFF.</xhtml:p>
                     </xhtml:section>
                  </documentation>
                  <namespaces>
                     <namespace prefix="c"
                                value="http://www.w3.org/ns/xproc-step"/>
                     <namespace prefix="lac"
                                value="https://www.mzk.cz/ns/libri-augmentati/conversion/1.0"/>
                     <namespace prefix="lad"
                                value="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"/>
                     <namespace prefix="p"
                                value="http://www.w3.org/ns/xproc"/>
                     <namespace prefix="xhtml"
                                value="http://www.w3.org/1999/xhtml"/>
                     <namespace prefix="xs"
                                value="http://www.w3.org/2001/XMLSchema"/>
                     <namespace prefix="xml"
                                value="http://www.w3.org/XML/1998/namespace"/>
                  </namespaces>
                  <options>
                     <option name="debug-path"
                             select="()"
                             as="xs:string?"/>
                     <option name="base-uri"
                             as="xs:anyURI"
                             select="static-base-uri()"/>
                     <option name="input-directory"
                             as="xs:anyURI"
                             required="true"/>
                     <option name="output-directory"
                             as="xs:anyURI"
                             required="true"/>
                     <option name="output-file"
                             as="xs:anyURI"
                             required="true"/>
                     <option name="format"
                             values="('pdf', 'tiff')"
                             select="'pdf'"/>
                     <option name="pdfbox-path"
                             as="xs:string"
                             required="true"/>
                     <option name="ddjvu-path"
                             as="xs:string"
                             required="true"/>
                  </options>
                  <ports>
                     <input port="source"
                            sequence="true"/>
                     <output port="result"
                             primary="true"
                             sequence="true"/>
                  </ports>
               </prolog>
               <body>
                  <documentation length="229">
                     <xhtml:section xml:lang="en"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:lac="https://www.mzk.cz/ns/libri-augmentati/conversion/1.0">
                        <xhtml:h2>Convert DjVu item</xhtml:h2>
                        <xhtml:p>Prepares script for conversion idividual images from folder in <xhtml:a href="https://en.wikipedia.org/wiki/DjVu">DjVu</xhtml:a> format to PDF or TIFF.</xhtml:p>
                     </xhtml:section>
                     <xhtml:section xml:lang="cs"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:lac="https://www.mzk.cz/ns/libri-augmentati/conversion/1.0">
                        <xhtml:h2>Konverze jednotlivých DjVu</xhtml:h2>
                        <xhtml:p>Připraví skript pro konverzi jednotlivých obrázků ve složce ve formátu <xhtml:a href="https://en.wikipedia.org/wiki/DjVu">DjVu</xhtml:a> do PDF nebo TIFF.</xhtml:p>
                     </xhtml:section>
                  </documentation>
                  <call step="p:variable"
                        name="debug">
                     <parameter name="select"
                                value="$debug-path || '' ne ''"/>
                  </call>
                  <call step="p:variable"
                        name="debug-path-uri">
                     <parameter name="select"
                                value="resolve-uri($debug-path, $base-uri)"/>
                  </call>
                  <call step="p:directory-list">
                     <parameter name="path"
                                value="{$input-directory}"/>
                  </call>
                  <call step="p:for-each">
                     <port name="anonymous">
                        <parameter name="select"
                                   value="//c:file"/>
                     </port>
                  </call>
                  <call step="p:text-join"
                        name="djvu-conversion">
                     <parameter name="separator"
                                value="&#xA;"/>
                  </call>
                  <call step="p:identity">
                     <port name="source"/>
                  </call>
                  <call step="lac:fix-path"
                        name="pdf-merge">
                     <parameter name="debug-path"
                                value="{$debug-path}"/>
                     <parameter name="base-uri"
                                value="{$base-uri}"/>
                  </call>
                  <call step="p:text-join">
                     <parameter name="separator"
                                value="&#xA;"/>
                     <port name="source">
                        <parameter name="pipe"
                                   value="@djvu-conversion @pdf-merge"/>
                     </port>
                  </call>
                  <call step="p:store">
                     <parameter name="href"
                                value="{$output-file}"/>
                  </call>
                  <call step="p:file-mkdir">
                     <parameter name="href"
                                value="{$output-directory}"/>
                  </call>
               </body>
            </step>
            <step type="lac:fix-path"
                  name="fixing-path">
               <prolog>
                  <documentation length="185">
                     <xhtml:section xml:lang="en"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:lac="https://www.mzk.cz/ns/libri-augmentati/conversion/1.0">
                        <xhtml:h2>Fix path</xhtml:h2>
                        <xhtml:p>Fixes file path URI to path with backslashes if operating system is Windows.</xhtml:p>
                     </xhtml:section>
                     <xhtml:section xml:lang="cs"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:lac="https://www.mzk.cz/ns/libri-augmentati/conversion/1.0">
                        <xhtml:h2>Úprava cesty</xhtml:h2>
                        <xhtml:p>Opraví cestu k souboru na cestu se zpětnými lomítky, pokud je operační systém Windows.</xhtml:p>
                     </xhtml:section>
                  </documentation>
                  <namespaces>
                     <namespace prefix="c"
                                value="http://www.w3.org/ns/xproc-step"/>
                     <namespace prefix="lac"
                                value="https://www.mzk.cz/ns/libri-augmentati/conversion/1.0"/>
                     <namespace prefix="lad"
                                value="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"/>
                     <namespace prefix="p"
                                value="http://www.w3.org/ns/xproc"/>
                     <namespace prefix="xhtml"
                                value="http://www.w3.org/1999/xhtml"/>
                     <namespace prefix="xs"
                                value="http://www.w3.org/2001/XMLSchema"/>
                     <namespace prefix="xml"
                                value="http://www.w3.org/XML/1998/namespace"/>
                  </namespaces>
                  <options>
                     <option name="debug-path"
                             select="()"
                             as="xs:string?"/>
                     <option name="base-uri"
                             as="xs:anyURI"
                             select="static-base-uri()"/>
                  </options>
                  <ports>
                     <input port="source"/>
                     <output port="result"
                             primary="true"/>
                  </ports>
               </prolog>
               <body>
                  <documentation length="185">
                     <xhtml:section xml:lang="en"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:lac="https://www.mzk.cz/ns/libri-augmentati/conversion/1.0">
                        <xhtml:h2>Fix path</xhtml:h2>
                        <xhtml:p>Fixes file path URI to path with backslashes if operating system is Windows.</xhtml:p>
                     </xhtml:section>
                     <xhtml:section xml:lang="cs"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:lac="https://www.mzk.cz/ns/libri-augmentati/conversion/1.0">
                        <xhtml:h2>Úprava cesty</xhtml:h2>
                        <xhtml:p>Opraví cestu k souboru na cestu se zpětnými lomítky, pokud je operační systém Windows.</xhtml:p>
                     </xhtml:section>
                  </documentation>
                  <call step="p:variable"
                        name="debug">
                     <parameter name="select"
                                value="$debug-path || '' ne ''"/>
                  </call>
                  <call step="p:variable"
                        name="debug-path-uri">
                     <parameter name="select"
                                value="resolve-uri($debug-path, $base-uri)"/>
                  </call>
                  <call step="p:file-info">
                     <parameter name="href"
                                value="file:///C:/Windows"/>
                     <parameter name="fail-on-error"
                                value="false"/>
                  </call>
                  <call step="p:if">
                     <parameter name="test"
                                value="exists(/c:directory[@name='Windows'])"/>
                     <parameter name="p:text-replace"
                                value="&#xA;    &#xA;   "/>
                     <parameter name="p:text-replace"
                                value=""/>
                  </call>
               </body>
            </step>
         </body>
      </library>
   </analysis>
   <analysis file-name="enrichment.xpl"
             path="file:///V:/Projekty/Github/MZK/libri-augmentati/src/xproc/enrichment.xpl"
             xmlns="https://www.daliboris.cz/ns/xproc/analysis"
             xmlns:xhtml="http://www.w3.org/1999/xhtml">
      <library semver="1.0.0">
         <prolog>
            <documentation length="178">
               <xhtml:meta name="version"
                           content="1.0.0"
                           xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                           xmlns:lant="https://www.mzk.cz/ns/libri-augmentati/nametag/1.0"
                           xmlns:latx="https://www.mzk.cz/ns/libri-augmentati/text/1.0"
                           xmlns:laa="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"
                           xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                           xmlns:lae="https://www.mzk.cz/ns/libri-augmentati/enrichment/1.0"
                           xmlns:laud="https://www.mzk.cz/ns/libri-augmentati/udpipe/1.0"
                           xmlns:lap="https://www.mzk.cz/ns/libri-augmentati/processing/1.0"
                           xmlns:lar="https://www.mzk.cz/ns/libri-augmentati/report/1.0"
                           xmlns:lat="https://www.mzk.cz/ns/libri-augmentati/tei/1.0"
                           xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0"/>
               <xhtml:section xml:lang="en"
                              xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                              xmlns:lant="https://www.mzk.cz/ns/libri-augmentati/nametag/1.0"
                              xmlns:latx="https://www.mzk.cz/ns/libri-augmentati/text/1.0"
                              xmlns:laa="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"
                              xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                              xmlns:lae="https://www.mzk.cz/ns/libri-augmentati/enrichment/1.0"
                              xmlns:laud="https://www.mzk.cz/ns/libri-augmentati/udpipe/1.0"
                              xmlns:lap="https://www.mzk.cz/ns/libri-augmentati/processing/1.0"
                              xmlns:lar="https://www.mzk.cz/ns/libri-augmentati/report/1.0"
                              xmlns:lat="https://www.mzk.cz/ns/libri-augmentati/tei/1.0"
                              xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                  <xhtml:h1>Enrichment</xhtml:h1>
                  <xhtml:p>The main programming library for enrichment data by external (web) services.</xhtml:p>
               </xhtml:section>
               <xhtml:section xml:lang="cs"
                              xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                              xmlns:lant="https://www.mzk.cz/ns/libri-augmentati/nametag/1.0"
                              xmlns:latx="https://www.mzk.cz/ns/libri-augmentati/text/1.0"
                              xmlns:laa="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"
                              xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                              xmlns:lae="https://www.mzk.cz/ns/libri-augmentati/enrichment/1.0"
                              xmlns:laud="https://www.mzk.cz/ns/libri-augmentati/udpipe/1.0"
                              xmlns:lap="https://www.mzk.cz/ns/libri-augmentati/processing/1.0"
                              xmlns:lar="https://www.mzk.cz/ns/libri-augmentati/report/1.0"
                              xmlns:lat="https://www.mzk.cz/ns/libri-augmentati/tei/1.0"
                              xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                  <xhtml:h1>Obohacení</xhtml:h1>
                  <xhtml:p>Hlavní programová knihovna pro obohacení dat pomocí externích (webových) služeb.</xhtml:p>
               </xhtml:section>
            </documentation>
            <namespaces>
               <namespace prefix="laa"
                          value="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"/>
               <namespace prefix="lad"
                          value="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"/>
               <namespace prefix="lae"
                          value="https://www.mzk.cz/ns/libri-augmentati/enrichment/1.0"/>
               <namespace prefix="lant"
                          value="https://www.mzk.cz/ns/libri-augmentati/nametag/1.0"/>
               <namespace prefix="lap"
                          value="https://www.mzk.cz/ns/libri-augmentati/processing/1.0"/>
               <namespace prefix="lar"
                          value="https://www.mzk.cz/ns/libri-augmentati/report/1.0"/>
               <namespace prefix="las"
                          value="https://www.mzk.cz/ns/libri-augmentati/settings/1.0"/>
               <namespace prefix="lat"
                          value="https://www.mzk.cz/ns/libri-augmentati/tei/1.0"/>
               <namespace prefix="latx"
                          value="https://www.mzk.cz/ns/libri-augmentati/text/1.0"/>
               <namespace prefix="laud"
                          value="https://www.mzk.cz/ns/libri-augmentati/udpipe/1.0"/>
               <namespace prefix="lax"
                          value="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"/>
               <namespace prefix="p"
                          value="http://www.w3.org/ns/xproc"/>
               <namespace prefix="xhtml"
                          value="http://www.w3.org/1999/xhtml"/>
               <namespace prefix="xs"
                          value="http://www.w3.org/2001/XMLSchema"/>
               <namespace prefix="xml"
                          value="http://www.w3.org/XML/1998/namespace"/>
            </namespaces>
            <imports/>
         </prolog>
         <body>
            <documentation length="178">
               <xhtml:meta name="version"
                           content="1.0.0"
                           xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                           xmlns:lant="https://www.mzk.cz/ns/libri-augmentati/nametag/1.0"
                           xmlns:latx="https://www.mzk.cz/ns/libri-augmentati/text/1.0"
                           xmlns:laa="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"
                           xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                           xmlns:lae="https://www.mzk.cz/ns/libri-augmentati/enrichment/1.0"
                           xmlns:laud="https://www.mzk.cz/ns/libri-augmentati/udpipe/1.0"
                           xmlns:lap="https://www.mzk.cz/ns/libri-augmentati/processing/1.0"
                           xmlns:lar="https://www.mzk.cz/ns/libri-augmentati/report/1.0"
                           xmlns:lat="https://www.mzk.cz/ns/libri-augmentati/tei/1.0"
                           xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0"/>
               <xhtml:section xml:lang="en"
                              xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                              xmlns:lant="https://www.mzk.cz/ns/libri-augmentati/nametag/1.0"
                              xmlns:latx="https://www.mzk.cz/ns/libri-augmentati/text/1.0"
                              xmlns:laa="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"
                              xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                              xmlns:lae="https://www.mzk.cz/ns/libri-augmentati/enrichment/1.0"
                              xmlns:laud="https://www.mzk.cz/ns/libri-augmentati/udpipe/1.0"
                              xmlns:lap="https://www.mzk.cz/ns/libri-augmentati/processing/1.0"
                              xmlns:lar="https://www.mzk.cz/ns/libri-augmentati/report/1.0"
                              xmlns:lat="https://www.mzk.cz/ns/libri-augmentati/tei/1.0"
                              xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                  <xhtml:h1>Enrichment</xhtml:h1>
                  <xhtml:p>The main programming library for enrichment data by external (web) services.</xhtml:p>
               </xhtml:section>
               <xhtml:section xml:lang="cs"
                              xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                              xmlns:lant="https://www.mzk.cz/ns/libri-augmentati/nametag/1.0"
                              xmlns:latx="https://www.mzk.cz/ns/libri-augmentati/text/1.0"
                              xmlns:laa="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"
                              xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                              xmlns:lae="https://www.mzk.cz/ns/libri-augmentati/enrichment/1.0"
                              xmlns:laud="https://www.mzk.cz/ns/libri-augmentati/udpipe/1.0"
                              xmlns:lap="https://www.mzk.cz/ns/libri-augmentati/processing/1.0"
                              xmlns:lar="https://www.mzk.cz/ns/libri-augmentati/report/1.0"
                              xmlns:lat="https://www.mzk.cz/ns/libri-augmentati/tei/1.0"
                              xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                  <xhtml:h1>Obohacení</xhtml:h1>
                  <xhtml:p>Hlavní programová knihovna pro obohacení dat pomocí externích (webových) služeb.</xhtml:p>
               </xhtml:section>
            </documentation>
            <step type="lae:enrich-data"
                  name="enriching-data">
               <prolog>
                  <documentation length="155">
                     <xhtml:section xml:lang="en"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:lant="https://www.mzk.cz/ns/libri-augmentati/nametag/1.0"
                                    xmlns:latx="https://www.mzk.cz/ns/libri-augmentati/text/1.0"
                                    xmlns:laa="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:lae="https://www.mzk.cz/ns/libri-augmentati/enrichment/1.0"
                                    xmlns:laud="https://www.mzk.cz/ns/libri-augmentati/udpipe/1.0"
                                    xmlns:lap="https://www.mzk.cz/ns/libri-augmentati/processing/1.0"
                                    xmlns:lar="https://www.mzk.cz/ns/libri-augmentati/report/1.0"
                                    xmlns:lat="https://www.mzk.cz/ns/libri-augmentati/tei/1.0"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Enrich available data</xhtml:h2>
                        <xhtml:p>Enriches available (textual) data by selected fetures.</xhtml:p>
                     </xhtml:section>
                     <xhtml:section xml:lang="cs"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:lant="https://www.mzk.cz/ns/libri-augmentati/nametag/1.0"
                                    xmlns:latx="https://www.mzk.cz/ns/libri-augmentati/text/1.0"
                                    xmlns:laa="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:lae="https://www.mzk.cz/ns/libri-augmentati/enrichment/1.0"
                                    xmlns:laud="https://www.mzk.cz/ns/libri-augmentati/udpipe/1.0"
                                    xmlns:lap="https://www.mzk.cz/ns/libri-augmentati/processing/1.0"
                                    xmlns:lar="https://www.mzk.cz/ns/libri-augmentati/report/1.0"
                                    xmlns:lat="https://www.mzk.cz/ns/libri-augmentati/tei/1.0"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Obohacení dostupných dat</xhtml:h2>
                        <xhtml:p>Obohatí dostupná (textová) data o vybrané vlastnosti.</xhtml:p>
                     </xhtml:section>
                  </documentation>
                  <namespaces>
                     <namespace prefix="laa"
                                value="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"/>
                     <namespace prefix="lad"
                                value="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"/>
                     <namespace prefix="lae"
                                value="https://www.mzk.cz/ns/libri-augmentati/enrichment/1.0"/>
                     <namespace prefix="lant"
                                value="https://www.mzk.cz/ns/libri-augmentati/nametag/1.0"/>
                     <namespace prefix="lap"
                                value="https://www.mzk.cz/ns/libri-augmentati/processing/1.0"/>
                     <namespace prefix="lar"
                                value="https://www.mzk.cz/ns/libri-augmentati/report/1.0"/>
                     <namespace prefix="las"
                                value="https://www.mzk.cz/ns/libri-augmentati/settings/1.0"/>
                     <namespace prefix="lat"
                                value="https://www.mzk.cz/ns/libri-augmentati/tei/1.0"/>
                     <namespace prefix="latx"
                                value="https://www.mzk.cz/ns/libri-augmentati/text/1.0"/>
                     <namespace prefix="laud"
                                value="https://www.mzk.cz/ns/libri-augmentati/udpipe/1.0"/>
                     <namespace prefix="lax"
                                value="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"/>
                     <namespace prefix="p"
                                value="http://www.w3.org/ns/xproc"/>
                     <namespace prefix="xhtml"
                                value="http://www.w3.org/1999/xhtml"/>
                     <namespace prefix="xs"
                                value="http://www.w3.org/2001/XMLSchema"/>
                     <namespace prefix="xml"
                                value="http://www.w3.org/XML/1998/namespace"/>
                  </namespaces>
                  <options>
                     <option name="debug-path"
                             select="()"
                             as="xs:string?"/>
                     <option name="base-uri"
                             as="xs:anyURI"
                             select="static-base-uri()"/>
                     <option name="output-directory"
                             required="true"
                             as="xs:string"/>
                     <option name="pause-before-request"
                             select="2"
                             as="xs:integer"/>
                     <option name="output-format"
                             values="('ALTO', 'TEI', 'TEXT')"
                             as="xs:string*"/>
                     <option name="enrichment"
                             values="('ENTITIES', 'MORPHOLOGY')"
                             as="xs:string*"/>
                  </options>
                  <ports>
                     <input port="source"
                            primary="true"
                            sequence="true"/>
                     <input port="settings"
                            primary="false"/>
                     <input port="report-in"
                            sequence="true"/>
                     <output port="result"
                             primary="true"
                             sequence="true"/>
                     <output port="report"
                             pipe="report-in@enriching-data"/>
                  </ports>
               </prolog>
               <body>
                  <documentation length="155">
                     <xhtml:section xml:lang="en"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:lant="https://www.mzk.cz/ns/libri-augmentati/nametag/1.0"
                                    xmlns:latx="https://www.mzk.cz/ns/libri-augmentati/text/1.0"
                                    xmlns:laa="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:lae="https://www.mzk.cz/ns/libri-augmentati/enrichment/1.0"
                                    xmlns:laud="https://www.mzk.cz/ns/libri-augmentati/udpipe/1.0"
                                    xmlns:lap="https://www.mzk.cz/ns/libri-augmentati/processing/1.0"
                                    xmlns:lar="https://www.mzk.cz/ns/libri-augmentati/report/1.0"
                                    xmlns:lat="https://www.mzk.cz/ns/libri-augmentati/tei/1.0"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Enrich available data</xhtml:h2>
                        <xhtml:p>Enriches available (textual) data by selected fetures.</xhtml:p>
                     </xhtml:section>
                     <xhtml:section xml:lang="cs"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:lant="https://www.mzk.cz/ns/libri-augmentati/nametag/1.0"
                                    xmlns:latx="https://www.mzk.cz/ns/libri-augmentati/text/1.0"
                                    xmlns:laa="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:lae="https://www.mzk.cz/ns/libri-augmentati/enrichment/1.0"
                                    xmlns:laud="https://www.mzk.cz/ns/libri-augmentati/udpipe/1.0"
                                    xmlns:lap="https://www.mzk.cz/ns/libri-augmentati/processing/1.0"
                                    xmlns:lar="https://www.mzk.cz/ns/libri-augmentati/report/1.0"
                                    xmlns:lat="https://www.mzk.cz/ns/libri-augmentati/tei/1.0"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Obohacení dostupných dat</xhtml:h2>
                        <xhtml:p>Obohatí dostupná (textová) data o vybrané vlastnosti.</xhtml:p>
                     </xhtml:section>
                  </documentation>
                  <call step="p:identity"/>
                  <call step="p:if">
                     <parameter name="test"
                                value="$output-format = 'TEXT'"/>
                     <parameter name="lae:combine-text-pages"
                                value="&#xA;    &#xA;    &#xA;   "/>
                  </call>
                  <call step="p:if">
                     <parameter name="test"
                                value="$output-format = 'ALTO'"/>
                     <parameter name="lae:combine-alto-pages"
                                value="&#xA;    &#xA;    &#xA;   "/>
                  </call>
                  <call step="p:identity"/>
                  <call step="p:identity"/>
                  <call step="p:if">
                     <parameter name="test"
                                value="$enrichment = ('ENTITIES', 'MORPHOLOGY')"/>
                     <parameter name="lae:tokenize"
                                value="&#xA;    &#xA;    &#xA;   "/>
                     <parameter name="p:if"
                                value="&#xA;    &#xA;     &#xA;     &#xA;    &#xA;   "/>
                     <parameter name="p:if"
                                value="&#xA;    &#xA;     &#xA;     &#xA;    &#xA;   "/>
                  </call>
                  <call step="p:if">
                     <parameter name="test"
                                value="$output-format = 'TEI'"/>
                     <parameter name="lae:convert-to-tei"
                                value="&#xA;    &#xA;    &#xA;   "/>
                  </call>
               </body>
            </step>
            <step type="lae:tokenize"
                  name="tokenizing">
               <prolog>
                  <documentation length="179">
                     <xhtml:section xml:lang="en"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:lant="https://www.mzk.cz/ns/libri-augmentati/nametag/1.0"
                                    xmlns:latx="https://www.mzk.cz/ns/libri-augmentati/text/1.0"
                                    xmlns:laa="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:lae="https://www.mzk.cz/ns/libri-augmentati/enrichment/1.0"
                                    xmlns:laud="https://www.mzk.cz/ns/libri-augmentati/udpipe/1.0"
                                    xmlns:lap="https://www.mzk.cz/ns/libri-augmentati/processing/1.0"
                                    xmlns:lar="https://www.mzk.cz/ns/libri-augmentati/report/1.0"
                                    xmlns:lat="https://www.mzk.cz/ns/libri-augmentati/tei/1.0"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Tokenize the text</xhtml:h2>
                        <xhtml:p>Apply tokenization on text using morphological and syntactic analysis.</xhtml:p>
                     </xhtml:section>
                     <xhtml:section xml:lang="cs"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:lant="https://www.mzk.cz/ns/libri-augmentati/nametag/1.0"
                                    xmlns:latx="https://www.mzk.cz/ns/libri-augmentati/text/1.0"
                                    xmlns:laa="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:lae="https://www.mzk.cz/ns/libri-augmentati/enrichment/1.0"
                                    xmlns:laud="https://www.mzk.cz/ns/libri-augmentati/udpipe/1.0"
                                    xmlns:lap="https://www.mzk.cz/ns/libri-augmentati/processing/1.0"
                                    xmlns:lar="https://www.mzk.cz/ns/libri-augmentati/report/1.0"
                                    xmlns:lat="https://www.mzk.cz/ns/libri-augmentati/tei/1.0"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Tokenizace textu</xhtml:h2>
                        <xhtml:p>Rozdělí vstupní text na tokeny pomocí morfologické a syntaktické analýzy.</xhtml:p>
                     </xhtml:section>
                  </documentation>
                  <namespaces>
                     <namespace prefix="laa"
                                value="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"/>
                     <namespace prefix="lad"
                                value="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"/>
                     <namespace prefix="lae"
                                value="https://www.mzk.cz/ns/libri-augmentati/enrichment/1.0"/>
                     <namespace prefix="lant"
                                value="https://www.mzk.cz/ns/libri-augmentati/nametag/1.0"/>
                     <namespace prefix="lap"
                                value="https://www.mzk.cz/ns/libri-augmentati/processing/1.0"/>
                     <namespace prefix="lar"
                                value="https://www.mzk.cz/ns/libri-augmentati/report/1.0"/>
                     <namespace prefix="las"
                                value="https://www.mzk.cz/ns/libri-augmentati/settings/1.0"/>
                     <namespace prefix="lat"
                                value="https://www.mzk.cz/ns/libri-augmentati/tei/1.0"/>
                     <namespace prefix="latx"
                                value="https://www.mzk.cz/ns/libri-augmentati/text/1.0"/>
                     <namespace prefix="laud"
                                value="https://www.mzk.cz/ns/libri-augmentati/udpipe/1.0"/>
                     <namespace prefix="lax"
                                value="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"/>
                     <namespace prefix="p"
                                value="http://www.w3.org/ns/xproc"/>
                     <namespace prefix="xhtml"
                                value="http://www.w3.org/1999/xhtml"/>
                     <namespace prefix="xs"
                                value="http://www.w3.org/2001/XMLSchema"/>
                     <namespace prefix="xml"
                                value="http://www.w3.org/XML/1998/namespace"/>
                  </namespaces>
                  <options>
                     <option name="debug-path"
                             select="()"
                             as="xs:string?"/>
                     <option name="base-uri"
                             as="xs:anyURI"
                             select="static-base-uri()"/>
                     <option name="output-directory"
                             required="true"
                             as="xs:string"/>
                  </options>
                  <ports>
                     <input port="source"
                            primary="true"
                            sequence="true"/>
                     <input port="settings"
                            primary="false"/>
                     <input port="report-in"/>
                     <output port="result"
                             primary="true"
                             sequence="true"
                             pipe="result@final"/>
                     <output port="report"
                             pipe="result@report-final"/>
                  </ports>
               </prolog>
               <body>
                  <documentation length="179">
                     <xhtml:section xml:lang="en"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:lant="https://www.mzk.cz/ns/libri-augmentati/nametag/1.0"
                                    xmlns:latx="https://www.mzk.cz/ns/libri-augmentati/text/1.0"
                                    xmlns:laa="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:lae="https://www.mzk.cz/ns/libri-augmentati/enrichment/1.0"
                                    xmlns:laud="https://www.mzk.cz/ns/libri-augmentati/udpipe/1.0"
                                    xmlns:lap="https://www.mzk.cz/ns/libri-augmentati/processing/1.0"
                                    xmlns:lar="https://www.mzk.cz/ns/libri-augmentati/report/1.0"
                                    xmlns:lat="https://www.mzk.cz/ns/libri-augmentati/tei/1.0"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Tokenize the text</xhtml:h2>
                        <xhtml:p>Apply tokenization on text using morphological and syntactic analysis.</xhtml:p>
                     </xhtml:section>
                     <xhtml:section xml:lang="cs"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:lant="https://www.mzk.cz/ns/libri-augmentati/nametag/1.0"
                                    xmlns:latx="https://www.mzk.cz/ns/libri-augmentati/text/1.0"
                                    xmlns:laa="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:lae="https://www.mzk.cz/ns/libri-augmentati/enrichment/1.0"
                                    xmlns:laud="https://www.mzk.cz/ns/libri-augmentati/udpipe/1.0"
                                    xmlns:lap="https://www.mzk.cz/ns/libri-augmentati/processing/1.0"
                                    xmlns:lar="https://www.mzk.cz/ns/libri-augmentati/report/1.0"
                                    xmlns:lat="https://www.mzk.cz/ns/libri-augmentati/tei/1.0"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Tokenizace textu</xhtml:h2>
                        <xhtml:p>Rozdělí vstupní text na tokeny pomocí morfologické a syntaktické analýzy.</xhtml:p>
                     </xhtml:section>
                  </documentation>
                  <call step="p:variable"
                        name="debug">
                     <parameter name="select"
                                value="$debug-path || '' ne ''"/>
                  </call>
                  <call step="p:variable"
                        name="debug-path-uri">
                     <parameter name="select"
                                value="resolve-uri($debug-path, $base-uri)"/>
                  </call>
                  <call step="p:insert"
                        name="report-start">
                     <parameter name="position"
                                value="last-child"/>
                     <port name="source">
                        <parameter name="pipe"
                                   value="report-in@tokenizing"/>
                     </port>
                     <port name="insertion"/>
                  </call>
                  <call step="p:viewport">
                     <parameter name="match"
                                value="lad:document"/>
                     <port name="anonymous">
                        <parameter name="pipe"
                                   value="source@tokenizing"/>
                     </port>
                     <parameter name="p:variable"
                                value=""/>
                     <parameter name="laud:get-udpipe-tokens"
                                value="&#xA;    &#xA;    &#xA;   "/>
                  </call>
                  <call step="p:namespace-delete">
                     <parameter name="prefixes"
                                value="laud xs xhtml"/>
                  </call>
                  <call step="p:identity"
                        name="final"/>
                  <call step="p:add-attribute"
                        name="report-final">
                     <parameter name="match"
                                value="lax:step[@type='lae:tokenize'][not(@end)]"/>
                     <parameter name="attribute-name"
                                value="end"/>
                     <parameter name="attribute-value"
                                value="{current-dateTime()}"/>
                     <port name="source">
                        <parameter name="pipe"
                                   value="result@report-start"/>
                     </port>
                  </call>
               </body>
            </step>
            <step type="lae:enrich-by-entities"
                  name="enriching-by-entities">
               <prolog>
                  <documentation length="144">
                     <xhtml:section xml:lang="en"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:lant="https://www.mzk.cz/ns/libri-augmentati/nametag/1.0"
                                    xmlns:latx="https://www.mzk.cz/ns/libri-augmentati/text/1.0"
                                    xmlns:laa="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:lae="https://www.mzk.cz/ns/libri-augmentati/enrichment/1.0"
                                    xmlns:laud="https://www.mzk.cz/ns/libri-augmentati/udpipe/1.0"
                                    xmlns:lap="https://www.mzk.cz/ns/libri-augmentati/processing/1.0"
                                    xmlns:lar="https://www.mzk.cz/ns/libri-augmentati/report/1.0"
                                    xmlns:lat="https://www.mzk.cz/ns/libri-augmentati/tei/1.0"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Enrich by entities</xhtml:h2>
                        <xhtml:p>Enriches available (textual) data by named entities.</xhtml:p>
                     </xhtml:section>
                     <xhtml:section xml:lang="cs"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:lant="https://www.mzk.cz/ns/libri-augmentati/nametag/1.0"
                                    xmlns:latx="https://www.mzk.cz/ns/libri-augmentati/text/1.0"
                                    xmlns:laa="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:lae="https://www.mzk.cz/ns/libri-augmentati/enrichment/1.0"
                                    xmlns:laud="https://www.mzk.cz/ns/libri-augmentati/udpipe/1.0"
                                    xmlns:lap="https://www.mzk.cz/ns/libri-augmentati/processing/1.0"
                                    xmlns:lar="https://www.mzk.cz/ns/libri-augmentati/report/1.0"
                                    xmlns:lat="https://www.mzk.cz/ns/libri-augmentati/tei/1.0"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Obohacení o entity</xhtml:h2>
                        <xhtml:p>Obohatí dostupná (textová) data o pojmenované entity.</xhtml:p>
                     </xhtml:section>
                  </documentation>
                  <namespaces>
                     <namespace prefix="laa"
                                value="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"/>
                     <namespace prefix="lad"
                                value="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"/>
                     <namespace prefix="lae"
                                value="https://www.mzk.cz/ns/libri-augmentati/enrichment/1.0"/>
                     <namespace prefix="lant"
                                value="https://www.mzk.cz/ns/libri-augmentati/nametag/1.0"/>
                     <namespace prefix="lap"
                                value="https://www.mzk.cz/ns/libri-augmentati/processing/1.0"/>
                     <namespace prefix="lar"
                                value="https://www.mzk.cz/ns/libri-augmentati/report/1.0"/>
                     <namespace prefix="las"
                                value="https://www.mzk.cz/ns/libri-augmentati/settings/1.0"/>
                     <namespace prefix="lat"
                                value="https://www.mzk.cz/ns/libri-augmentati/tei/1.0"/>
                     <namespace prefix="latx"
                                value="https://www.mzk.cz/ns/libri-augmentati/text/1.0"/>
                     <namespace prefix="laud"
                                value="https://www.mzk.cz/ns/libri-augmentati/udpipe/1.0"/>
                     <namespace prefix="lax"
                                value="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"/>
                     <namespace prefix="p"
                                value="http://www.w3.org/ns/xproc"/>
                     <namespace prefix="xhtml"
                                value="http://www.w3.org/1999/xhtml"/>
                     <namespace prefix="xs"
                                value="http://www.w3.org/2001/XMLSchema"/>
                     <namespace prefix="xml"
                                value="http://www.w3.org/XML/1998/namespace"/>
                  </namespaces>
                  <options>
                     <option name="debug-path"
                             select="()"
                             as="xs:string?"/>
                     <option name="base-uri"
                             as="xs:anyURI"
                             select="static-base-uri()"/>
                     <option name="output-directory"
                             required="true"
                             as="xs:string"/>
                  </options>
                  <ports>
                     <input port="source"
                            primary="true"
                            sequence="true"/>
                     <input port="settings"
                            primary="false"/>
                     <input port="report-in"/>
                     <output port="result"
                             primary="true"
                             sequence="true"
                             pipe="result@final"/>
                     <output port="report"
                             pipe="result@report-final"/>
                  </ports>
               </prolog>
               <body>
                  <documentation length="144">
                     <xhtml:section xml:lang="en"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:lant="https://www.mzk.cz/ns/libri-augmentati/nametag/1.0"
                                    xmlns:latx="https://www.mzk.cz/ns/libri-augmentati/text/1.0"
                                    xmlns:laa="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:lae="https://www.mzk.cz/ns/libri-augmentati/enrichment/1.0"
                                    xmlns:laud="https://www.mzk.cz/ns/libri-augmentati/udpipe/1.0"
                                    xmlns:lap="https://www.mzk.cz/ns/libri-augmentati/processing/1.0"
                                    xmlns:lar="https://www.mzk.cz/ns/libri-augmentati/report/1.0"
                                    xmlns:lat="https://www.mzk.cz/ns/libri-augmentati/tei/1.0"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Enrich by entities</xhtml:h2>
                        <xhtml:p>Enriches available (textual) data by named entities.</xhtml:p>
                     </xhtml:section>
                     <xhtml:section xml:lang="cs"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:lant="https://www.mzk.cz/ns/libri-augmentati/nametag/1.0"
                                    xmlns:latx="https://www.mzk.cz/ns/libri-augmentati/text/1.0"
                                    xmlns:laa="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:lae="https://www.mzk.cz/ns/libri-augmentati/enrichment/1.0"
                                    xmlns:laud="https://www.mzk.cz/ns/libri-augmentati/udpipe/1.0"
                                    xmlns:lap="https://www.mzk.cz/ns/libri-augmentati/processing/1.0"
                                    xmlns:lar="https://www.mzk.cz/ns/libri-augmentati/report/1.0"
                                    xmlns:lat="https://www.mzk.cz/ns/libri-augmentati/tei/1.0"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Obohacení o entity</xhtml:h2>
                        <xhtml:p>Obohatí dostupná (textová) data o pojmenované entity.</xhtml:p>
                     </xhtml:section>
                  </documentation>
                  <call step="p:variable"
                        name="debug">
                     <parameter name="select"
                                value="$debug-path || '' ne ''"/>
                  </call>
                  <call step="p:variable"
                        name="debug-path-uri">
                     <parameter name="select"
                                value="resolve-uri($debug-path, $base-uri)"/>
                  </call>
                  <call step="p:insert"
                        name="report-start">
                     <parameter name="position"
                                value="last-child"/>
                     <port name="source">
                        <parameter name="pipe"
                                   value="report-in@enriching-by-entities"/>
                     </port>
                     <port name="insertion"/>
                  </call>
                  <call step="p:viewport">
                     <parameter name="match"
                                value="lad:document"/>
                     <port name="anonymous">
                        <parameter name="pipe"
                                   value="source@enriching-by-entities"/>
                     </port>
                     <parameter name="p:variable"
                                value=""/>
                     <parameter name="lant:get-nametag-analyses"
                                value="&#xA;    &#xA;    &#xA;   "/>
                  </call>
                  <call step="p:namespace-delete">
                     <parameter name="prefixes"
                                value="lant xs xhtml"/>
                  </call>
                  <call step="p:identity"
                        name="final"/>
                  <call step="p:add-attribute"
                        name="report-final">
                     <parameter name="match"
                                value="lax:step[@type='lae:enrich-by-entities'][not(@end)]"/>
                     <parameter name="attribute-name"
                                value="end"/>
                     <parameter name="attribute-value"
                                value="{current-dateTime()}"/>
                     <port name="source">
                        <parameter name="pipe"
                                   value="result@report-start"/>
                     </port>
                  </call>
               </body>
            </step>
            <step type="lae:enrich-by-morphology"
                  name="enriching-by-morphology">
               <prolog>
                  <documentation length="186">
                     <xhtml:section xml:lang="en"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:lant="https://www.mzk.cz/ns/libri-augmentati/nametag/1.0"
                                    xmlns:latx="https://www.mzk.cz/ns/libri-augmentati/text/1.0"
                                    xmlns:laa="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:lae="https://www.mzk.cz/ns/libri-augmentati/enrichment/1.0"
                                    xmlns:laud="https://www.mzk.cz/ns/libri-augmentati/udpipe/1.0"
                                    xmlns:lap="https://www.mzk.cz/ns/libri-augmentati/processing/1.0"
                                    xmlns:lar="https://www.mzk.cz/ns/libri-augmentati/report/1.0"
                                    xmlns:lat="https://www.mzk.cz/ns/libri-augmentati/tei/1.0"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Enrich by morphology</xhtml:h2>
                        <xhtml:p>Enriches available (textual) data by morphological and syntactic analysis.</xhtml:p>
                     </xhtml:section>
                     <xhtml:section xml:lang="cs"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:lant="https://www.mzk.cz/ns/libri-augmentati/nametag/1.0"
                                    xmlns:latx="https://www.mzk.cz/ns/libri-augmentati/text/1.0"
                                    xmlns:laa="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:lae="https://www.mzk.cz/ns/libri-augmentati/enrichment/1.0"
                                    xmlns:laud="https://www.mzk.cz/ns/libri-augmentati/udpipe/1.0"
                                    xmlns:lap="https://www.mzk.cz/ns/libri-augmentati/processing/1.0"
                                    xmlns:lar="https://www.mzk.cz/ns/libri-augmentati/report/1.0"
                                    xmlns:lat="https://www.mzk.cz/ns/libri-augmentati/tei/1.0"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Obohacení o entity</xhtml:h2>
                        <xhtml:p>Obohatí dostupná (textová) data o morfologickou a syntaktickou analýzu.</xhtml:p>
                     </xhtml:section>
                  </documentation>
                  <namespaces>
                     <namespace prefix="laa"
                                value="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"/>
                     <namespace prefix="lad"
                                value="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"/>
                     <namespace prefix="lae"
                                value="https://www.mzk.cz/ns/libri-augmentati/enrichment/1.0"/>
                     <namespace prefix="lant"
                                value="https://www.mzk.cz/ns/libri-augmentati/nametag/1.0"/>
                     <namespace prefix="lap"
                                value="https://www.mzk.cz/ns/libri-augmentati/processing/1.0"/>
                     <namespace prefix="lar"
                                value="https://www.mzk.cz/ns/libri-augmentati/report/1.0"/>
                     <namespace prefix="las"
                                value="https://www.mzk.cz/ns/libri-augmentati/settings/1.0"/>
                     <namespace prefix="lat"
                                value="https://www.mzk.cz/ns/libri-augmentati/tei/1.0"/>
                     <namespace prefix="latx"
                                value="https://www.mzk.cz/ns/libri-augmentati/text/1.0"/>
                     <namespace prefix="laud"
                                value="https://www.mzk.cz/ns/libri-augmentati/udpipe/1.0"/>
                     <namespace prefix="lax"
                                value="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"/>
                     <namespace prefix="p"
                                value="http://www.w3.org/ns/xproc"/>
                     <namespace prefix="xhtml"
                                value="http://www.w3.org/1999/xhtml"/>
                     <namespace prefix="xs"
                                value="http://www.w3.org/2001/XMLSchema"/>
                     <namespace prefix="xml"
                                value="http://www.w3.org/XML/1998/namespace"/>
                  </namespaces>
                  <options>
                     <option name="debug-path"
                             select="()"
                             as="xs:string?"/>
                     <option name="base-uri"
                             as="xs:anyURI"
                             select="static-base-uri()"/>
                     <option name="output-directory"
                             required="true"
                             as="xs:string"/>
                  </options>
                  <ports>
                     <input port="source"
                            primary="true"
                            sequence="true"/>
                     <input port="settings"
                            primary="false"/>
                     <input port="report-in"/>
                     <output port="result"
                             primary="true"
                             sequence="true"
                             pipe="result@final"/>
                     <output port="report"
                             pipe="result@report-final"/>
                  </ports>
               </prolog>
               <body>
                  <documentation length="186">
                     <xhtml:section xml:lang="en"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:lant="https://www.mzk.cz/ns/libri-augmentati/nametag/1.0"
                                    xmlns:latx="https://www.mzk.cz/ns/libri-augmentati/text/1.0"
                                    xmlns:laa="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:lae="https://www.mzk.cz/ns/libri-augmentati/enrichment/1.0"
                                    xmlns:laud="https://www.mzk.cz/ns/libri-augmentati/udpipe/1.0"
                                    xmlns:lap="https://www.mzk.cz/ns/libri-augmentati/processing/1.0"
                                    xmlns:lar="https://www.mzk.cz/ns/libri-augmentati/report/1.0"
                                    xmlns:lat="https://www.mzk.cz/ns/libri-augmentati/tei/1.0"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Enrich by morphology</xhtml:h2>
                        <xhtml:p>Enriches available (textual) data by morphological and syntactic analysis.</xhtml:p>
                     </xhtml:section>
                     <xhtml:section xml:lang="cs"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:lant="https://www.mzk.cz/ns/libri-augmentati/nametag/1.0"
                                    xmlns:latx="https://www.mzk.cz/ns/libri-augmentati/text/1.0"
                                    xmlns:laa="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:lae="https://www.mzk.cz/ns/libri-augmentati/enrichment/1.0"
                                    xmlns:laud="https://www.mzk.cz/ns/libri-augmentati/udpipe/1.0"
                                    xmlns:lap="https://www.mzk.cz/ns/libri-augmentati/processing/1.0"
                                    xmlns:lar="https://www.mzk.cz/ns/libri-augmentati/report/1.0"
                                    xmlns:lat="https://www.mzk.cz/ns/libri-augmentati/tei/1.0"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Obohacení o entity</xhtml:h2>
                        <xhtml:p>Obohatí dostupná (textová) data o morfologickou a syntaktickou analýzu.</xhtml:p>
                     </xhtml:section>
                  </documentation>
                  <call step="p:variable"
                        name="debug">
                     <parameter name="select"
                                value="$debug-path || '' ne ''"/>
                  </call>
                  <call step="p:variable"
                        name="debug-path-uri">
                     <parameter name="select"
                                value="resolve-uri($debug-path, $base-uri)"/>
                  </call>
                  <call step="p:insert"
                        name="report-start">
                     <parameter name="position"
                                value="last-child"/>
                     <port name="source">
                        <parameter name="pipe"
                                   value="report-in@enriching-by-morphology"/>
                     </port>
                     <port name="insertion"/>
                  </call>
                  <call step="p:viewport">
                     <parameter name="match"
                                value="lad:document"/>
                     <port name="anonymous">
                        <parameter name="pipe"
                                   value="source@enriching-by-morphology"/>
                     </port>
                     <parameter name="p:variable"
                                value=""/>
                     <parameter name="laud:get-udpipe-analyses"
                                value="&#xA;    &#xA;    &#xA;   "/>
                  </call>
                  <call step="p:namespace-delete">
                     <parameter name="prefixes"
                                value="laud xs xhtml"/>
                  </call>
                  <call step="p:identity"
                        name="final"/>
                  <call step="p:add-attribute"
                        name="report-final">
                     <parameter name="match"
                                value="lax:step[@type='lae:enrich-by-morphology'][not(@end)]"/>
                     <parameter name="attribute-name"
                                value="end"/>
                     <parameter name="attribute-value"
                                value="{current-dateTime()}"/>
                     <port name="source">
                        <parameter name="pipe"
                                   value="result@report-start"/>
                     </port>
                  </call>
               </body>
            </step>
            <step type="lae:convert-to-tei"
                  name="converting-to-tei">
               <prolog>
                  <documentation length="156">
                     <xhtml:section xml:lang="en"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:lant="https://www.mzk.cz/ns/libri-augmentati/nametag/1.0"
                                    xmlns:latx="https://www.mzk.cz/ns/libri-augmentati/text/1.0"
                                    xmlns:laa="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:lae="https://www.mzk.cz/ns/libri-augmentati/enrichment/1.0"
                                    xmlns:laud="https://www.mzk.cz/ns/libri-augmentati/udpipe/1.0"
                                    xmlns:lap="https://www.mzk.cz/ns/libri-augmentati/processing/1.0"
                                    xmlns:lar="https://www.mzk.cz/ns/libri-augmentati/report/1.0"
                                    xmlns:lat="https://www.mzk.cz/ns/libri-augmentati/tei/1.0"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Convert to TEI</xhtml:h2>
                        <xhtml:p>Converts available (enriched textual) data to TEI P5 format.</xhtml:p>
                     </xhtml:section>
                     <xhtml:section xml:lang="cs"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:lant="https://www.mzk.cz/ns/libri-augmentati/nametag/1.0"
                                    xmlns:latx="https://www.mzk.cz/ns/libri-augmentati/text/1.0"
                                    xmlns:laa="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:lae="https://www.mzk.cz/ns/libri-augmentati/enrichment/1.0"
                                    xmlns:laud="https://www.mzk.cz/ns/libri-augmentati/udpipe/1.0"
                                    xmlns:lap="https://www.mzk.cz/ns/libri-augmentati/processing/1.0"
                                    xmlns:lar="https://www.mzk.cz/ns/libri-augmentati/report/1.0"
                                    xmlns:lat="https://www.mzk.cz/ns/libri-augmentati/tei/1.0"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Konverze do TEI</xhtml:h2>
                        <xhtml:p>Zkonvertuje dostupná (obohacená textová) data do formátu TEI P5.</xhtml:p>
                     </xhtml:section>
                  </documentation>
                  <namespaces>
                     <namespace prefix="laa"
                                value="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"/>
                     <namespace prefix="lad"
                                value="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"/>
                     <namespace prefix="lae"
                                value="https://www.mzk.cz/ns/libri-augmentati/enrichment/1.0"/>
                     <namespace prefix="lant"
                                value="https://www.mzk.cz/ns/libri-augmentati/nametag/1.0"/>
                     <namespace prefix="lap"
                                value="https://www.mzk.cz/ns/libri-augmentati/processing/1.0"/>
                     <namespace prefix="lar"
                                value="https://www.mzk.cz/ns/libri-augmentati/report/1.0"/>
                     <namespace prefix="las"
                                value="https://www.mzk.cz/ns/libri-augmentati/settings/1.0"/>
                     <namespace prefix="lat"
                                value="https://www.mzk.cz/ns/libri-augmentati/tei/1.0"/>
                     <namespace prefix="latx"
                                value="https://www.mzk.cz/ns/libri-augmentati/text/1.0"/>
                     <namespace prefix="laud"
                                value="https://www.mzk.cz/ns/libri-augmentati/udpipe/1.0"/>
                     <namespace prefix="lax"
                                value="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"/>
                     <namespace prefix="p"
                                value="http://www.w3.org/ns/xproc"/>
                     <namespace prefix="xhtml"
                                value="http://www.w3.org/1999/xhtml"/>
                     <namespace prefix="xs"
                                value="http://www.w3.org/2001/XMLSchema"/>
                     <namespace prefix="xml"
                                value="http://www.w3.org/XML/1998/namespace"/>
                  </namespaces>
                  <options>
                     <option name="debug-path"
                             select="()"
                             as="xs:string?"/>
                     <option name="base-uri"
                             as="xs:anyURI"
                             select="static-base-uri()"/>
                     <option name="output-directory"
                             required="true"
                             as="xs:string"/>
                  </options>
                  <ports>
                     <input port="source"
                            primary="true"
                            sequence="true"/>
                     <input port="settings"
                            primary="false"/>
                     <input port="report-in"/>
                     <output port="result"
                             primary="true"
                             sequence="true"
                             pipe="result@final"/>
                     <output port="report"
                             pipe="result@report-final"/>
                  </ports>
               </prolog>
               <body>
                  <documentation length="156">
                     <xhtml:section xml:lang="en"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:lant="https://www.mzk.cz/ns/libri-augmentati/nametag/1.0"
                                    xmlns:latx="https://www.mzk.cz/ns/libri-augmentati/text/1.0"
                                    xmlns:laa="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:lae="https://www.mzk.cz/ns/libri-augmentati/enrichment/1.0"
                                    xmlns:laud="https://www.mzk.cz/ns/libri-augmentati/udpipe/1.0"
                                    xmlns:lap="https://www.mzk.cz/ns/libri-augmentati/processing/1.0"
                                    xmlns:lar="https://www.mzk.cz/ns/libri-augmentati/report/1.0"
                                    xmlns:lat="https://www.mzk.cz/ns/libri-augmentati/tei/1.0"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Convert to TEI</xhtml:h2>
                        <xhtml:p>Converts available (enriched textual) data to TEI P5 format.</xhtml:p>
                     </xhtml:section>
                     <xhtml:section xml:lang="cs"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:lant="https://www.mzk.cz/ns/libri-augmentati/nametag/1.0"
                                    xmlns:latx="https://www.mzk.cz/ns/libri-augmentati/text/1.0"
                                    xmlns:laa="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:lae="https://www.mzk.cz/ns/libri-augmentati/enrichment/1.0"
                                    xmlns:laud="https://www.mzk.cz/ns/libri-augmentati/udpipe/1.0"
                                    xmlns:lap="https://www.mzk.cz/ns/libri-augmentati/processing/1.0"
                                    xmlns:lar="https://www.mzk.cz/ns/libri-augmentati/report/1.0"
                                    xmlns:lat="https://www.mzk.cz/ns/libri-augmentati/tei/1.0"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Konverze do TEI</xhtml:h2>
                        <xhtml:p>Zkonvertuje dostupná (obohacená textová) data do formátu TEI P5.</xhtml:p>
                     </xhtml:section>
                  </documentation>
                  <call step="p:variable"
                        name="debug">
                     <parameter name="select"
                                value="$debug-path || '' ne ''"/>
                  </call>
                  <call step="p:variable"
                        name="debug-path-uri">
                     <parameter name="select"
                                value="resolve-uri($debug-path, $base-uri)"/>
                  </call>
                  <call step="p:variable"
                        name="step-name">
                     <parameter name="select"
                                value="'lat:convert-to-tei'"/>
                  </call>
                  <call step="p:insert"
                        name="report-start">
                     <parameter name="position"
                                value="last-child"/>
                     <port name="source">
                        <parameter name="pipe"
                                   value="report-in@converting-to-tei"/>
                     </port>
                     <port name="insertion"/>
                  </call>
                  <call step="p:viewport">
                     <parameter name="match"
                                value="lad:document"/>
                     <port name="anonymous">
                        <parameter name="pipe"
                                   value="source@converting-to-tei"/>
                     </port>
                     <parameter name="p:variable"
                                value=""/>
                     <parameter name="lat:convert-to-tei"
                                value="&#xA;    &#xA;   "/>
                  </call>
                  <call step="p:namespace-delete">
                     <parameter name="prefixes"
                                value="lat xs xhtml"/>
                  </call>
                  <call step="p:identity"
                        name="final"/>
                  <call step="p:variable"
                        name="step-name">
                     <parameter name="select"
                                value="'lat:convert-to-tei'"/>
                  </call>
                  <call step="p:add-attribute"
                        name="report-final">
                     <parameter name="match"
                                value="lax:step[@type='lat:convert-to-tei'][not(@end)]"/>
                     <parameter name="attribute-name"
                                value="end"/>
                     <parameter name="attribute-value"
                                value="{current-dateTime()}"/>
                     <port name="source">
                        <parameter name="pipe"
                                   value="result@report-start"/>
                     </port>
                  </call>
               </body>
            </step>
            <step type="lae:combine-text-pages"
                  name="combining-text-pages">
               <prolog>
                  <documentation length="140">
                     <xhtml:section xml:lang="en"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:lant="https://www.mzk.cz/ns/libri-augmentati/nametag/1.0"
                                    xmlns:latx="https://www.mzk.cz/ns/libri-augmentati/text/1.0"
                                    xmlns:laa="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:lae="https://www.mzk.cz/ns/libri-augmentati/enrichment/1.0"
                                    xmlns:laud="https://www.mzk.cz/ns/libri-augmentati/udpipe/1.0"
                                    xmlns:lap="https://www.mzk.cz/ns/libri-augmentati/processing/1.0"
                                    xmlns:lar="https://www.mzk.cz/ns/libri-augmentati/report/1.0"
                                    xmlns:lat="https://www.mzk.cz/ns/libri-augmentati/tei/1.0"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Combine text pages</xhtml:h2>
                        <xhtml:p>Combines available pages to one document.</xhtml:p>
                     </xhtml:section>
                     <xhtml:section xml:lang="cs"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:lant="https://www.mzk.cz/ns/libri-augmentati/nametag/1.0"
                                    xmlns:latx="https://www.mzk.cz/ns/libri-augmentati/text/1.0"
                                    xmlns:laa="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:lae="https://www.mzk.cz/ns/libri-augmentati/enrichment/1.0"
                                    xmlns:laud="https://www.mzk.cz/ns/libri-augmentati/udpipe/1.0"
                                    xmlns:lap="https://www.mzk.cz/ns/libri-augmentati/processing/1.0"
                                    xmlns:lar="https://www.mzk.cz/ns/libri-augmentati/report/1.0"
                                    xmlns:lat="https://www.mzk.cz/ns/libri-augmentati/tei/1.0"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Sloučení textových stránek</xhtml:h2>
                        <xhtml:p>Sloučí text dostupných stránek do jednoho dokumentu.</xhtml:p>
                     </xhtml:section>
                  </documentation>
                  <namespaces>
                     <namespace prefix="laa"
                                value="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"/>
                     <namespace prefix="lad"
                                value="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"/>
                     <namespace prefix="lae"
                                value="https://www.mzk.cz/ns/libri-augmentati/enrichment/1.0"/>
                     <namespace prefix="lant"
                                value="https://www.mzk.cz/ns/libri-augmentati/nametag/1.0"/>
                     <namespace prefix="lap"
                                value="https://www.mzk.cz/ns/libri-augmentati/processing/1.0"/>
                     <namespace prefix="lar"
                                value="https://www.mzk.cz/ns/libri-augmentati/report/1.0"/>
                     <namespace prefix="las"
                                value="https://www.mzk.cz/ns/libri-augmentati/settings/1.0"/>
                     <namespace prefix="lat"
                                value="https://www.mzk.cz/ns/libri-augmentati/tei/1.0"/>
                     <namespace prefix="latx"
                                value="https://www.mzk.cz/ns/libri-augmentati/text/1.0"/>
                     <namespace prefix="laud"
                                value="https://www.mzk.cz/ns/libri-augmentati/udpipe/1.0"/>
                     <namespace prefix="lax"
                                value="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"/>
                     <namespace prefix="p"
                                value="http://www.w3.org/ns/xproc"/>
                     <namespace prefix="xhtml"
                                value="http://www.w3.org/1999/xhtml"/>
                     <namespace prefix="xs"
                                value="http://www.w3.org/2001/XMLSchema"/>
                     <namespace prefix="xml"
                                value="http://www.w3.org/XML/1998/namespace"/>
                  </namespaces>
                  <options>
                     <option name="debug-path"
                             select="()"
                             as="xs:string?"/>
                     <option name="base-uri"
                             as="xs:anyURI"
                             select="static-base-uri()"/>
                     <option name="output-directory"
                             required="true"
                             as="xs:string"/>
                  </options>
                  <ports>
                     <input port="source"
                            primary="true"
                            sequence="true"/>
                     <input port="settings"
                            primary="false"/>
                     <input port="report-in"/>
                     <output port="result"
                             primary="true"
                             sequence="true"
                             pipe="result@final"/>
                     <output port="report"
                             pipe="result@report-final"/>
                  </ports>
               </prolog>
               <body>
                  <documentation length="140">
                     <xhtml:section xml:lang="en"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:lant="https://www.mzk.cz/ns/libri-augmentati/nametag/1.0"
                                    xmlns:latx="https://www.mzk.cz/ns/libri-augmentati/text/1.0"
                                    xmlns:laa="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:lae="https://www.mzk.cz/ns/libri-augmentati/enrichment/1.0"
                                    xmlns:laud="https://www.mzk.cz/ns/libri-augmentati/udpipe/1.0"
                                    xmlns:lap="https://www.mzk.cz/ns/libri-augmentati/processing/1.0"
                                    xmlns:lar="https://www.mzk.cz/ns/libri-augmentati/report/1.0"
                                    xmlns:lat="https://www.mzk.cz/ns/libri-augmentati/tei/1.0"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Combine text pages</xhtml:h2>
                        <xhtml:p>Combines available pages to one document.</xhtml:p>
                     </xhtml:section>
                     <xhtml:section xml:lang="cs"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:lant="https://www.mzk.cz/ns/libri-augmentati/nametag/1.0"
                                    xmlns:latx="https://www.mzk.cz/ns/libri-augmentati/text/1.0"
                                    xmlns:laa="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:lae="https://www.mzk.cz/ns/libri-augmentati/enrichment/1.0"
                                    xmlns:laud="https://www.mzk.cz/ns/libri-augmentati/udpipe/1.0"
                                    xmlns:lap="https://www.mzk.cz/ns/libri-augmentati/processing/1.0"
                                    xmlns:lar="https://www.mzk.cz/ns/libri-augmentati/report/1.0"
                                    xmlns:lat="https://www.mzk.cz/ns/libri-augmentati/tei/1.0"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Sloučení textových stránek</xhtml:h2>
                        <xhtml:p>Sloučí text dostupných stránek do jednoho dokumentu.</xhtml:p>
                     </xhtml:section>
                  </documentation>
                  <call step="p:variable"
                        name="debug">
                     <parameter name="select"
                                value="$debug-path || '' ne ''"/>
                  </call>
                  <call step="p:variable"
                        name="debug-path-uri">
                     <parameter name="select"
                                value="resolve-uri($debug-path, $base-uri)"/>
                  </call>
                  <call step="p:insert"
                        name="report-start">
                     <parameter name="position"
                                value="last-child"/>
                     <port name="source">
                        <parameter name="pipe"
                                   value="report-in@combining-text-pages"/>
                     </port>
                     <port name="insertion"/>
                  </call>
                  <call step="p:viewport">
                     <parameter name="match"
                                value="lad:document"/>
                     <port name="anonymous">
                        <parameter name="pipe"
                                   value="source@combining-text-pages"/>
                     </port>
                     <parameter name="p:variable"
                                value=""/>
                     <parameter name="latx:combine-text-pages"
                                value="&#xA;    &#xA;   "/>
                  </call>
                  <call step="p:namespace-delete">
                     <parameter name="prefixes"
                                value="lat xs xhtml"/>
                  </call>
                  <call step="p:identity"
                        name="final"/>
                  <call step="p:add-attribute"
                        name="report-final">
                     <parameter name="match"
                                value="lax:step[@type='lae:enrich-by-entities'][not(@end)]"/>
                     <parameter name="attribute-name"
                                value="end"/>
                     <parameter name="attribute-value"
                                value="{current-dateTime()}"/>
                     <port name="source">
                        <parameter name="pipe"
                                   value="result@report-start"/>
                     </port>
                  </call>
               </body>
            </step>
            <step type="lae:combine-alto-pages"
                  name="combining-alto-pages">
               <prolog>
                  <documentation length="156">
                     <xhtml:section xml:lang="en"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:lant="https://www.mzk.cz/ns/libri-augmentati/nametag/1.0"
                                    xmlns:latx="https://www.mzk.cz/ns/libri-augmentati/text/1.0"
                                    xmlns:laa="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:lae="https://www.mzk.cz/ns/libri-augmentati/enrichment/1.0"
                                    xmlns:laud="https://www.mzk.cz/ns/libri-augmentati/udpipe/1.0"
                                    xmlns:lap="https://www.mzk.cz/ns/libri-augmentati/processing/1.0"
                                    xmlns:lar="https://www.mzk.cz/ns/libri-augmentati/report/1.0"
                                    xmlns:lat="https://www.mzk.cz/ns/libri-augmentati/tei/1.0"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Combine pages in ALTO format</xhtml:h2>
                        <xhtml:p>Combines available pages to one document.</xhtml:p>
                     </xhtml:section>
                     <xhtml:section xml:lang="cs"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:lant="https://www.mzk.cz/ns/libri-augmentati/nametag/1.0"
                                    xmlns:latx="https://www.mzk.cz/ns/libri-augmentati/text/1.0"
                                    xmlns:laa="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:lae="https://www.mzk.cz/ns/libri-augmentati/enrichment/1.0"
                                    xmlns:laud="https://www.mzk.cz/ns/libri-augmentati/udpipe/1.0"
                                    xmlns:lap="https://www.mzk.cz/ns/libri-augmentati/processing/1.0"
                                    xmlns:lar="https://www.mzk.cz/ns/libri-augmentati/report/1.0"
                                    xmlns:lat="https://www.mzk.cz/ns/libri-augmentati/tei/1.0"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Sloučení stránek ve formátu ALTO</xhtml:h2>
                        <xhtml:p>Sloučí text dostupných stránek do jednoho dokumentu.</xhtml:p>
                     </xhtml:section>
                  </documentation>
                  <namespaces>
                     <namespace prefix="laa"
                                value="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"/>
                     <namespace prefix="lad"
                                value="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"/>
                     <namespace prefix="lae"
                                value="https://www.mzk.cz/ns/libri-augmentati/enrichment/1.0"/>
                     <namespace prefix="lant"
                                value="https://www.mzk.cz/ns/libri-augmentati/nametag/1.0"/>
                     <namespace prefix="lap"
                                value="https://www.mzk.cz/ns/libri-augmentati/processing/1.0"/>
                     <namespace prefix="lar"
                                value="https://www.mzk.cz/ns/libri-augmentati/report/1.0"/>
                     <namespace prefix="las"
                                value="https://www.mzk.cz/ns/libri-augmentati/settings/1.0"/>
                     <namespace prefix="lat"
                                value="https://www.mzk.cz/ns/libri-augmentati/tei/1.0"/>
                     <namespace prefix="latx"
                                value="https://www.mzk.cz/ns/libri-augmentati/text/1.0"/>
                     <namespace prefix="laud"
                                value="https://www.mzk.cz/ns/libri-augmentati/udpipe/1.0"/>
                     <namespace prefix="lax"
                                value="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"/>
                     <namespace prefix="p"
                                value="http://www.w3.org/ns/xproc"/>
                     <namespace prefix="xhtml"
                                value="http://www.w3.org/1999/xhtml"/>
                     <namespace prefix="xs"
                                value="http://www.w3.org/2001/XMLSchema"/>
                     <namespace prefix="xml"
                                value="http://www.w3.org/XML/1998/namespace"/>
                  </namespaces>
                  <options>
                     <option name="debug-path"
                             select="()"
                             as="xs:string?"/>
                     <option name="base-uri"
                             as="xs:anyURI"
                             select="static-base-uri()"/>
                     <option name="output-directory"
                             required="true"
                             as="xs:string"/>
                  </options>
                  <ports>
                     <input port="source"
                            primary="true"
                            sequence="true"/>
                     <input port="settings"
                            primary="false"/>
                     <input port="report-in"/>
                     <output port="result"
                             primary="true"
                             sequence="true"
                             pipe="result@final"/>
                     <output port="report"
                             pipe="result@report-final"/>
                  </ports>
               </prolog>
               <body>
                  <documentation length="156">
                     <xhtml:section xml:lang="en"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:lant="https://www.mzk.cz/ns/libri-augmentati/nametag/1.0"
                                    xmlns:latx="https://www.mzk.cz/ns/libri-augmentati/text/1.0"
                                    xmlns:laa="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:lae="https://www.mzk.cz/ns/libri-augmentati/enrichment/1.0"
                                    xmlns:laud="https://www.mzk.cz/ns/libri-augmentati/udpipe/1.0"
                                    xmlns:lap="https://www.mzk.cz/ns/libri-augmentati/processing/1.0"
                                    xmlns:lar="https://www.mzk.cz/ns/libri-augmentati/report/1.0"
                                    xmlns:lat="https://www.mzk.cz/ns/libri-augmentati/tei/1.0"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Combine pages in ALTO format</xhtml:h2>
                        <xhtml:p>Combines available pages to one document.</xhtml:p>
                     </xhtml:section>
                     <xhtml:section xml:lang="cs"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:lant="https://www.mzk.cz/ns/libri-augmentati/nametag/1.0"
                                    xmlns:latx="https://www.mzk.cz/ns/libri-augmentati/text/1.0"
                                    xmlns:laa="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:lae="https://www.mzk.cz/ns/libri-augmentati/enrichment/1.0"
                                    xmlns:laud="https://www.mzk.cz/ns/libri-augmentati/udpipe/1.0"
                                    xmlns:lap="https://www.mzk.cz/ns/libri-augmentati/processing/1.0"
                                    xmlns:lar="https://www.mzk.cz/ns/libri-augmentati/report/1.0"
                                    xmlns:lat="https://www.mzk.cz/ns/libri-augmentati/tei/1.0"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Sloučení stránek ve formátu ALTO</xhtml:h2>
                        <xhtml:p>Sloučí text dostupných stránek do jednoho dokumentu.</xhtml:p>
                     </xhtml:section>
                  </documentation>
                  <call step="p:variable"
                        name="debug">
                     <parameter name="select"
                                value="$debug-path || '' ne ''"/>
                  </call>
                  <call step="p:variable"
                        name="debug-path-uri">
                     <parameter name="select"
                                value="resolve-uri($debug-path, $base-uri)"/>
                  </call>
                  <call step="p:insert"
                        name="report-start">
                     <parameter name="position"
                                value="last-child"/>
                     <port name="source">
                        <parameter name="pipe"
                                   value="report-in@combining-alto-pages"/>
                     </port>
                     <port name="insertion"/>
                  </call>
                  <call step="p:viewport">
                     <parameter name="match"
                                value="lad:document"/>
                     <port name="anonymous">
                        <parameter name="pipe"
                                   value="source@combining-alto-pages"/>
                     </port>
                     <parameter name="p:variable"
                                value=""/>
                     <parameter name="laa:combine-alto-pages"
                                value="&#xA;    &#xA;   "/>
                  </call>
                  <call step="p:namespace-delete">
                     <parameter name="prefixes"
                                value="lat xs xhtml"/>
                  </call>
                  <call step="p:identity"
                        name="final"/>
                  <call step="p:add-attribute"
                        name="report-final">
                     <parameter name="match"
                                value="lax:step[@type='laa:combine-alto-pages'][not(@end)]"/>
                     <parameter name="attribute-name"
                                value="end"/>
                     <parameter name="attribute-value"
                                value="{current-dateTime()}"/>
                     <port name="source">
                        <parameter name="pipe"
                                   value="result@report-start"/>
                     </port>
                  </call>
               </body>
            </step>
         </body>
      </library>
   </analysis>
   <analysis file-name="kramerius-5.xpl"
             path="file:///V:/Projekty/Github/MZK/libri-augmentati/src/xproc/kramerius-5.xpl"
             xmlns="https://www.daliboris.cz/ns/xproc/analysis"
             xmlns:xhtml="http://www.w3.org/1999/xhtml">
      <library semver="1.0.0">
         <prolog>
            <documentation length="166">
               <xhtml:meta name="version"
                           content="1.0.0"
                           xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                           xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                           xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                           xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                           xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                           xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0"/>
               <xhtml:section xml:lang="en"
                              xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                              xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                              xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                              xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                              xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                              xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                  <xhtml:h1>Kramerius 5</xhtml:h1>
                  <xhtml:p>Programming library for communication with the system <xhtml:a href="https://system-kramerius.cz/en">Kramerius</xhtml:a>, <xhtml:a href="https://github.com/ceskaexpedice/kramerius/wiki/ClientAPIDEV">version 5</xhtml:a>.</xhtml:p>
               </xhtml:section>
               <xhtml:section xml:lang="cs"
                              xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                              xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                              xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                              xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                              xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                              xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                  <xhtml:h1>Kramerius 5</xhtml:h1>
                  <xhtml:p>Programová knihovna pro komunikaci se systémem <xhtml:a href="https://system-kramerius.cz">Kramerius</xhtml:a>, <xhtml:a href="https://github.com/ceskaexpedice/kramerius/wiki/ClientAPIDEV">verze 5</xhtml:a>.</xhtml:p>
               </xhtml:section>
            </documentation>
            <namespaces>
               <namespace prefix="array"
                          value="http://www.w3.org/2005/xpath-functions/array"/>
               <namespace prefix="lad"
                          value="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"/>
               <namespace prefix="las"
                          value="https://www.mzk.cz/ns/libri-augmentati/settings/1.0"/>
               <namespace prefix="lax"
                          value="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"/>
               <namespace prefix="map"
                          value="http://www.w3.org/2005/xpath-functions/map"/>
               <namespace prefix="p"
                          value="http://www.w3.org/ns/xproc"/>
               <namespace prefix="xhtml"
                          value="http://www.w3.org/1999/xhtml"/>
               <namespace prefix="xlog"
                          value="https://www.daliboris.cz/ns/xproc/logging/1.0"/>
               <namespace prefix="xs"
                          value="http://www.w3.org/2001/XMLSchema"/>
               <namespace prefix="xml"
                          value="http://www.w3.org/XML/1998/namespace"/>
            </namespaces>
            <options/>
         </prolog>
         <body>
            <documentation length="166">
               <xhtml:meta name="version"
                           content="1.0.0"
                           xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                           xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                           xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                           xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                           xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                           xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0"/>
               <xhtml:section xml:lang="en"
                              xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                              xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                              xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                              xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                              xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                              xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                  <xhtml:h1>Kramerius 5</xhtml:h1>
                  <xhtml:p>Programming library for communication with the system <xhtml:a href="https://system-kramerius.cz/en">Kramerius</xhtml:a>, <xhtml:a href="https://github.com/ceskaexpedice/kramerius/wiki/ClientAPIDEV">version 5</xhtml:a>.</xhtml:p>
               </xhtml:section>
               <xhtml:section xml:lang="cs"
                              xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                              xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                              xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                              xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                              xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                              xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                  <xhtml:h1>Kramerius 5</xhtml:h1>
                  <xhtml:p>Programová knihovna pro komunikaci se systémem <xhtml:a href="https://system-kramerius.cz">Kramerius</xhtml:a>, <xhtml:a href="https://github.com/ceskaexpedice/kramerius/wiki/ClientAPIDEV">verze 5</xhtml:a>.</xhtml:p>
               </xhtml:section>
            </documentation>
            <step type="lax:get-virtual-document-metadata-v5"
                  name="getting-virtual-document-metadata">
               <prolog>
                  <documentation length="495">
                     <xhtml:section xml:lang="en"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                                    xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Get virtual document metadata</xhtml:h2>
                        <xhtml:p>Gathers all requested metadata about the publication. Creates the content of the virtual document with links to all requested resources.</xhtml:p>
                        <xhtml:p>Enhance input data by adding requested resources on the document and page level.</xhtml:p>
                     </xhtml:section>
                     <xhtml:section xml:lang="cs"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                                    xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Získání metadat virtuálního dokumentu</xhtml:h2>
                        <xhtml:p>Shromáždí všechna požadovaná metadata o publikaci. Vytvoří strukturu virutálního dokumentu s odkazy na všechny požadované zdroje.</xhtml:p>
                        <xhtml:p>Obohatí vstupní data přidáním požadovaných zdrojů na úrovni dokumentu a strany.</xhtml:p>
                     </xhtml:section>
                  </documentation>
                  <namespaces>
                     <namespace prefix="array"
                                value="http://www.w3.org/2005/xpath-functions/array"/>
                     <namespace prefix="lad"
                                value="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"/>
                     <namespace prefix="las"
                                value="https://www.mzk.cz/ns/libri-augmentati/settings/1.0"/>
                     <namespace prefix="lax"
                                value="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"/>
                     <namespace prefix="map"
                                value="http://www.w3.org/2005/xpath-functions/map"/>
                     <namespace prefix="p"
                                value="http://www.w3.org/ns/xproc"/>
                     <namespace prefix="xhtml"
                                value="http://www.w3.org/1999/xhtml"/>
                     <namespace prefix="xlog"
                                value="https://www.daliboris.cz/ns/xproc/logging/1.0"/>
                     <namespace prefix="xs"
                                value="http://www.w3.org/2001/XMLSchema"/>
                     <namespace prefix="xml"
                                value="http://www.w3.org/XML/1998/namespace"/>
                  </namespaces>
                  <options>
                     <option name="debug-path"
                             select="()"
                             as="xs:string?"/>
                     <option name="base-uri"
                             as="xs:anyURI"
                             select="static-base-uri()"/>
                  </options>
                  <ports>
                     <input port="source"
                            primary="true"/>
                     <output port="result"
                             primary="true"/>
                  </ports>
               </prolog>
               <body>
                  <documentation length="495">
                     <xhtml:section xml:lang="en"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                                    xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Get virtual document metadata</xhtml:h2>
                        <xhtml:p>Gathers all requested metadata about the publication. Creates the content of the virtual document with links to all requested resources.</xhtml:p>
                        <xhtml:p>Enhance input data by adding requested resources on the document and page level.</xhtml:p>
                     </xhtml:section>
                     <xhtml:section xml:lang="cs"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                                    xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Získání metadat virtuálního dokumentu</xhtml:h2>
                        <xhtml:p>Shromáždí všechna požadovaná metadata o publikaci. Vytvoří strukturu virutálního dokumentu s odkazy na všechny požadované zdroje.</xhtml:p>
                        <xhtml:p>Obohatí vstupní data přidáním požadovaných zdrojů na úrovni dokumentu a strany.</xhtml:p>
                     </xhtml:section>
                  </documentation>
                  <call step="p:variable"
                        name="debug">
                     <parameter name="select"
                                value="$debug-path || '' ne ''"/>
                  </call>
                  <call step="p:variable"
                        name="debug-path-uri">
                     <parameter name="select"
                                value="resolve-uri($debug-path, $base-uri)"/>
                  </call>
                  <call step="p:variable"
                        name="base-url">
                     <parameter name="select"
                                value="/lad:document/lad:options/@base-url"/>
                  </call>
                  <call step="p:variable"
                        name="id">
                     <parameter name="select"
                                value="/lad:document/@id"/>
                  </call>
                  <call step="p:variable"
                        name="guid">
                     <parameter name="select"
                                value="substring-after(/lad:document/@id, ':')"/>
                  </call>
                  <call step="p:variable"
                        name="url">
                     <parameter name="select"
                                value="concat($base-url, '/item/', $id, '/children')"/>
                  </call>
                  <call step="p:insert">
                     <parameter name="match"
                                value="/lad:document"/>
                     <parameter name="position"
                                value="last-child"/>
                     <port name="insertion"/>
                  </call>
                  <call step="p:identity"
                        name="document-with-resources"/>
                  <call step="lax:get-virtual-document-pages">
                     <parameter name="url"
                                value="{$url}"/>
                     <parameter name="document-id"
                                value="{$guid}"/>
                     <parameter name="debug-path"
                                value="{$debug-path}"/>
                     <parameter name="base-uri"
                                value="{$base-uri}"/>
                  </call>
                  <call step="lax:get-available-formats">
                     <parameter name="base-url"
                                value="{$base-url}"/>
                     <parameter name="debug-path"
                                value="{$debug-path}"/>
                     <parameter name="base-uri"
                                value="{$base-uri}"/>
                  </call>
                  <call step="lax:get-source-url">
                     <parameter name="base-url"
                                value="{$base-url}"/>
                     <parameter name="debug-path"
                                value="{$debug-path}"/>
                     <parameter name="base-uri"
                                value="{$base-uri}"/>
                  </call>
                  <call step="p:identity"
                        name="pages"/>
                  <call step="p:if">
                     <parameter name="test"
                                value="$debug"/>
                     <parameter name="p:store"
                                value=""/>
                  </call>
                  <call step="p:insert">
                     <parameter name="match"
                                value="/lad:document"/>
                     <parameter name="position"
                                value="last-child"/>
                     <port name="source">
                        <parameter name="pipe"
                                   value="result@document-with-resources"/>
                     </port>
                     <port name="insertion">
                        <parameter name="pipe"
                                   value="result@pages"/>
                     </port>
                  </call>
                  <call step="p:viewport">
                     <parameter name="match"
                                value="lad:page"/>
                     <parameter name="p:variable"
                                value=""/>
                     <parameter name="p:add-attribute"
                                value=""/>
                     <parameter name="p:viewport"
                                value="&#xA;                &#xA;   "/>
                  </call>
                  <call step="p:if">
                     <parameter name="test"
                                value="$debug"/>
                     <parameter name="p:store"
                                value=""/>
                  </call>
               </body>
            </step>
            <step type="lax:get-virtual-document-data-v5"
                  name="getting-virtual-document-data">
               <prolog>
                  <documentation length="490">
                     <xhtml:section xml:lang="en"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                                    xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Get virtual document data</xhtml:h2>
                        <xhtml:p>Gathers all requested data about the publication. Downloads the content (files) of the virtual document from external targets.</xhtml:p>
                        <xhtml:p>Saves data to the disk and enhance input data by adding info about local path of the requested resources.</xhtml:p>
                     </xhtml:section>
                     <xhtml:section xml:lang="cs"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                                    xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Získání dat virtuálního dokumentu</xhtml:h2>
                        <xhtml:p>Shromáždí všechna požadovaná data publikace. Stáhne obsah (soubory) virutálního dokumentu z externích odkazů.</xhtml:p>
                        <xhtml:p>Uloží data na disk a obohatí vstupní data přidáním informace o lokálním uložení zdrojů.</xhtml:p>
                     </xhtml:section>
                  </documentation>
                  <namespaces>
                     <namespace prefix="array"
                                value="http://www.w3.org/2005/xpath-functions/array"/>
                     <namespace prefix="lad"
                                value="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"/>
                     <namespace prefix="las"
                                value="https://www.mzk.cz/ns/libri-augmentati/settings/1.0"/>
                     <namespace prefix="lax"
                                value="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"/>
                     <namespace prefix="map"
                                value="http://www.w3.org/2005/xpath-functions/map"/>
                     <namespace prefix="p"
                                value="http://www.w3.org/ns/xproc"/>
                     <namespace prefix="xhtml"
                                value="http://www.w3.org/1999/xhtml"/>
                     <namespace prefix="xlog"
                                value="https://www.daliboris.cz/ns/xproc/logging/1.0"/>
                     <namespace prefix="xs"
                                value="http://www.w3.org/2001/XMLSchema"/>
                     <namespace prefix="xml"
                                value="http://www.w3.org/XML/1998/namespace"/>
                  </namespaces>
                  <options>
                     <option name="debug-path"
                             select="()"
                             as="xs:string?"/>
                     <option name="base-uri"
                             as="xs:anyURI"
                             select="static-base-uri()"/>
                  </options>
                  <ports>
                     <input port="source"
                            primary="true"/>
                     <output port="result"
                             primary="true"/>
                  </ports>
               </prolog>
               <body>
                  <documentation length="490">
                     <xhtml:section xml:lang="en"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                                    xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Get virtual document data</xhtml:h2>
                        <xhtml:p>Gathers all requested data about the publication. Downloads the content (files) of the virtual document from external targets.</xhtml:p>
                        <xhtml:p>Saves data to the disk and enhance input data by adding info about local path of the requested resources.</xhtml:p>
                     </xhtml:section>
                     <xhtml:section xml:lang="cs"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                                    xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Získání dat virtuálního dokumentu</xhtml:h2>
                        <xhtml:p>Shromáždí všechna požadovaná data publikace. Stáhne obsah (soubory) virutálního dokumentu z externích odkazů.</xhtml:p>
                        <xhtml:p>Uloží data na disk a obohatí vstupní data přidáním informace o lokálním uložení zdrojů.</xhtml:p>
                     </xhtml:section>
                  </documentation>
                  <call step="p:variable"
                        name="debug">
                     <parameter name="select"
                                value="$debug-path || '' ne ''"/>
                  </call>
                  <call step="p:variable"
                        name="debug-path-uri">
                     <parameter name="select"
                                value="resolve-uri($debug-path, $base-uri)"/>
                  </call>
                  <call step="p:insert">
                     <parameter name="position"
                                value="last-child"/>
                     <port name="insertion"/>
                  </call>
               </body>
            </step>
            <step type="lax:get-virtual-document-pages">
               <prolog>
                  <documentation length="331">
                     <xhtml:section xml:lang="en"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                                    xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Get virtual document pages</xhtml:h2>
                        <xhtml:p>Creates element for each page of the document that contains basic data: identifier, type and (page) number.</xhtml:p>
                        <xhtml:p>Returns element <xhtml:code>&lt;lad:pages&gt;</xhtml:code>.</xhtml:p>
                     </xhtml:section>
                     <xhtml:section xml:lang="cs"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                                    xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Získání stránek virtuálního dokumentu</xhtml:h2>
                        <xhtml:p>Pro každou stránku dokumentu vytvoří element se základními údaji: identifikátor, typ a číslo (strany).</xhtml:p>
                        <xhtml:p>Vrací element <xhtml:code>&lt;lad:pages&gt;</xhtml:code>.</xhtml:p>
                     </xhtml:section>
                  </documentation>
                  <namespaces>
                     <namespace prefix="array"
                                value="http://www.w3.org/2005/xpath-functions/array"/>
                     <namespace prefix="lad"
                                value="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"/>
                     <namespace prefix="las"
                                value="https://www.mzk.cz/ns/libri-augmentati/settings/1.0"/>
                     <namespace prefix="lax"
                                value="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"/>
                     <namespace prefix="map"
                                value="http://www.w3.org/2005/xpath-functions/map"/>
                     <namespace prefix="p"
                                value="http://www.w3.org/ns/xproc"/>
                     <namespace prefix="xhtml"
                                value="http://www.w3.org/1999/xhtml"/>
                     <namespace prefix="xlog"
                                value="https://www.daliboris.cz/ns/xproc/logging/1.0"/>
                     <namespace prefix="xs"
                                value="http://www.w3.org/2001/XMLSchema"/>
                     <namespace prefix="xml"
                                value="http://www.w3.org/XML/1998/namespace"/>
                  </namespaces>
                  <options>
                     <option name="debug-path"
                             select="()"
                             as="xs:string?"/>
                     <option name="base-uri"
                             as="xs:anyURI"
                             select="static-base-uri()"/>
                     <option name="url"
                             as="xs:string"/>
                     <option name="document-id"
                             as="xs:string"/>
                  </options>
                  <ports>
                     <output port="result"
                             primary="true"/>
                  </ports>
               </prolog>
               <body>
                  <documentation length="331">
                     <xhtml:section xml:lang="en"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                                    xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Get virtual document pages</xhtml:h2>
                        <xhtml:p>Creates element for each page of the document that contains basic data: identifier, type and (page) number.</xhtml:p>
                        <xhtml:p>Returns element <xhtml:code>&lt;lad:pages&gt;</xhtml:code>.</xhtml:p>
                     </xhtml:section>
                     <xhtml:section xml:lang="cs"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                                    xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Získání stránek virtuálního dokumentu</xhtml:h2>
                        <xhtml:p>Pro každou stránku dokumentu vytvoří element se základními údaji: identifikátor, typ a číslo (strany).</xhtml:p>
                        <xhtml:p>Vrací element <xhtml:code>&lt;lad:pages&gt;</xhtml:code>.</xhtml:p>
                     </xhtml:section>
                  </documentation>
                  <call step="p:variable"
                        name="debug">
                     <parameter name="select"
                                value="$debug-path || '' ne ''"/>
                  </call>
                  <call step="p:variable"
                        name="debug-path-uri">
                     <parameter name="select"
                                value="resolve-uri($debug-path, $base-uri)"/>
                  </call>
                  <call step="p:http-request">
                     <parameter name="method"
                                value="GET"/>
                     <parameter name="href"
                                value="{$url}"/>
                     <port name="source"/>
                  </call>
                  <call step="p:if">
                     <parameter name="test"
                                value="$debug"/>
                     <parameter name="p:store"
                                value=""/>
                  </call>
                  <call step="lax:pages-convert-json-to-xml">
                     <parameter name="debug-path"
                                value="{$debug-path}"/>
                     <parameter name="base-uri"
                                value="{$base-uri}"/>
                  </call>
               </body>
            </step>
            <step type="lax:pages-convert-json-to-xml">
               <prolog>
                  <documentation length="387">
                     <xhtml:section xml:lang="en"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                                    xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Pages: convert JSON to XML</xhtml:h2>
                        <xhtml:p>Converts from JSON to XML data about the document page. Creates element for the page with basic data: identifier, type and (page) number.</xhtml:p>
                        <xhtml:p>Returns <xhtml:code>&lt;lad:page&gt;</xhtml:code> element.</xhtml:p>
                     </xhtml:section>
                     <xhtml:section xml:lang="cs"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                                    xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Strany: konverze JSONu na XML</xhtml:h2>
                        <xhtml:p>Zkonvertuje údje o stránce z JSONu do XML. Vytvoří element pro stránku dokumentu se základními údaji: identifikátor, typ a číslo (strany).</xhtml:p>
                        <xhtml:p>Vrací element <xhtml:code>&lt;lad:page&gt;</xhtml:code>.</xhtml:p>
                     </xhtml:section>
                  </documentation>
                  <namespaces>
                     <namespace prefix="array"
                                value="http://www.w3.org/2005/xpath-functions/array"/>
                     <namespace prefix="lad"
                                value="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"/>
                     <namespace prefix="las"
                                value="https://www.mzk.cz/ns/libri-augmentati/settings/1.0"/>
                     <namespace prefix="lax"
                                value="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"/>
                     <namespace prefix="map"
                                value="http://www.w3.org/2005/xpath-functions/map"/>
                     <namespace prefix="p"
                                value="http://www.w3.org/ns/xproc"/>
                     <namespace prefix="xhtml"
                                value="http://www.w3.org/1999/xhtml"/>
                     <namespace prefix="xlog"
                                value="https://www.daliboris.cz/ns/xproc/logging/1.0"/>
                     <namespace prefix="xs"
                                value="http://www.w3.org/2001/XMLSchema"/>
                     <namespace prefix="xml"
                                value="http://www.w3.org/XML/1998/namespace"/>
                  </namespaces>
                  <options>
                     <option name="debug-path"
                             select="()"
                             as="xs:string?"/>
                     <option name="base-uri"
                             as="xs:anyURI"
                             select="static-base-uri()"/>
                  </options>
                  <ports>
                     <input port="source"
                            primary="true"/>
                     <output port="result"
                             primary="true"/>
                  </ports>
               </prolog>
               <body>
                  <documentation length="387">
                     <xhtml:section xml:lang="en"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                                    xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Pages: convert JSON to XML</xhtml:h2>
                        <xhtml:p>Converts from JSON to XML data about the document page. Creates element for the page with basic data: identifier, type and (page) number.</xhtml:p>
                        <xhtml:p>Returns <xhtml:code>&lt;lad:page&gt;</xhtml:code> element.</xhtml:p>
                     </xhtml:section>
                     <xhtml:section xml:lang="cs"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                                    xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Strany: konverze JSONu na XML</xhtml:h2>
                        <xhtml:p>Zkonvertuje údje o stránce z JSONu do XML. Vytvoří element pro stránku dokumentu se základními údaji: identifikátor, typ a číslo (strany).</xhtml:p>
                        <xhtml:p>Vrací element <xhtml:code>&lt;lad:page&gt;</xhtml:code>.</xhtml:p>
                     </xhtml:section>
                  </documentation>
                  <call step="p:variable"
                        name="debug">
                     <parameter name="select"
                                value="$debug-path || '' ne ''"/>
                  </call>
                  <call step="p:variable"
                        name="debug-path-uri">
                     <parameter name="select"
                                value="resolve-uri($debug-path, $base-uri)"/>
                  </call>
                  <call step="p:for-each">
                     <port name="anonymous">
                        <parameter name="select"
                                   value=".?*"/>
                     </port>
                  </call>
                  <call step="p:wrap-sequence">
                     <parameter name="wrapper"
                                value="lad:pages"/>
                  </call>
               </body>
            </step>
            <step type="lax:get-source-url"
                  name="getting-source-url">
               <prolog>
                  <documentation length="371">
                     <xhtml:section xml:lang="en"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                                    xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Get source URL</xhtml:h2>
                        <xhtml:p>For a resource associated with a page, builds a URL from the base URL, API version, document identifier, etc.</xhtml:p>
                        <xhtml:p>Creates <xhtml:code>@url</xhtml:code> attribute for the <xhtml:code>&lt;lad:page&gt;</xhtml:code> element.</xhtml:p>
                     </xhtml:section>
                     <xhtml:section xml:lang="cs"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                                    xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Sestavení URL zdroje</xhtml:h2>
                        <xhtml:p>Pro zdroj přiřazený ke stránce sestaví adresu URL ze základní adresy URL, verze rozhraní API, identifikátoru dokumentu apod.</xhtml:p>
                        <xhtml:p>Vytvoří atribut <xhtml:code>@url</xhtml:code> v rámci elementu <xhtml:code>&lt;lad:page&gt;</xhtml:code>.</xhtml:p>
                     </xhtml:section>
                  </documentation>
                  <namespaces>
                     <namespace prefix="array"
                                value="http://www.w3.org/2005/xpath-functions/array"/>
                     <namespace prefix="lad"
                                value="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"/>
                     <namespace prefix="las"
                                value="https://www.mzk.cz/ns/libri-augmentati/settings/1.0"/>
                     <namespace prefix="lax"
                                value="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"/>
                     <namespace prefix="map"
                                value="http://www.w3.org/2005/xpath-functions/map"/>
                     <namespace prefix="p"
                                value="http://www.w3.org/ns/xproc"/>
                     <namespace prefix="xhtml"
                                value="http://www.w3.org/1999/xhtml"/>
                     <namespace prefix="xlog"
                                value="https://www.daliboris.cz/ns/xproc/logging/1.0"/>
                     <namespace prefix="xs"
                                value="http://www.w3.org/2001/XMLSchema"/>
                     <namespace prefix="xml"
                                value="http://www.w3.org/XML/1998/namespace"/>
                  </namespaces>
                  <options>
                     <option name="debug-path"
                             select="()"
                             as="xs:string?"/>
                     <option name="base-uri"
                             as="xs:anyURI"
                             select="static-base-uri()"/>
                     <option name="base-url"
                             as="xs:anyURI"/>
                  </options>
                  <ports>
                     <input port="source"
                            primary="true"/>
                     <output port="result"
                             primary="true"/>
                  </ports>
               </prolog>
               <body>
                  <documentation length="371">
                     <xhtml:section xml:lang="en"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                                    xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Get source URL</xhtml:h2>
                        <xhtml:p>For a resource associated with a page, builds a URL from the base URL, API version, document identifier, etc.</xhtml:p>
                        <xhtml:p>Creates <xhtml:code>@url</xhtml:code> attribute for the <xhtml:code>&lt;lad:page&gt;</xhtml:code> element.</xhtml:p>
                     </xhtml:section>
                     <xhtml:section xml:lang="cs"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                                    xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Sestavení URL zdroje</xhtml:h2>
                        <xhtml:p>Pro zdroj přiřazený ke stránce sestaví adresu URL ze základní adresy URL, verze rozhraní API, identifikátoru dokumentu apod.</xhtml:p>
                        <xhtml:p>Vytvoří atribut <xhtml:code>@url</xhtml:code> v rámci elementu <xhtml:code>&lt;lad:page&gt;</xhtml:code>.</xhtml:p>
                     </xhtml:section>
                  </documentation>
                  <call step="p:variable"
                        name="debug">
                     <parameter name="select"
                                value="$debug-path || '' ne ''"/>
                  </call>
                  <call step="p:variable"
                        name="debug-path-uri">
                     <parameter name="select"
                                value="resolve-uri($debug-path, $base-uri)"/>
                  </call>
                  <call step="p:viewport">
                     <parameter name="match"
                                value="lad:page"/>
                     <parameter name="p:if"
                                value="&#xA;    &#xA;   "/>
                     <parameter name="p:if"
                                value="&#xA;    &#xA;   "/>
                     <parameter name="p:if"
                                value="&#xA;    &#xA;   "/>
                     <parameter name="p:if"
                                value="&#xA;    &#xA;   "/>
                     <parameter name="p:if"
                                value="&#xA;    &#xA;   "/>
                     <parameter name="p:if"
                                value="&#xA;    &#xA;   "/>
                  </call>
                  <call step="p:viewport">
                     <parameter name="match"
                                value="lad:page"/>
                     <parameter name="p:variable"
                                value=""/>
                     <parameter name="p:viewport"
                                value="&#xA;    &#xA;    &#xA;   "/>
                  </call>
               </body>
            </step>
            <step type="lax:get-available-formats"
                  name="getting-available-formats">
               <prolog>
                  <documentation length="378">
                     <xhtml:section xml:lang="en"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                                    xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Get available formats</xhtml:h2>
                        <xhtml:p>Selects one page from the middle of the document and checks which resources are available on-line.</xhtml:p>
                        <xhtml:p>For each requested <xhtml:code>&lt;resource&gt;</xhtml:code> adds <xhtml:code>@available</xhtml:code> attribute.</xhtml:p>
                     </xhtml:section>
                     <xhtml:section xml:lang="cs"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                                    xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Zjištění dostupných formátů</xhtml:h2>
                        <xhtml:p>Pro stránku zprostředka publikace zjistí, které všechny zdroje jsou dostupné on-line.</xhtml:p>
                        <xhtml:p>Pro každý požadovaný zdroj vytvoří atribut <xhtml:code>@available</xhtml:code> v rámci elementu <xhtml:code>&lt;lad:resource&gt;</xhtml:code>.</xhtml:p>
                     </xhtml:section>
                  </documentation>
                  <namespaces>
                     <namespace prefix="array"
                                value="http://www.w3.org/2005/xpath-functions/array"/>
                     <namespace prefix="lad"
                                value="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"/>
                     <namespace prefix="las"
                                value="https://www.mzk.cz/ns/libri-augmentati/settings/1.0"/>
                     <namespace prefix="lax"
                                value="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"/>
                     <namespace prefix="map"
                                value="http://www.w3.org/2005/xpath-functions/map"/>
                     <namespace prefix="p"
                                value="http://www.w3.org/ns/xproc"/>
                     <namespace prefix="xhtml"
                                value="http://www.w3.org/1999/xhtml"/>
                     <namespace prefix="xlog"
                                value="https://www.daliboris.cz/ns/xproc/logging/1.0"/>
                     <namespace prefix="xs"
                                value="http://www.w3.org/2001/XMLSchema"/>
                     <namespace prefix="xml"
                                value="http://www.w3.org/XML/1998/namespace"/>
                  </namespaces>
                  <options>
                     <option name="debug-path"
                             select="()"
                             as="xs:string?"/>
                     <option name="base-uri"
                             as="xs:anyURI"
                             select="static-base-uri()"/>
                     <option name="base-url"
                             as="xs:anyURI"/>
                  </options>
                  <ports>
                     <input port="source"
                            primary="true"/>
                     <output port="result"
                             primary="true"/>
                  </ports>
               </prolog>
               <body>
                  <documentation length="378">
                     <xhtml:section xml:lang="en"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                                    xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Get available formats</xhtml:h2>
                        <xhtml:p>Selects one page from the middle of the document and checks which resources are available on-line.</xhtml:p>
                        <xhtml:p>For each requested <xhtml:code>&lt;resource&gt;</xhtml:code> adds <xhtml:code>@available</xhtml:code> attribute.</xhtml:p>
                     </xhtml:section>
                     <xhtml:section xml:lang="cs"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                                    xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Zjištění dostupných formátů</xhtml:h2>
                        <xhtml:p>Pro stránku zprostředka publikace zjistí, které všechny zdroje jsou dostupné on-line.</xhtml:p>
                        <xhtml:p>Pro každý požadovaný zdroj vytvoří atribut <xhtml:code>@available</xhtml:code> v rámci elementu <xhtml:code>&lt;lad:resource&gt;</xhtml:code>.</xhtml:p>
                     </xhtml:section>
                  </documentation>
                  <call step="p:variable"
                        name="size">
                     <parameter name="select"
                                value="count(/lad:pages/lad:page)"/>
                     <parameter name="as"
                                value="xs:integer"/>
                  </call>
                  <call step="p:variable"
                        name="page">
                     <parameter name="select"
                                value="/lad:pages/lad:page[xs:integer($size div 2)]"/>
                  </call>
                  <call step="p:variable"
                        name="url">
                     <parameter name="select"
                                value="concat($base-url, '/item/', $page/@id)"/>
                  </call>
                  <call step="p:variable"
                        name="alto-url">
                     <parameter name="select"
                                value="concat($url, $url-fragments?alto)"/>
                  </call>
                  <call step="p:variable"
                        name="text-url">
                     <parameter name="select"
                                value="concat($url, $url-fragments?text)"/>
                  </call>
                  <call step="p:variable"
                        name="dc-url">
                     <parameter name="select"
                                value="concat($url, $url-fragments?dc)"/>
                  </call>
                  <call step="p:variable"
                        name="foxml-url">
                     <parameter name="select"
                                value="concat($url, $url-fragments?foxml)"/>
                  </call>
                  <call step="p:variable"
                        name="mods-url">
                     <parameter name="select"
                                value="concat($url, $url-fragments?mods)"/>
                  </call>
                  <call step="p:variable"
                        name="image-url">
                     <parameter name="select"
                                value="concat($url, $url-fragments?image)"/>
                  </call>
                  <call step="lax:get-available-format">
                     <parameter name="url"
                                value="{$alto-url}"/>
                     <parameter name="format"
                                value="alto"/>
                     <parameter name="debug-path"
                                value="{$debug-path}"/>
                     <parameter name="base-uri"
                                value="{$base-uri}"/>
                     <port name="source">
                        <parameter name="select"
                                   value="$page"/>
                     </port>
                  </call>
                  <call step="lax:get-available-format">
                     <parameter name="url"
                                value="{$text-url}"/>
                     <parameter name="format"
                                value="text"/>
                     <parameter name="debug-path"
                                value="{$debug-path}"/>
                     <parameter name="base-uri"
                                value="{$base-uri}"/>
                  </call>
                  <call step="lax:get-available-format">
                     <parameter name="url"
                                value="{$dc-url}"/>
                     <parameter name="format"
                                value="dc"/>
                     <parameter name="debug-path"
                                value="{$debug-path}"/>
                     <parameter name="base-uri"
                                value="{$base-uri}"/>
                  </call>
                  <call step="lax:get-available-format">
                     <parameter name="url"
                                value="{$foxml-url}"/>
                     <parameter name="format"
                                value="foxml"/>
                     <parameter name="debug-path"
                                value="{$debug-path}"/>
                     <parameter name="base-uri"
                                value="{$base-uri}"/>
                  </call>
                  <call step="lax:get-available-format">
                     <parameter name="url"
                                value="{$mods-url}"/>
                     <parameter name="format"
                                value="mods"/>
                     <parameter name="debug-path"
                                value="{$debug-path}"/>
                     <parameter name="base-uri"
                                value="{$base-uri}"/>
                  </call>
                  <call step="lax:get-available-format">
                     <parameter name="url"
                                value="{$image-url}"/>
                     <parameter name="format"
                                value="image"/>
                     <parameter name="debug-path"
                                value="{$debug-path}"/>
                     <parameter name="base-uri"
                                value="{$base-uri}"/>
                  </call>
                  <call step="p:identity"
                        name="page-with-formats"/>
                  <call step="p:variable"
                        name="page-formats">
                     <parameter name="select"
                                value="/*"/>
                  </call>
                  <call step="p:insert">
                     <parameter name="match"
                                value="lad:page"/>
                     <parameter name="position"
                                value="first-child"/>
                     <port name="source">
                        <parameter name="pipe"
                                   value="source@getting-available-formats"/>
                     </port>
                     <port name="insertion">
                        <parameter name="select"
                                   value="/lad:page/lad:resource"/>
                        <parameter name="pipe"
                                   value="result@page-with-formats"/>
                     </port>
                  </call>
                  <call step="p:namespace-delete">
                     <parameter name="prefixes"
                                value="array"/>
                  </call>
               </body>
            </step>
            <step type="lax:get-available-format"
                  name="getting-available-format">
               <prolog>
                  <documentation length="247">
                     <xhtml:section xml:lang="en"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                                    xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Get available format</xhtml:h2>
                        <xhtml:p>Checks if the resource is available on-line.</xhtml:p>
                        <xhtml:p>Returns <xhtml:code>&lt;resource&gt;</xhtml:code> with the <xhtml:code>@available</xhtml:code> attribute.</xhtml:p>
                     </xhtml:section>
                     <xhtml:section xml:lang="cs"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                                    xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Zjištění dostupnosti formátu</xhtml:h2>
                        <xhtml:p>Zjistí, zda je požadovaný zdroj dostupný on-line.</xhtml:p>
                        <xhtml:p>Vrací element <xhtml:code>&lt;lad:resource&gt;</xhtml:code> s atributem <xhtml:code>@available</xhtml:code>.</xhtml:p>
                     </xhtml:section>
                  </documentation>
                  <namespaces>
                     <namespace prefix="array"
                                value="http://www.w3.org/2005/xpath-functions/array"/>
                     <namespace prefix="lad"
                                value="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"/>
                     <namespace prefix="las"
                                value="https://www.mzk.cz/ns/libri-augmentati/settings/1.0"/>
                     <namespace prefix="lax"
                                value="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"/>
                     <namespace prefix="map"
                                value="http://www.w3.org/2005/xpath-functions/map"/>
                     <namespace prefix="p"
                                value="http://www.w3.org/ns/xproc"/>
                     <namespace prefix="xhtml"
                                value="http://www.w3.org/1999/xhtml"/>
                     <namespace prefix="xlog"
                                value="https://www.daliboris.cz/ns/xproc/logging/1.0"/>
                     <namespace prefix="xs"
                                value="http://www.w3.org/2001/XMLSchema"/>
                     <namespace prefix="xml"
                                value="http://www.w3.org/XML/1998/namespace"/>
                  </namespaces>
                  <options>
                     <option name="debug-path"
                             select="()"
                             as="xs:string?"/>
                     <option name="base-uri"
                             as="xs:anyURI"
                             select="static-base-uri()"/>
                     <option name="url"
                             as="xs:anyURI"
                             required="true"/>
                     <option name="format"
                             as="xs:string"
                             required="true"/>
                  </options>
                  <ports>
                     <input port="source"
                            primary="true"/>
                     <output port="result"
                             primary="true"/>
                  </ports>
               </prolog>
               <body>
                  <documentation length="247">
                     <xhtml:section xml:lang="en"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                                    xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Get available format</xhtml:h2>
                        <xhtml:p>Checks if the resource is available on-line.</xhtml:p>
                        <xhtml:p>Returns <xhtml:code>&lt;resource&gt;</xhtml:code> with the <xhtml:code>@available</xhtml:code> attribute.</xhtml:p>
                     </xhtml:section>
                     <xhtml:section xml:lang="cs"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                                    xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Zjištění dostupnosti formátu</xhtml:h2>
                        <xhtml:p>Zjistí, zda je požadovaný zdroj dostupný on-line.</xhtml:p>
                        <xhtml:p>Vrací element <xhtml:code>&lt;lad:resource&gt;</xhtml:code> s atributem <xhtml:code>@available</xhtml:code>.</xhtml:p>
                     </xhtml:section>
                  </documentation>
                  <call step="p:variable"
                        name="debug">
                     <parameter name="select"
                                value="$debug-path || '' ne ''"/>
                  </call>
                  <call step="p:variable"
                        name="debug-path-uri">
                     <parameter name="select"
                                value="resolve-uri($debug-path, $base-uri)"/>
                  </call>
                  <call step="p:http-request"
                        name="request">
                     <parameter name="href"
                                value="{$url}"/>
                     <parameter name="parameters"
                                value="map{'status-only' : true(), 'follow-redirect' : 3 }"/>
                  </call>
                  <call step="p:variable"
                        name="available">
                     <parameter name="select"
                                value=".?status-code = (200, 307, 301)"/>
                     <parameter name="pipe"
                                value="report@request"/>
                  </call>
                  <call step="p:add-attribute">
                     <parameter name="attribute-name"
                                value="{$format}"/>
                     <parameter name="attribute-value"
                                value="{$available}"/>
                     <port name="source">
                        <parameter name="pipe"
                                   value="source@getting-available-format"/>
                     </port>
                  </call>
                  <call step="p:insert">
                     <parameter name="match"
                                value="lad:page"/>
                     <parameter name="position"
                                value="first-child"/>
                     <port name="insertion"/>
                  </call>
               </body>
            </step>
         </body>
      </library>
   </analysis>
   <analysis file-name="kramerius-7.xpl"
             path="file:///V:/Projekty/Github/MZK/libri-augmentati/src/xproc/kramerius-7.xpl"
             xmlns="https://www.daliboris.cz/ns/xproc/analysis"
             xmlns:xhtml="http://www.w3.org/1999/xhtml">
      <library semver="1.0.0">
         <prolog>
            <documentation length="166">
               <xhtml:meta name="version"
                           content="1.0.0"
                           xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                           xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                           xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                           xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                           xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                           xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0"/>
               <xhtml:section xml:lang="en"
                              xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                              xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                              xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                              xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                              xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                              xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                  <xhtml:h1>Kramerius 7</xhtml:h1>
                  <xhtml:p>Programming library for communication with the <xhtml:a href="https://system-kramerius.cz/en">Kramerius</xhtml:a> system, <xhtml:a href="https://github.com/ceskaexpedice/kramerius/wiki/API-v7">version 7</xhtml:a>.</xhtml:p>
               </xhtml:section>
               <xhtml:section xml:lang="cs"
                              xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                              xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                              xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                              xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                              xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                              xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                  <xhtml:h1>Kramerius 7</xhtml:h1>
                  <xhtml:p>Programová knihovna pro komunikaci se systémem <xhtml:a href="https://system-kramerius.cz">Kramerius</xhtml:a>, <xhtml:a href="https://github.com/ceskaexpedice/kramerius/wiki/API-v7">verze 7</xhtml:a>.</xhtml:p>
               </xhtml:section>
            </documentation>
            <namespaces>
               <namespace prefix="array"
                          value="http://www.w3.org/2005/xpath-functions/array"/>
               <namespace prefix="lad"
                          value="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"/>
               <namespace prefix="las"
                          value="https://www.mzk.cz/ns/libri-augmentati/settings/1.0"/>
               <namespace prefix="lax"
                          value="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"/>
               <namespace prefix="map"
                          value="http://www.w3.org/2005/xpath-functions/map"/>
               <namespace prefix="p"
                          value="http://www.w3.org/ns/xproc"/>
               <namespace prefix="xhtml"
                          value="http://www.w3.org/1999/xhtml"/>
               <namespace prefix="xlog"
                          value="https://www.daliboris.cz/ns/xproc/logging/1.0"/>
               <namespace prefix="xs"
                          value="http://www.w3.org/2001/XMLSchema"/>
               <namespace prefix="xml"
                          value="http://www.w3.org/XML/1998/namespace"/>
            </namespaces>
         </prolog>
         <body>
            <documentation length="166">
               <xhtml:meta name="version"
                           content="1.0.0"
                           xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                           xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                           xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                           xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                           xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                           xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0"/>
               <xhtml:section xml:lang="en"
                              xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                              xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                              xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                              xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                              xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                              xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                  <xhtml:h1>Kramerius 7</xhtml:h1>
                  <xhtml:p>Programming library for communication with the <xhtml:a href="https://system-kramerius.cz/en">Kramerius</xhtml:a> system, <xhtml:a href="https://github.com/ceskaexpedice/kramerius/wiki/API-v7">version 7</xhtml:a>.</xhtml:p>
               </xhtml:section>
               <xhtml:section xml:lang="cs"
                              xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                              xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                              xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                              xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                              xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                              xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                  <xhtml:h1>Kramerius 7</xhtml:h1>
                  <xhtml:p>Programová knihovna pro komunikaci se systémem <xhtml:a href="https://system-kramerius.cz">Kramerius</xhtml:a>, <xhtml:a href="https://github.com/ceskaexpedice/kramerius/wiki/API-v7">verze 7</xhtml:a>.</xhtml:p>
               </xhtml:section>
            </documentation>
            <step type="lax:get-virtual-document-metadata-v7"
                  name="getting-virtual-document-metadata">
               <prolog>
                  <documentation length="495">
                     <xhtml:section xml:lang="en"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                                    xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Get virtual document metadata</xhtml:h2>
                        <xhtml:p>Gathers all requested metadata about the publication. Creates the content of the virtual document with links to all requested resources.</xhtml:p>
                        <xhtml:p>Enhance input data by adding requested resources on the document and page level.</xhtml:p>
                     </xhtml:section>
                     <xhtml:section xml:lang="cs"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                                    xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Získání metadat virtuálního dokumentu</xhtml:h2>
                        <xhtml:p>Shromáždí všechna požadovaná metadata o publikaci. Vytvoří strukturu virutálního dokumentu s odkazy na všechny požadované zdroje.</xhtml:p>
                        <xhtml:p>Obohatí vstupní data přidáním požadovaných zdrojů na úrovni dokumentu a strany.</xhtml:p>
                     </xhtml:section>
                  </documentation>
                  <namespaces>
                     <namespace prefix="array"
                                value="http://www.w3.org/2005/xpath-functions/array"/>
                     <namespace prefix="lad"
                                value="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"/>
                     <namespace prefix="las"
                                value="https://www.mzk.cz/ns/libri-augmentati/settings/1.0"/>
                     <namespace prefix="lax"
                                value="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"/>
                     <namespace prefix="map"
                                value="http://www.w3.org/2005/xpath-functions/map"/>
                     <namespace prefix="p"
                                value="http://www.w3.org/ns/xproc"/>
                     <namespace prefix="xhtml"
                                value="http://www.w3.org/1999/xhtml"/>
                     <namespace prefix="xlog"
                                value="https://www.daliboris.cz/ns/xproc/logging/1.0"/>
                     <namespace prefix="xs"
                                value="http://www.w3.org/2001/XMLSchema"/>
                     <namespace prefix="xml"
                                value="http://www.w3.org/XML/1998/namespace"/>
                  </namespaces>
                  <options>
                     <option name="debug-path"
                             select="()"
                             as="xs:string?"/>
                     <option name="base-uri"
                             as="xs:anyURI"
                             select="static-base-uri()"/>
                  </options>
                  <ports>
                     <input port="source"
                            primary="true"/>
                     <output port="result"
                             primary="true"/>
                  </ports>
               </prolog>
               <body>
                  <documentation length="495">
                     <xhtml:section xml:lang="en"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                                    xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Get virtual document metadata</xhtml:h2>
                        <xhtml:p>Gathers all requested metadata about the publication. Creates the content of the virtual document with links to all requested resources.</xhtml:p>
                        <xhtml:p>Enhance input data by adding requested resources on the document and page level.</xhtml:p>
                     </xhtml:section>
                     <xhtml:section xml:lang="cs"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                                    xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Získání metadat virtuálního dokumentu</xhtml:h2>
                        <xhtml:p>Shromáždí všechna požadovaná metadata o publikaci. Vytvoří strukturu virutálního dokumentu s odkazy na všechny požadované zdroje.</xhtml:p>
                        <xhtml:p>Obohatí vstupní data přidáním požadovaných zdrojů na úrovni dokumentu a strany.</xhtml:p>
                     </xhtml:section>
                  </documentation>
                  <call step="p:variable"
                        name="debug">
                     <parameter name="select"
                                value="$debug-path || '' ne ''"/>
                  </call>
                  <call step="p:variable"
                        name="debug-path-uri">
                     <parameter name="select"
                                value="resolve-uri($debug-path, $base-uri)"/>
                  </call>
                  <call step="p:variable"
                        name="resources">
                     <parameter name="select"
                                value="/lad:document/las:api/las:resource"/>
                  </call>
                  <call step="p:variable"
                        name="library">
                     <parameter name="select"
                                value="/lad:document/las:library"/>
                  </call>
                  <call step="p:variable"
                        name="base-url">
                     <parameter name="select"
                                value="/lad:document/lad:options/@base-url"/>
                  </call>
                  <call step="p:variable"
                        name="id">
                     <parameter name="select"
                                value="replace(/lad:document/@id, ':', '%3A')"/>
                  </call>
                  <call step="p:variable"
                        name="guid">
                     <parameter name="select"
                                value="substring-after(/lad:document/@id, ':')"/>
                  </call>
                  <call step="p:variable"
                        name="url">
                     <parameter name="select"
                                value="concat($base-url, '/search/api/client/v7.0/search?fl=pid,page.number,page.type&amp;sort=rels_ext_index.sort%20asc&amp;rows=4000&amp;start=0&amp;q=own_parent.pid:', '%22', $id, '%22')"/>
                  </call>
                  <call step="p:variable"
                        name="mods-url">
                     <parameter name="select"
                                value="$resources[@type='MODS']/@url ! replace(., '\{pid\}', $id)"/>
                  </call>
                  <call step="p:variable"
                        name="dc-url">
                     <parameter name="select"
                                value="$resources[@type='DC']/@url ! replace(., '\{pid\}', $id)"/>
                  </call>
                  <call step="p:variable"
                        name="foxml-url">
                     <parameter name="select"
                                value="$resources[@type='FOXML']/@url ! replace(., '\{pid\}', $id)"/>
                  </call>
                  <call step="p:insert">
                     <parameter name="match"
                                value="/lad:document"/>
                     <parameter name="position"
                                value="last-child"/>
                     <port name="insertion"/>
                  </call>
                  <call step="p:if">
                     <parameter name="test"
                                value="$debug"/>
                     <parameter name="p:store"
                                value=""/>
                  </call>
                  <call step="p:identity"
                        name="document-with-resources"/>
                  <call step="lax:get-virtual-document-pages-v7">
                     <parameter name="url"
                                value="{$url}"/>
                     <parameter name="document-id"
                                value="{$guid}"/>
                     <parameter name="library-code"
                                value="{$library/@code}"/>
                     <parameter name="debug-path"
                                value="{$debug-path}"/>
                     <parameter name="base-uri"
                                value="{$base-uri}"/>
                  </call>
                  <call step="p:if">
                     <parameter name="test"
                                value="$debug"/>
                     <parameter name="p:store"
                                value=""/>
                  </call>
                  <call step="p:identity"
                        name="virutal-pages"/>
                  <call step="p:insert">
                     <parameter name="match"
                                value="lad:document"/>
                     <parameter name="position"
                                value="last-child"/>
                     <port name="source">
                        <parameter name="pipe"
                                   value="result@document-with-resources"/>
                     </port>
                     <port name="insertion">
                        <parameter name="pipe"
                                   value="result@virutal-pages"/>
                     </port>
                  </call>
                  <call step="p:if">
                     <parameter name="test"
                                value="$debug"/>
                     <parameter name="p:store"
                                value=""/>
                  </call>
                  <call step="lax:get-available-formats-v7">
                     <parameter name="base-url"
                                value="{$base-url}"/>
                     <parameter name="debug-path"
                                value="{$debug-path}"/>
                     <parameter name="base-uri"
                                value="{$base-uri}"/>
                  </call>
                  <call step="p:if">
                     <parameter name="test"
                                value="$debug"/>
                     <parameter name="p:store"
                                value=""/>
                  </call>
                  <call step="lax:get-source-url-v7">
                     <parameter name="debug-path"
                                value="{$debug-path}"/>
                     <parameter name="base-uri"
                                value="{$base-uri}"/>
                  </call>
                  <call step="p:namespace-delete">
                     <parameter name="prefixes"
                                value="lax xlog array xs map xhtml"/>
                  </call>
                  <call step="p:if">
                     <parameter name="test"
                                value="$debug"/>
                     <parameter name="p:store"
                                value=""/>
                  </call>
                  <call step="p:viewport">
                     <parameter name="match"
                                value="lad:page"/>
                     <parameter name="p:variable"
                                value=""/>
                     <parameter name="p:add-attribute"
                                value=""/>
                     <parameter name="p:viewport"
                                value="&#xA;                        &#xA;        "/>
                  </call>
                  <call step="p:if">
                     <parameter name="test"
                                value="$debug"/>
                     <parameter name="p:store"
                                value=""/>
                  </call>
                  <call step="p:insert">
                     <parameter name="match"
                                value="/lad:document"/>
                     <parameter name="position"
                                value="last-child"/>
                     <parameter name="use-when"
                                value="false()"/>
                     <port name="source">
                        <parameter name="pipe"
                                   value="result@document-with-resources"/>
                     </port>
                     <port name="insertion">
                        <parameter name="select"
                                   value="/lad:pages"/>
                        <parameter name="pipe"
                                   value="result@pages"/>
                     </port>
                  </call>
               </body>
            </step>
            <step type="lax:get-virtual-document-data-v7"
                  name="getting-virtual-document-data">
               <prolog>
                  <documentation length="490">
                     <xhtml:section xml:lang="en"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                                    xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Get virtual document data</xhtml:h2>
                        <xhtml:p>Gathers all requested data about the publication. Downloads the content (files) of the virtual document from external targets.</xhtml:p>
                        <xhtml:p>Saves data to the disk and enhance input data by adding info about local path of the requested resources.</xhtml:p>
                     </xhtml:section>
                     <xhtml:section xml:lang="cs"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                                    xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Získání dat virtuálního dokumentu</xhtml:h2>
                        <xhtml:p>Shromáždí všechna požadovaná data publikace. Stáhne obsah (soubory) virutálního dokumentu z externích odkazů.</xhtml:p>
                        <xhtml:p>Uloží data na disk a obohatí vstupní data přidáním informace o lokálním uložení zdrojů.</xhtml:p>
                     </xhtml:section>
                  </documentation>
                  <namespaces>
                     <namespace prefix="array"
                                value="http://www.w3.org/2005/xpath-functions/array"/>
                     <namespace prefix="lad"
                                value="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"/>
                     <namespace prefix="las"
                                value="https://www.mzk.cz/ns/libri-augmentati/settings/1.0"/>
                     <namespace prefix="lax"
                                value="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"/>
                     <namespace prefix="map"
                                value="http://www.w3.org/2005/xpath-functions/map"/>
                     <namespace prefix="p"
                                value="http://www.w3.org/ns/xproc"/>
                     <namespace prefix="xhtml"
                                value="http://www.w3.org/1999/xhtml"/>
                     <namespace prefix="xlog"
                                value="https://www.daliboris.cz/ns/xproc/logging/1.0"/>
                     <namespace prefix="xs"
                                value="http://www.w3.org/2001/XMLSchema"/>
                     <namespace prefix="xml"
                                value="http://www.w3.org/XML/1998/namespace"/>
                  </namespaces>
                  <options>
                     <option name="debug-path"
                             select="()"
                             as="xs:string?"/>
                     <option name="base-uri"
                             as="xs:anyURI"
                             select="static-base-uri()"/>
                  </options>
                  <ports>
                     <input port="source"
                            primary="true"/>
                     <output port="result"
                             primary="true"/>
                  </ports>
               </prolog>
               <body>
                  <documentation length="490">
                     <xhtml:section xml:lang="en"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                                    xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Get virtual document data</xhtml:h2>
                        <xhtml:p>Gathers all requested data about the publication. Downloads the content (files) of the virtual document from external targets.</xhtml:p>
                        <xhtml:p>Saves data to the disk and enhance input data by adding info about local path of the requested resources.</xhtml:p>
                     </xhtml:section>
                     <xhtml:section xml:lang="cs"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                                    xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Získání dat virtuálního dokumentu</xhtml:h2>
                        <xhtml:p>Shromáždí všechna požadovaná data publikace. Stáhne obsah (soubory) virutálního dokumentu z externích odkazů.</xhtml:p>
                        <xhtml:p>Uloží data na disk a obohatí vstupní data přidáním informace o lokálním uložení zdrojů.</xhtml:p>
                     </xhtml:section>
                  </documentation>
                  <call step="p:variable"
                        name="debug">
                     <parameter name="select"
                                value="$debug-path || '' ne ''"/>
                  </call>
                  <call step="p:variable"
                        name="debug-path-uri">
                     <parameter name="select"
                                value="resolve-uri($debug-path, $base-uri)"/>
                  </call>
                  <call step="p:variable"
                        name="base-url">
                     <parameter name="select"
                                value="/lad:document/lad:options/@base-url"/>
                  </call>
                  <call step="p:variable"
                        name="id">
                     <parameter name="select"
                                value="/lad:document/@id"/>
                  </call>
                  <call step="p:variable"
                        name="guid">
                     <parameter name="select"
                                value="substring-after(/lad:document/@id, ':')"/>
                  </call>
                  <call step="p:variable"
                        name="url">
                     <parameter name="select"
                                value="concat($base-url, '/item/', $id, '/children')"/>
                  </call>
               </body>
            </step>
            <step type="lax:get-virtual-document-pages-v7">
               <prolog>
                  <documentation length="331">
                     <xhtml:section xml:lang="en"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                                    xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Get virtual document pages</xhtml:h2>
                        <xhtml:p>Creates element for each page of the document that contains basic data: identifier, type and (page) number.</xhtml:p>
                        <xhtml:p>Returns element <xhtml:code>&lt;lad:pages&gt;</xhtml:code>.</xhtml:p>
                     </xhtml:section>
                     <xhtml:section xml:lang="cs"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                                    xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Získání stránek virtuálního dokumentu</xhtml:h2>
                        <xhtml:p>Pro každou stránku dokumentu vytvoří element se základními údaji: identifikátor, typ a číslo (strany).</xhtml:p>
                        <xhtml:p>Vrací element <xhtml:code>&lt;lad:pages&gt;</xhtml:code>.</xhtml:p>
                     </xhtml:section>
                  </documentation>
                  <namespaces>
                     <namespace prefix="array"
                                value="http://www.w3.org/2005/xpath-functions/array"/>
                     <namespace prefix="lad"
                                value="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"/>
                     <namespace prefix="las"
                                value="https://www.mzk.cz/ns/libri-augmentati/settings/1.0"/>
                     <namespace prefix="lax"
                                value="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"/>
                     <namespace prefix="map"
                                value="http://www.w3.org/2005/xpath-functions/map"/>
                     <namespace prefix="p"
                                value="http://www.w3.org/ns/xproc"/>
                     <namespace prefix="xhtml"
                                value="http://www.w3.org/1999/xhtml"/>
                     <namespace prefix="xlog"
                                value="https://www.daliboris.cz/ns/xproc/logging/1.0"/>
                     <namespace prefix="xs"
                                value="http://www.w3.org/2001/XMLSchema"/>
                     <namespace prefix="xml"
                                value="http://www.w3.org/XML/1998/namespace"/>
                  </namespaces>
                  <options>
                     <option name="debug-path"
                             select="()"
                             as="xs:string?"/>
                     <option name="base-uri"
                             as="xs:anyURI"
                             select="static-base-uri()"/>
                     <option name="url"
                             as="xs:string"
                             required="true"/>
                     <option name="document-id"
                             as="xs:string"
                             required="true"/>
                     <option name="library-code"
                             as="xs:string"
                             required="true"/>
                  </options>
                  <ports>
                     <output port="result"
                             primary="true"/>
                  </ports>
               </prolog>
               <body>
                  <documentation length="331">
                     <xhtml:section xml:lang="en"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                                    xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Get virtual document pages</xhtml:h2>
                        <xhtml:p>Creates element for each page of the document that contains basic data: identifier, type and (page) number.</xhtml:p>
                        <xhtml:p>Returns element <xhtml:code>&lt;lad:pages&gt;</xhtml:code>.</xhtml:p>
                     </xhtml:section>
                     <xhtml:section xml:lang="cs"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                                    xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Získání stránek virtuálního dokumentu</xhtml:h2>
                        <xhtml:p>Pro každou stránku dokumentu vytvoří element se základními údaji: identifikátor, typ a číslo (strany).</xhtml:p>
                        <xhtml:p>Vrací element <xhtml:code>&lt;lad:pages&gt;</xhtml:code>.</xhtml:p>
                     </xhtml:section>
                  </documentation>
                  <call step="p:variable"
                        name="debug">
                     <parameter name="select"
                                value="$debug-path || '' ne ''"/>
                  </call>
                  <call step="p:variable"
                        name="debug-path-uri">
                     <parameter name="select"
                                value="resolve-uri($debug-path, $base-uri)"/>
                  </call>
                  <call step="p:try">
                     <parameter name="p:group"
                                value="&#xA;            &#xA;                &#xA;            &#xA;            &#xA;            &#xA;                &#xA;            &#xA;&#xA;            &#xA;&#xA;        "/>
                     <parameter name="p:catch"
                                value="&#xA;            &#xA;                &#xA;            &#xA;               &#xA;        "/>
                  </call>
               </body>
            </step>
            <step type="lax:pages-convert-json-to-xml-v7">
               <prolog>
                  <documentation length="387">
                     <xhtml:section xml:lang="en"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                                    xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Pages: convert JSON to XML</xhtml:h2>
                        <xhtml:p>Converts from JSON to XML data about the document page. Creates element for the page with basic data: identifier, type and (page) number.</xhtml:p>
                        <xhtml:p>Returns <xhtml:code>&lt;lad:page&gt;</xhtml:code> element.</xhtml:p>
                     </xhtml:section>
                     <xhtml:section xml:lang="cs"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                                    xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Strany: konverze JSONu na XML</xhtml:h2>
                        <xhtml:p>Zkonvertuje údje o stránce z JSONu do XML. Vytvoří element pro stránku dokumentu se základními údaji: identifikátor, typ a číslo (strany).</xhtml:p>
                        <xhtml:p>Vrací element <xhtml:code>&lt;lad:page&gt;</xhtml:code>.</xhtml:p>
                     </xhtml:section>
                  </documentation>
                  <namespaces>
                     <namespace prefix="array"
                                value="http://www.w3.org/2005/xpath-functions/array"/>
                     <namespace prefix="lad"
                                value="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"/>
                     <namespace prefix="las"
                                value="https://www.mzk.cz/ns/libri-augmentati/settings/1.0"/>
                     <namespace prefix="lax"
                                value="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"/>
                     <namespace prefix="map"
                                value="http://www.w3.org/2005/xpath-functions/map"/>
                     <namespace prefix="p"
                                value="http://www.w3.org/ns/xproc"/>
                     <namespace prefix="xhtml"
                                value="http://www.w3.org/1999/xhtml"/>
                     <namespace prefix="xlog"
                                value="https://www.daliboris.cz/ns/xproc/logging/1.0"/>
                     <namespace prefix="xs"
                                value="http://www.w3.org/2001/XMLSchema"/>
                     <namespace prefix="xml"
                                value="http://www.w3.org/XML/1998/namespace"/>
                  </namespaces>
                  <options>
                     <option name="debug-path"
                             select="()"
                             as="xs:string?"/>
                     <option name="base-uri"
                             as="xs:anyURI"
                             select="static-base-uri()"/>
                  </options>
                  <ports>
                     <input port="source"
                            primary="true"/>
                     <output port="result"
                             primary="true"/>
                  </ports>
               </prolog>
               <body>
                  <documentation length="387">
                     <xhtml:section xml:lang="en"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                                    xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Pages: convert JSON to XML</xhtml:h2>
                        <xhtml:p>Converts from JSON to XML data about the document page. Creates element for the page with basic data: identifier, type and (page) number.</xhtml:p>
                        <xhtml:p>Returns <xhtml:code>&lt;lad:page&gt;</xhtml:code> element.</xhtml:p>
                     </xhtml:section>
                     <xhtml:section xml:lang="cs"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                                    xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Strany: konverze JSONu na XML</xhtml:h2>
                        <xhtml:p>Zkonvertuje údje o stránce z JSONu do XML. Vytvoří element pro stránku dokumentu se základními údaji: identifikátor, typ a číslo (strany).</xhtml:p>
                        <xhtml:p>Vrací element <xhtml:code>&lt;lad:page&gt;</xhtml:code>.</xhtml:p>
                     </xhtml:section>
                  </documentation>
                  <call step="p:variable"
                        name="debug">
                     <parameter name="select"
                                value="$debug-path || '' ne ''"/>
                  </call>
                  <call step="p:variable"
                        name="debug-path-uri">
                     <parameter name="select"
                                value="resolve-uri($debug-path, $base-uri)"/>
                  </call>
                  <call step="p:for-each">
                     <port name="anonymous">
                        <parameter name="select"
                                   value=".?response?docs?*"/>
                     </port>
                  </call>
                  <call step="p:wrap-sequence">
                     <parameter name="wrapper"
                                value="lad:pages"/>
                  </call>
               </body>
            </step>
            <step type="lax:get-source-url-v7">
               <prolog>
                  <documentation length="371">
                     <xhtml:section xml:lang="en"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                                    xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Get source URL</xhtml:h2>
                        <xhtml:p>For a resource associated with a page, builds a URL from the base URL, API version, document identifier, etc.</xhtml:p>
                        <xhtml:p>Creates <xhtml:code>@url</xhtml:code> attribute for the <xhtml:code>&lt;lad:page&gt;</xhtml:code> element.</xhtml:p>
                     </xhtml:section>
                     <xhtml:section xml:lang="cs"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                                    xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Sestavení URL zdroje</xhtml:h2>
                        <xhtml:p>Pro zdroj přiřazený ke stránce sestaví adresu URL ze základní adresy URL, verze rozhraní API, identifikátoru dokumentu apod.</xhtml:p>
                        <xhtml:p>Vytvoří atribut <xhtml:code>@url</xhtml:code> v rámci elementu <xhtml:code>&lt;lad:page&gt;</xhtml:code>.</xhtml:p>
                     </xhtml:section>
                  </documentation>
                  <namespaces>
                     <namespace prefix="array"
                                value="http://www.w3.org/2005/xpath-functions/array"/>
                     <namespace prefix="lad"
                                value="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"/>
                     <namespace prefix="las"
                                value="https://www.mzk.cz/ns/libri-augmentati/settings/1.0"/>
                     <namespace prefix="lax"
                                value="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"/>
                     <namespace prefix="map"
                                value="http://www.w3.org/2005/xpath-functions/map"/>
                     <namespace prefix="p"
                                value="http://www.w3.org/ns/xproc"/>
                     <namespace prefix="xhtml"
                                value="http://www.w3.org/1999/xhtml"/>
                     <namespace prefix="xlog"
                                value="https://www.daliboris.cz/ns/xproc/logging/1.0"/>
                     <namespace prefix="xs"
                                value="http://www.w3.org/2001/XMLSchema"/>
                     <namespace prefix="xml"
                                value="http://www.w3.org/XML/1998/namespace"/>
                  </namespaces>
                  <options>
                     <option name="debug-path"
                             select="()"
                             as="xs:string?"/>
                     <option name="base-uri"
                             as="xs:anyURI"
                             select="static-base-uri()"/>
                  </options>
                  <ports>
                     <input port="source"
                            primary="true"/>
                     <output port="result"
                             primary="true"/>
                  </ports>
               </prolog>
               <body>
                  <documentation length="371">
                     <xhtml:section xml:lang="en"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                                    xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Get source URL</xhtml:h2>
                        <xhtml:p>For a resource associated with a page, builds a URL from the base URL, API version, document identifier, etc.</xhtml:p>
                        <xhtml:p>Creates <xhtml:code>@url</xhtml:code> attribute for the <xhtml:code>&lt;lad:page&gt;</xhtml:code> element.</xhtml:p>
                     </xhtml:section>
                     <xhtml:section xml:lang="cs"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                                    xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Sestavení URL zdroje</xhtml:h2>
                        <xhtml:p>Pro zdroj přiřazený ke stránce sestaví adresu URL ze základní adresy URL, verze rozhraní API, identifikátoru dokumentu apod.</xhtml:p>
                        <xhtml:p>Vytvoří atribut <xhtml:code>@url</xhtml:code> v rámci elementu <xhtml:code>&lt;lad:page&gt;</xhtml:code>.</xhtml:p>
                     </xhtml:section>
                  </documentation>
                  <call step="p:variable"
                        name="debug">
                     <parameter name="select"
                                value="$debug-path || '' ne ''"/>
                  </call>
                  <call step="p:variable"
                        name="debug-path-uri">
                     <parameter name="select"
                                value="resolve-uri($debug-path, $base-uri)"/>
                  </call>
                  <call step="p:variable"
                        name="options">
                     <parameter name="select"
                                value="/lad:document/lad:options"/>
                  </call>
                  <call step="p:variable"
                        name="resources">
                     <parameter name="select"
                                value="/lad:document/las:api/las:resource"/>
                  </call>
                  <call step="p:viewport">
                     <parameter name="match"
                                value="lad:page"/>
                     <parameter name="p:variable"
                                value=""/>
                     <parameter name="p:variable"
                                value=""/>
                     <parameter name="p:viewport"
                                value="&#xA;             &#xA;             &#xA;             &#xA;             &#xA;             &#xA;         "/>
                  </call>
               </body>
            </step>
            <step type="lax:get-available-formats-v7"
                  name="getting-available-formats">
               <prolog>
                  <documentation length="378">
                     <xhtml:section xml:lang="en"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                                    xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Get available formats</xhtml:h2>
                        <xhtml:p>Selects one page from the middle of the document and checks which resources are available on-line.</xhtml:p>
                        <xhtml:p>For each requested <xhtml:code>&lt;resource&gt;</xhtml:code> adds <xhtml:code>@available</xhtml:code> attribute.</xhtml:p>
                     </xhtml:section>
                     <xhtml:section xml:lang="cs"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                                    xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Zjištění dostupných formátů</xhtml:h2>
                        <xhtml:p>Pro stránku zprostředka publikace zjistí, které všechny zdroje jsou dostupné on-line.</xhtml:p>
                        <xhtml:p>Pro každý požadovaný zdroj vytvoří atribut <xhtml:code>@available</xhtml:code> v rámci elementu <xhtml:code>&lt;lad:resource&gt;</xhtml:code>.</xhtml:p>
                     </xhtml:section>
                  </documentation>
                  <namespaces>
                     <namespace prefix="array"
                                value="http://www.w3.org/2005/xpath-functions/array"/>
                     <namespace prefix="lad"
                                value="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"/>
                     <namespace prefix="las"
                                value="https://www.mzk.cz/ns/libri-augmentati/settings/1.0"/>
                     <namespace prefix="lax"
                                value="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"/>
                     <namespace prefix="map"
                                value="http://www.w3.org/2005/xpath-functions/map"/>
                     <namespace prefix="p"
                                value="http://www.w3.org/ns/xproc"/>
                     <namespace prefix="xhtml"
                                value="http://www.w3.org/1999/xhtml"/>
                     <namespace prefix="xlog"
                                value="https://www.daliboris.cz/ns/xproc/logging/1.0"/>
                     <namespace prefix="xs"
                                value="http://www.w3.org/2001/XMLSchema"/>
                     <namespace prefix="xml"
                                value="http://www.w3.org/XML/1998/namespace"/>
                  </namespaces>
                  <options>
                     <option name="debug-path"
                             select="()"
                             as="xs:string?"/>
                     <option name="base-uri"
                             as="xs:anyURI"
                             select="static-base-uri()"/>
                     <option name="base-url"
                             as="xs:anyURI"/>
                  </options>
                  <ports>
                     <input port="source"
                            primary="true"/>
                     <output port="result"
                             primary="true"/>
                  </ports>
               </prolog>
               <body>
                  <documentation length="378">
                     <xhtml:section xml:lang="en"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                                    xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Get available formats</xhtml:h2>
                        <xhtml:p>Selects one page from the middle of the document and checks which resources are available on-line.</xhtml:p>
                        <xhtml:p>For each requested <xhtml:code>&lt;resource&gt;</xhtml:code> adds <xhtml:code>@available</xhtml:code> attribute.</xhtml:p>
                     </xhtml:section>
                     <xhtml:section xml:lang="cs"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                                    xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Zjištění dostupných formátů</xhtml:h2>
                        <xhtml:p>Pro stránku zprostředka publikace zjistí, které všechny zdroje jsou dostupné on-line.</xhtml:p>
                        <xhtml:p>Pro každý požadovaný zdroj vytvoří atribut <xhtml:code>@available</xhtml:code> v rámci elementu <xhtml:code>&lt;lad:resource&gt;</xhtml:code>.</xhtml:p>
                     </xhtml:section>
                  </documentation>
                  <call step="p:variable"
                        name="size">
                     <parameter name="select"
                                value="count(/lad:document/lad:pages/lad:page)"/>
                     <parameter name="as"
                                value="xs:integer"/>
                  </call>
                  <call step="p:variable"
                        name="page">
                     <parameter name="select"
                                value="/lad:document/lad:pages/lad:page[xs:integer($size div 2)]"/>
                  </call>
                  <call step="p:variable"
                        name="options">
                     <parameter name="select"
                                value="/lad:document/lad:options"/>
                  </call>
                  <call step="p:variable"
                        name="resources">
                     <parameter name="select"
                                value="/lad:document/las:api/las:resource[tokenize(@level) = 'page'][@type=tokenize($options/@page-resources)]"/>
                  </call>
                  <call step="p:for-each">
                     <port name="anonymous">
                        <parameter name="select"
                                   value="$resources"/>
                     </port>
                  </call>
                  <call step="p:insert">
                     <parameter name="match"
                                value="lad:page"/>
                     <parameter name="position"
                                value="first-child"/>
                     <port name="source">
                        <parameter name="pipe"
                                   value="source@getting-available-formats"/>
                     </port>
                     <port name="insertion">
                        <parameter name="pipe"
                                   value="result@available-resources"/>
                     </port>
                  </call>
                  <call step="p:namespace-delete">
                     <parameter name="prefixes"
                                value="array"/>
                  </call>
               </body>
            </step>
            <step type="lax:get-available-format-v7"
                  name="getting-available-format">
               <prolog>
                  <documentation length="247">
                     <xhtml:section xml:lang="en"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                                    xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Get available format</xhtml:h2>
                        <xhtml:p>Checks if the resource is available on-line.</xhtml:p>
                        <xhtml:p>Returns <xhtml:code>&lt;resource&gt;</xhtml:code> with the <xhtml:code>@available</xhtml:code> attribute.</xhtml:p>
                     </xhtml:section>
                     <xhtml:section xml:lang="cs"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                                    xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Zjištění dostupnosti formátu</xhtml:h2>
                        <xhtml:p>Zjistí, zda je požadovaný zdroj dostupný on-line.</xhtml:p>
                        <xhtml:p>Vrací element <xhtml:code>&lt;lad:resource&gt;</xhtml:code> s atributem <xhtml:code>@available</xhtml:code>.</xhtml:p>
                     </xhtml:section>
                  </documentation>
                  <namespaces>
                     <namespace prefix="array"
                                value="http://www.w3.org/2005/xpath-functions/array"/>
                     <namespace prefix="lad"
                                value="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"/>
                     <namespace prefix="las"
                                value="https://www.mzk.cz/ns/libri-augmentati/settings/1.0"/>
                     <namespace prefix="lax"
                                value="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"/>
                     <namespace prefix="map"
                                value="http://www.w3.org/2005/xpath-functions/map"/>
                     <namespace prefix="p"
                                value="http://www.w3.org/ns/xproc"/>
                     <namespace prefix="xhtml"
                                value="http://www.w3.org/1999/xhtml"/>
                     <namespace prefix="xlog"
                                value="https://www.daliboris.cz/ns/xproc/logging/1.0"/>
                     <namespace prefix="xs"
                                value="http://www.w3.org/2001/XMLSchema"/>
                     <namespace prefix="xml"
                                value="http://www.w3.org/XML/1998/namespace"/>
                  </namespaces>
                  <options>
                     <option name="debug-path"
                             select="()"
                             as="xs:string?"/>
                     <option name="base-uri"
                             as="xs:anyURI"
                             select="static-base-uri()"/>
                     <option name="url"
                             as="xs:anyURI"
                             required="true"/>
                     <option name="format"
                             as="xs:string"
                             required="true"/>
                  </options>
                  <ports>
                     <input port="source"
                            primary="true"/>
                     <output port="result"
                             primary="true"/>
                  </ports>
               </prolog>
               <body>
                  <documentation length="247">
                     <xhtml:section xml:lang="en"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                                    xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Get available format</xhtml:h2>
                        <xhtml:p>Checks if the resource is available on-line.</xhtml:p>
                        <xhtml:p>Returns <xhtml:code>&lt;resource&gt;</xhtml:code> with the <xhtml:code>@available</xhtml:code> attribute.</xhtml:p>
                     </xhtml:section>
                     <xhtml:section xml:lang="cs"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                                    xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Zjištění dostupnosti formátu</xhtml:h2>
                        <xhtml:p>Zjistí, zda je požadovaný zdroj dostupný on-line.</xhtml:p>
                        <xhtml:p>Vrací element <xhtml:code>&lt;lad:resource&gt;</xhtml:code> s atributem <xhtml:code>@available</xhtml:code>.</xhtml:p>
                     </xhtml:section>
                  </documentation>
                  <call step="p:variable"
                        name="debug">
                     <parameter name="select"
                                value="$debug-path || '' ne ''"/>
                  </call>
                  <call step="p:variable"
                        name="debug-path-uri">
                     <parameter name="select"
                                value="resolve-uri($debug-path, $base-uri)"/>
                  </call>
                  <call step="p:http-request"
                        name="request">
                     <parameter name="href"
                                value="{$url}"/>
                     <parameter name="parameters"
                                value="map{'status-only' : true(), 'follow-redirect' : 3 }"/>
                     <parameter name="assert"
                                value=".?status-code lt 500"/>
                  </call>
                  <call step="p:variable"
                        name="available">
                     <parameter name="select"
                                value=".?status-code = (200, 307, 301)"/>
                     <parameter name="pipe"
                                value="report@request"/>
                  </call>
                  <call step="p:add-attribute">
                     <parameter name="attribute-name"
                                value="{$format}"/>
                     <parameter name="attribute-value"
                                value="{$available}"/>
                     <port name="source">
                        <parameter name="pipe"
                                   value="source@getting-available-format"/>
                     </port>
                  </call>
                  <call step="p:insert">
                     <parameter name="match"
                                value="lad:page"/>
                     <parameter name="position"
                                value="first-child"/>
                     <parameter name="use-when"
                                value="false()"/>
                     <port name="insertion"/>
                  </call>
                  <call step="p:identity">
                     <port name="source"/>
                  </call>
               </body>
            </step>
         </body>
      </library>
   </analysis>
   <analysis file-name="libri-augmentati.xpl"
             path="file:///V:/Projekty/Github/MZK/libri-augmentati/src/xproc/libri-augmentati.xpl"
             xmlns="https://www.daliboris.cz/ns/xproc/analysis"
             xmlns:xhtml="http://www.w3.org/1999/xhtml">
      <library semver="1.0.0">
         <prolog>
            <documentation length="199">
               <xhtml:meta name="version"
                           content="1.0.0"
                           xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                           xmlns:mods="http://www.loc.gov/mods/v3"
                           xmlns:err="http://www.w3.org/ns/xproc-error"
                           xmlns:laa="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"
                           xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                           xmlns:lac="https://www.mzk.cz/ns/libri-augmentati/conversion/1.0"
                           xmlns:lae="https://www.mzk.cz/ns/libri-augmentati/enrichment/1.0"
                           xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                           xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                           xmlns:mox="http://www.xml-project.com/morganaxproc"
                           xmlns:lap="https://www.mzk.cz/ns/libri-augmentati/processing/1.0"
                           xmlns:lar="https://www.mzk.cz/ns/libri-augmentati/report/1.0"
                           xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                           xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0"/>
               <xhtml:section xml:lang="en"
                              xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                              xmlns:mods="http://www.loc.gov/mods/v3"
                              xmlns:err="http://www.w3.org/ns/xproc-error"
                              xmlns:laa="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"
                              xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                              xmlns:lac="https://www.mzk.cz/ns/libri-augmentati/conversion/1.0"
                              xmlns:lae="https://www.mzk.cz/ns/libri-augmentati/enrichment/1.0"
                              xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                              xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                              xmlns:mox="http://www.xml-project.com/morganaxproc"
                              xmlns:lap="https://www.mzk.cz/ns/libri-augmentati/processing/1.0"
                              xmlns:lar="https://www.mzk.cz/ns/libri-augmentati/report/1.0"
                              xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                              xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                  <xhtml:h1>Libri augmentati</xhtml:h1>
                  <xhtml:p>The main programming library for digital library data retrieval and enrichment.</xhtml:p>
               </xhtml:section>
               <xhtml:section xml:lang="cs"
                              xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                              xmlns:mods="http://www.loc.gov/mods/v3"
                              xmlns:err="http://www.w3.org/ns/xproc-error"
                              xmlns:laa="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"
                              xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                              xmlns:lac="https://www.mzk.cz/ns/libri-augmentati/conversion/1.0"
                              xmlns:lae="https://www.mzk.cz/ns/libri-augmentati/enrichment/1.0"
                              xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                              xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                              xmlns:mox="http://www.xml-project.com/morganaxproc"
                              xmlns:lap="https://www.mzk.cz/ns/libri-augmentati/processing/1.0"
                              xmlns:lar="https://www.mzk.cz/ns/libri-augmentati/report/1.0"
                              xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                              xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                  <xhtml:h1>Libri augmentati</xhtml:h1>
                  <xhtml:p>Hlavní programová knihovna pro získání dat z digitálních knihoven a jejich obohacení.</xhtml:p>
               </xhtml:section>
            </documentation>
            <namespaces>
               <namespace prefix="array"
                          value="http://www.w3.org/2005/xpath-functions/array"/>
               <namespace prefix="c"
                          value="http://www.w3.org/ns/xproc-step"/>
               <namespace prefix="err"
                          value="http://www.w3.org/ns/xproc-error"/>
               <namespace prefix="laa"
                          value="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"/>
               <namespace prefix="lac"
                          value="https://www.mzk.cz/ns/libri-augmentati/conversion/1.0"/>
               <namespace prefix="lad"
                          value="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"/>
               <namespace prefix="lae"
                          value="https://www.mzk.cz/ns/libri-augmentati/enrichment/1.0"/>
               <namespace prefix="lap"
                          value="https://www.mzk.cz/ns/libri-augmentati/processing/1.0"/>
               <namespace prefix="lar"
                          value="https://www.mzk.cz/ns/libri-augmentati/report/1.0"/>
               <namespace prefix="las"
                          value="https://www.mzk.cz/ns/libri-augmentati/settings/1.0"/>
               <namespace prefix="lax"
                          value="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"/>
               <namespace prefix="map"
                          value="http://www.w3.org/2005/xpath-functions/map"/>
               <namespace prefix="mods"
                          value="http://www.loc.gov/mods/v3"/>
               <namespace prefix="mox"
                          value="http://www.xml-project.com/morganaxproc"/>
               <namespace prefix="p"
                          value="http://www.w3.org/ns/xproc"/>
               <namespace prefix="xhtml"
                          value="http://www.w3.org/1999/xhtml"/>
               <namespace prefix="xlog"
                          value="https://www.daliboris.cz/ns/xproc/logging/1.0"/>
               <namespace prefix="xs"
                          value="http://www.w3.org/2001/XMLSchema"/>
               <namespace prefix="xml"
                          value="http://www.w3.org/XML/1998/namespace"/>
            </namespaces>
            <imports/>
            <options/>
         </prolog>
         <body>
            <documentation length="199">
               <xhtml:meta name="version"
                           content="1.0.0"
                           xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                           xmlns:mods="http://www.loc.gov/mods/v3"
                           xmlns:err="http://www.w3.org/ns/xproc-error"
                           xmlns:laa="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"
                           xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                           xmlns:lac="https://www.mzk.cz/ns/libri-augmentati/conversion/1.0"
                           xmlns:lae="https://www.mzk.cz/ns/libri-augmentati/enrichment/1.0"
                           xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                           xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                           xmlns:mox="http://www.xml-project.com/morganaxproc"
                           xmlns:lap="https://www.mzk.cz/ns/libri-augmentati/processing/1.0"
                           xmlns:lar="https://www.mzk.cz/ns/libri-augmentati/report/1.0"
                           xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                           xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0"/>
               <xhtml:section xml:lang="en"
                              xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                              xmlns:mods="http://www.loc.gov/mods/v3"
                              xmlns:err="http://www.w3.org/ns/xproc-error"
                              xmlns:laa="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"
                              xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                              xmlns:lac="https://www.mzk.cz/ns/libri-augmentati/conversion/1.0"
                              xmlns:lae="https://www.mzk.cz/ns/libri-augmentati/enrichment/1.0"
                              xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                              xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                              xmlns:mox="http://www.xml-project.com/morganaxproc"
                              xmlns:lap="https://www.mzk.cz/ns/libri-augmentati/processing/1.0"
                              xmlns:lar="https://www.mzk.cz/ns/libri-augmentati/report/1.0"
                              xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                              xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                  <xhtml:h1>Libri augmentati</xhtml:h1>
                  <xhtml:p>The main programming library for digital library data retrieval and enrichment.</xhtml:p>
               </xhtml:section>
               <xhtml:section xml:lang="cs"
                              xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                              xmlns:mods="http://www.loc.gov/mods/v3"
                              xmlns:err="http://www.w3.org/ns/xproc-error"
                              xmlns:laa="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"
                              xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                              xmlns:lac="https://www.mzk.cz/ns/libri-augmentati/conversion/1.0"
                              xmlns:lae="https://www.mzk.cz/ns/libri-augmentati/enrichment/1.0"
                              xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                              xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                              xmlns:mox="http://www.xml-project.com/morganaxproc"
                              xmlns:lap="https://www.mzk.cz/ns/libri-augmentati/processing/1.0"
                              xmlns:lar="https://www.mzk.cz/ns/libri-augmentati/report/1.0"
                              xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                              xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                  <xhtml:h1>Libri augmentati</xhtml:h1>
                  <xhtml:p>Hlavní programová knihovna pro získání dat z digitálních knihoven a jejich obohacení.</xhtml:p>
               </xhtml:section>
            </documentation>
            <step type="lax:build-virtual-document"
                  name="building-virtual-document">
               <prolog>
                  <documentation length="321">
                     <xhtml:section xml:lang="en"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:mods="http://www.loc.gov/mods/v3"
                                    xmlns:err="http://www.w3.org/ns/xproc-error"
                                    xmlns:laa="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:lac="https://www.mzk.cz/ns/libri-augmentati/conversion/1.0"
                                    xmlns:lae="https://www.mzk.cz/ns/libri-augmentati/enrichment/1.0"
                                    xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                                    xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                                    xmlns:mox="http://www.xml-project.com/morganaxproc"
                                    xmlns:lap="https://www.mzk.cz/ns/libri-augmentati/processing/1.0"
                                    xmlns:lar="https://www.mzk.cz/ns/libri-augmentati/report/1.0"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Build virtual document</xhtml:h2>
                        <xhtml:p>Gathers all requested metadata about the publication. Creates the content of the virtual document with links to all requested resources.</xhtml:p>
                     </xhtml:section>
                     <xhtml:section xml:lang="cs"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:mods="http://www.loc.gov/mods/v3"
                                    xmlns:err="http://www.w3.org/ns/xproc-error"
                                    xmlns:laa="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:lac="https://www.mzk.cz/ns/libri-augmentati/conversion/1.0"
                                    xmlns:lae="https://www.mzk.cz/ns/libri-augmentati/enrichment/1.0"
                                    xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                                    xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                                    xmlns:mox="http://www.xml-project.com/morganaxproc"
                                    xmlns:lap="https://www.mzk.cz/ns/libri-augmentati/processing/1.0"
                                    xmlns:lar="https://www.mzk.cz/ns/libri-augmentati/report/1.0"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Sestavení virtuálního dokumentu</xhtml:h2>
                        <xhtml:p>Shromáždí všechna požadovaná metadata o publikaci. Vytvoří strukturu virutálního dokumentu s odkazy na všechny požadované zdroje.</xhtml:p>
                     </xhtml:section>
                  </documentation>
                  <namespaces>
                     <namespace prefix="array"
                                value="http://www.w3.org/2005/xpath-functions/array"/>
                     <namespace prefix="c"
                                value="http://www.w3.org/ns/xproc-step"/>
                     <namespace prefix="err"
                                value="http://www.w3.org/ns/xproc-error"/>
                     <namespace prefix="laa"
                                value="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"/>
                     <namespace prefix="lac"
                                value="https://www.mzk.cz/ns/libri-augmentati/conversion/1.0"/>
                     <namespace prefix="lad"
                                value="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"/>
                     <namespace prefix="lae"
                                value="https://www.mzk.cz/ns/libri-augmentati/enrichment/1.0"/>
                     <namespace prefix="lap"
                                value="https://www.mzk.cz/ns/libri-augmentati/processing/1.0"/>
                     <namespace prefix="lar"
                                value="https://www.mzk.cz/ns/libri-augmentati/report/1.0"/>
                     <namespace prefix="las"
                                value="https://www.mzk.cz/ns/libri-augmentati/settings/1.0"/>
                     <namespace prefix="lax"
                                value="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"/>
                     <namespace prefix="map"
                                value="http://www.w3.org/2005/xpath-functions/map"/>
                     <namespace prefix="mods"
                                value="http://www.loc.gov/mods/v3"/>
                     <namespace prefix="mox"
                                value="http://www.xml-project.com/morganaxproc"/>
                     <namespace prefix="p"
                                value="http://www.w3.org/ns/xproc"/>
                     <namespace prefix="xhtml"
                                value="http://www.w3.org/1999/xhtml"/>
                     <namespace prefix="xlog"
                                value="https://www.daliboris.cz/ns/xproc/logging/1.0"/>
                     <namespace prefix="xs"
                                value="http://www.w3.org/2001/XMLSchema"/>
                     <namespace prefix="xml"
                                value="http://www.w3.org/XML/1998/namespace"/>
                  </namespaces>
                  <options>
                     <option name="debug-path"
                             select="()"
                             as="xs:string?"/>
                     <option name="base-uri"
                             as="xs:anyURI"
                             select="static-base-uri()"/>
                     <option name="library-code"
                             as="xs:string"
                             required="true"/>
                     <option name="api-version"
                             as="xs:string?"/>
                     <option name="system"
                             as="xs:string?"
                             values="('Kramerius', 'Polona')"
                             required="false"/>
                     <option name="document-resources"
                             as="xs:token*"/>
                     <option name="page-resources"
                             as="xs:token*"/>
                  </options>
                  <ports>
                     <input port="source"
                            primary="true"/>
                     <input port="settings"/>
                     <input port="report-in"/>
                     <output port="result"
                             primary="true"
                             sequence="true"/>
                     <output port="report"
                             primary="false"
                             sequence="false"
                             pipe="report-in@building-virtual-document"/>
                  </ports>
               </prolog>
               <body>
                  <documentation length="321">
                     <xhtml:section xml:lang="en"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:mods="http://www.loc.gov/mods/v3"
                                    xmlns:err="http://www.w3.org/ns/xproc-error"
                                    xmlns:laa="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:lac="https://www.mzk.cz/ns/libri-augmentati/conversion/1.0"
                                    xmlns:lae="https://www.mzk.cz/ns/libri-augmentati/enrichment/1.0"
                                    xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                                    xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                                    xmlns:mox="http://www.xml-project.com/morganaxproc"
                                    xmlns:lap="https://www.mzk.cz/ns/libri-augmentati/processing/1.0"
                                    xmlns:lar="https://www.mzk.cz/ns/libri-augmentati/report/1.0"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Build virtual document</xhtml:h2>
                        <xhtml:p>Gathers all requested metadata about the publication. Creates the content of the virtual document with links to all requested resources.</xhtml:p>
                     </xhtml:section>
                     <xhtml:section xml:lang="cs"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:mods="http://www.loc.gov/mods/v3"
                                    xmlns:err="http://www.w3.org/ns/xproc-error"
                                    xmlns:laa="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:lac="https://www.mzk.cz/ns/libri-augmentati/conversion/1.0"
                                    xmlns:lae="https://www.mzk.cz/ns/libri-augmentati/enrichment/1.0"
                                    xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                                    xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                                    xmlns:mox="http://www.xml-project.com/morganaxproc"
                                    xmlns:lap="https://www.mzk.cz/ns/libri-augmentati/processing/1.0"
                                    xmlns:lar="https://www.mzk.cz/ns/libri-augmentati/report/1.0"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Sestavení virtuálního dokumentu</xhtml:h2>
                        <xhtml:p>Shromáždí všechna požadovaná metadata o publikaci. Vytvoří strukturu virutálního dokumentu s odkazy na všechny požadované zdroje.</xhtml:p>
                     </xhtml:section>
                  </documentation>
                  <call step="p:variable"
                        name="debug">
                     <parameter name="select"
                                value="$debug-path || '' ne ''"/>
                  </call>
                  <call step="p:variable"
                        name="debug-path-uri">
                     <parameter name="select"
                                value="resolve-uri($debug-path, $base-uri)"/>
                  </call>
                  <call step="p:variable"
                        name="library">
                     <parameter name="select"
                                value="/las:digital-libraries/las:libraries/las:library[@code=$library-code]"/>
                     <parameter name="pipe"
                                value="settings@building-virtual-document"/>
                  </call>
                  <call step="p:variable"
                        name="apis">
                     <parameter name="select"
                                value="/las:digital-libraries/las:apis/las:api"/>
                     <parameter name="pipe"
                                value="settings@building-virtual-document"/>
                  </call>
                  <call step="p:variable"
                        name="api">
                     <parameter name="select"
                                value="let $lib-apis := $apis[@xml:id =$library/las:api/@ref/substring-after(., '#')] return if(exists($api-version)) then $lib-apis[@version=$api-version] else $lib-apis[1] "/>
                  </call>
                  <call step="p:variable"
                        name="base-url">
                     <parameter name="select"
                                value="$library/las:api[@ref=concat('#', $api/@xml:id)]/@url"/>
                  </call>
                  <call step="p:identity"
                        name="options">
                     <port name="anonymous"/>
                  </call>
                  <call step="p:for-each">
                     <port name="anonymous">
                        <parameter name="select"
                                   value="/lad:documents/lad:document"/>
                        <parameter name="pipe"
                                   value="source@building-virtual-document"/>
                     </port>
                  </call>
               </body>
            </step>
            <step type="lax:get-virtual-document-metadata"
                  name="getting-virtual-document-metadata">
               <prolog>
                  <documentation length="506">
                     <xhtml:section xml:lang="en"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:mods="http://www.loc.gov/mods/v3"
                                    xmlns:err="http://www.w3.org/ns/xproc-error"
                                    xmlns:laa="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:lac="https://www.mzk.cz/ns/libri-augmentati/conversion/1.0"
                                    xmlns:lae="https://www.mzk.cz/ns/libri-augmentati/enrichment/1.0"
                                    xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                                    xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                                    xmlns:mox="http://www.xml-project.com/morganaxproc"
                                    xmlns:lap="https://www.mzk.cz/ns/libri-augmentati/processing/1.0"
                                    xmlns:lar="https://www.mzk.cz/ns/libri-augmentati/report/1.0"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Get virtual document metadata</xhtml:h2>
                        <xhtml:p>Gathers all requested metadata about the publication. Downloads the content (files) of the virtual document from external targets.</xhtml:p>
                        <xhtml:p>Saves data to the disk and enhance input data by adding info about local path of the requested resources.</xhtml:p>
                     </xhtml:section>
                     <xhtml:section xml:lang="cs"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:mods="http://www.loc.gov/mods/v3"
                                    xmlns:err="http://www.w3.org/ns/xproc-error"
                                    xmlns:laa="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:lac="https://www.mzk.cz/ns/libri-augmentati/conversion/1.0"
                                    xmlns:lae="https://www.mzk.cz/ns/libri-augmentati/enrichment/1.0"
                                    xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                                    xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                                    xmlns:mox="http://www.xml-project.com/morganaxproc"
                                    xmlns:lap="https://www.mzk.cz/ns/libri-augmentati/processing/1.0"
                                    xmlns:lar="https://www.mzk.cz/ns/libri-augmentati/report/1.0"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Získání metadat virtuálního dokumentu</xhtml:h2>
                        <xhtml:p>Shromáždí všechna požadovaná metadata publikace. Stáhne obsah (soubory) virutálního dokumentu z externích odkazů.</xhtml:p>
                        <xhtml:p>Uloží data na disk a obohatí vstupní data přidáním informace o lokálním uložení zdrojů.</xhtml:p>
                     </xhtml:section>
                  </documentation>
                  <namespaces>
                     <namespace prefix="array"
                                value="http://www.w3.org/2005/xpath-functions/array"/>
                     <namespace prefix="c"
                                value="http://www.w3.org/ns/xproc-step"/>
                     <namespace prefix="err"
                                value="http://www.w3.org/ns/xproc-error"/>
                     <namespace prefix="laa"
                                value="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"/>
                     <namespace prefix="lac"
                                value="https://www.mzk.cz/ns/libri-augmentati/conversion/1.0"/>
                     <namespace prefix="lad"
                                value="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"/>
                     <namespace prefix="lae"
                                value="https://www.mzk.cz/ns/libri-augmentati/enrichment/1.0"/>
                     <namespace prefix="lap"
                                value="https://www.mzk.cz/ns/libri-augmentati/processing/1.0"/>
                     <namespace prefix="lar"
                                value="https://www.mzk.cz/ns/libri-augmentati/report/1.0"/>
                     <namespace prefix="las"
                                value="https://www.mzk.cz/ns/libri-augmentati/settings/1.0"/>
                     <namespace prefix="lax"
                                value="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"/>
                     <namespace prefix="map"
                                value="http://www.w3.org/2005/xpath-functions/map"/>
                     <namespace prefix="mods"
                                value="http://www.loc.gov/mods/v3"/>
                     <namespace prefix="mox"
                                value="http://www.xml-project.com/morganaxproc"/>
                     <namespace prefix="p"
                                value="http://www.w3.org/ns/xproc"/>
                     <namespace prefix="xhtml"
                                value="http://www.w3.org/1999/xhtml"/>
                     <namespace prefix="xlog"
                                value="https://www.daliboris.cz/ns/xproc/logging/1.0"/>
                     <namespace prefix="xs"
                                value="http://www.w3.org/2001/XMLSchema"/>
                     <namespace prefix="xml"
                                value="http://www.w3.org/XML/1998/namespace"/>
                  </namespaces>
                  <options>
                     <option name="debug-path"
                             select="()"
                             as="xs:string?"/>
                     <option name="base-uri"
                             as="xs:anyURI"
                             select="static-base-uri()"/>
                  </options>
                  <ports>
                     <input port="source"
                            primary="true"/>
                     <input port="report-in"/>
                     <output port="result"
                             primary="true"/>
                     <output port="report"
                             primary="false"
                             sequence="false"
                             pipe="report-in@getting-virtual-document-metadata"/>
                  </ports>
               </prolog>
               <body>
                  <documentation length="506">
                     <xhtml:section xml:lang="en"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:mods="http://www.loc.gov/mods/v3"
                                    xmlns:err="http://www.w3.org/ns/xproc-error"
                                    xmlns:laa="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:lac="https://www.mzk.cz/ns/libri-augmentati/conversion/1.0"
                                    xmlns:lae="https://www.mzk.cz/ns/libri-augmentati/enrichment/1.0"
                                    xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                                    xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                                    xmlns:mox="http://www.xml-project.com/morganaxproc"
                                    xmlns:lap="https://www.mzk.cz/ns/libri-augmentati/processing/1.0"
                                    xmlns:lar="https://www.mzk.cz/ns/libri-augmentati/report/1.0"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Get virtual document metadata</xhtml:h2>
                        <xhtml:p>Gathers all requested metadata about the publication. Downloads the content (files) of the virtual document from external targets.</xhtml:p>
                        <xhtml:p>Saves data to the disk and enhance input data by adding info about local path of the requested resources.</xhtml:p>
                     </xhtml:section>
                     <xhtml:section xml:lang="cs"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:mods="http://www.loc.gov/mods/v3"
                                    xmlns:err="http://www.w3.org/ns/xproc-error"
                                    xmlns:laa="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:lac="https://www.mzk.cz/ns/libri-augmentati/conversion/1.0"
                                    xmlns:lae="https://www.mzk.cz/ns/libri-augmentati/enrichment/1.0"
                                    xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                                    xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                                    xmlns:mox="http://www.xml-project.com/morganaxproc"
                                    xmlns:lap="https://www.mzk.cz/ns/libri-augmentati/processing/1.0"
                                    xmlns:lar="https://www.mzk.cz/ns/libri-augmentati/report/1.0"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Získání metadat virtuálního dokumentu</xhtml:h2>
                        <xhtml:p>Shromáždí všechna požadovaná metadata publikace. Stáhne obsah (soubory) virutálního dokumentu z externích odkazů.</xhtml:p>
                        <xhtml:p>Uloží data na disk a obohatí vstupní data přidáním informace o lokálním uložení zdrojů.</xhtml:p>
                     </xhtml:section>
                  </documentation>
                  <call step="p:variable"
                        name="debug">
                     <parameter name="select"
                                value="$debug-path || '' ne ''"/>
                  </call>
                  <call step="p:variable"
                        name="debug-path-uri">
                     <parameter name="select"
                                value="resolve-uri($debug-path, $base-uri)"/>
                  </call>
                  <call step="p:variable"
                        name="api-version">
                     <parameter name="select"
                                value="/lad:document/lad:options/@api-version"/>
                  </call>
                  <call step="p:variable"
                        name="system">
                     <parameter name="select"
                                value="/lad:document/lad:options/@system"/>
                  </call>
                  <call step="p:variable"
                        name="library-code">
                     <parameter name="select"
                                value="/lad:document/las:library/@code"/>
                  </call>
                  <call step="p:variable"
                        name="library">
                     <parameter name="select"
                                value="/lad:document/las:library"/>
                  </call>
                  <call step="p:choose"
                        length="1"/>
                  <call step="p:namespace-delete">
                     <parameter name="prefixes"
                                value="c xs map mox array"/>
                  </call>
                  <call step="p:if">
                     <parameter name="test"
                                value="$debug"/>
                     <parameter name="p:variable"
                                value=""/>
                     <parameter name="p:store"
                                value=""/>
                  </call>
               </body>
            </step>
            <step type="lax:prepare-text-data"
                  name="preparing-text-data">
               <prolog>
                  <namespaces>
                     <namespace prefix="array"
                                value="http://www.w3.org/2005/xpath-functions/array"/>
                     <namespace prefix="c"
                                value="http://www.w3.org/ns/xproc-step"/>
                     <namespace prefix="err"
                                value="http://www.w3.org/ns/xproc-error"/>
                     <namespace prefix="laa"
                                value="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"/>
                     <namespace prefix="lac"
                                value="https://www.mzk.cz/ns/libri-augmentati/conversion/1.0"/>
                     <namespace prefix="lad"
                                value="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"/>
                     <namespace prefix="lae"
                                value="https://www.mzk.cz/ns/libri-augmentati/enrichment/1.0"/>
                     <namespace prefix="lap"
                                value="https://www.mzk.cz/ns/libri-augmentati/processing/1.0"/>
                     <namespace prefix="lar"
                                value="https://www.mzk.cz/ns/libri-augmentati/report/1.0"/>
                     <namespace prefix="las"
                                value="https://www.mzk.cz/ns/libri-augmentati/settings/1.0"/>
                     <namespace prefix="lax"
                                value="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"/>
                     <namespace prefix="map"
                                value="http://www.w3.org/2005/xpath-functions/map"/>
                     <namespace prefix="mods"
                                value="http://www.loc.gov/mods/v3"/>
                     <namespace prefix="mox"
                                value="http://www.xml-project.com/morganaxproc"/>
                     <namespace prefix="p"
                                value="http://www.w3.org/ns/xproc"/>
                     <namespace prefix="xhtml"
                                value="http://www.w3.org/1999/xhtml"/>
                     <namespace prefix="xlog"
                                value="https://www.daliboris.cz/ns/xproc/logging/1.0"/>
                     <namespace prefix="xs"
                                value="http://www.w3.org/2001/XMLSchema"/>
                     <namespace prefix="xml"
                                value="http://www.w3.org/XML/1998/namespace"/>
                  </namespaces>
                  <options>
                     <option name="debug-path"
                             select="()"
                             as="xs:string?"/>
                     <option name="base-uri"
                             as="xs:anyURI"
                             select="static-base-uri()"/>
                     <option name="output-directory"
                             required="true"
                             as="xs:string"/>
                     <option name="pause-before-request"
                             select="2"
                             as="xs:integer"/>
                  </options>
                  <ports>
                     <input port="source"
                            primary="true"/>
                     <input port="report-in"/>
                     <output port="result"
                             primary="true"/>
                     <output port="report"
                             primary="false"
                             sequence="false"
                             pipe="report-in@preparing-text-data"/>
                  </ports>
               </prolog>
               <body>
                  <call step="p:variable"
                        name="debug">
                     <parameter name="select"
                                value="$debug-path || '' ne ''"/>
                  </call>
                  <call step="p:variable"
                        name="debug-path-uri">
                     <parameter name="select"
                                value="resolve-uri($debug-path, $base-uri)"/>
                  </call>
                  <call step="laa:combine-alto-pages">
                     <parameter name="output-directory"
                                value="{$output-directory}"/>
                     <parameter name="debug-path"
                                value="{$debug-path}"/>
                     <parameter name="base-uri"
                                value="{$base-uri}"/>
                     <port name="report-in">
                        <parameter name="pipe"
                                   value="report-in@preparing-text-data"/>
                     </port>
                  </call>
               </body>
            </step>
            <step type="lax:download-document-data"
                  name="downloading-document-data">
               <prolog>
                  <documentation length="511">
                     <xhtml:section xml:lang="en"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:mods="http://www.loc.gov/mods/v3"
                                    xmlns:err="http://www.w3.org/ns/xproc-error"
                                    xmlns:laa="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:lac="https://www.mzk.cz/ns/libri-augmentati/conversion/1.0"
                                    xmlns:lae="https://www.mzk.cz/ns/libri-augmentati/enrichment/1.0"
                                    xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                                    xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                                    xmlns:mox="http://www.xml-project.com/morganaxproc"
                                    xmlns:lap="https://www.mzk.cz/ns/libri-augmentati/processing/1.0"
                                    xmlns:lar="https://www.mzk.cz/ns/libri-augmentati/report/1.0"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Download document data</xhtml:h2>
                        <xhtml:p>Gathers all requested data and metadata about the publication. Downloads the content (files) of the virtual document from external targets.</xhtml:p>
                        <xhtml:p>Saves data to the disk and enhance input data by adding info about local path of the requested resources.</xhtml:p>
                     </xhtml:section>
                     <xhtml:section xml:lang="cs"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:mods="http://www.loc.gov/mods/v3"
                                    xmlns:err="http://www.w3.org/ns/xproc-error"
                                    xmlns:laa="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:lac="https://www.mzk.cz/ns/libri-augmentati/conversion/1.0"
                                    xmlns:lae="https://www.mzk.cz/ns/libri-augmentati/enrichment/1.0"
                                    xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                                    xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                                    xmlns:mox="http://www.xml-project.com/morganaxproc"
                                    xmlns:lap="https://www.mzk.cz/ns/libri-augmentati/processing/1.0"
                                    xmlns:lar="https://www.mzk.cz/ns/libri-augmentati/report/1.0"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Stažení dat virtuálního dokumentu</xhtml:h2>
                        <xhtml:p>Shromáždí všechna požadovaná data a metadata publikace. Stáhne obsah (soubory) virutálního dokumentu z externích odkazů.</xhtml:p>
                        <xhtml:p>Uloží data na disk a obohatí vstupní data přidáním informace o lokálním uložení zdrojů.</xhtml:p>
                     </xhtml:section>
                  </documentation>
                  <namespaces>
                     <namespace prefix="array"
                                value="http://www.w3.org/2005/xpath-functions/array"/>
                     <namespace prefix="c"
                                value="http://www.w3.org/ns/xproc-step"/>
                     <namespace prefix="err"
                                value="http://www.w3.org/ns/xproc-error"/>
                     <namespace prefix="laa"
                                value="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"/>
                     <namespace prefix="lac"
                                value="https://www.mzk.cz/ns/libri-augmentati/conversion/1.0"/>
                     <namespace prefix="lad"
                                value="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"/>
                     <namespace prefix="lae"
                                value="https://www.mzk.cz/ns/libri-augmentati/enrichment/1.0"/>
                     <namespace prefix="lap"
                                value="https://www.mzk.cz/ns/libri-augmentati/processing/1.0"/>
                     <namespace prefix="lar"
                                value="https://www.mzk.cz/ns/libri-augmentati/report/1.0"/>
                     <namespace prefix="las"
                                value="https://www.mzk.cz/ns/libri-augmentati/settings/1.0"/>
                     <namespace prefix="lax"
                                value="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"/>
                     <namespace prefix="map"
                                value="http://www.w3.org/2005/xpath-functions/map"/>
                     <namespace prefix="mods"
                                value="http://www.loc.gov/mods/v3"/>
                     <namespace prefix="mox"
                                value="http://www.xml-project.com/morganaxproc"/>
                     <namespace prefix="p"
                                value="http://www.w3.org/ns/xproc"/>
                     <namespace prefix="xhtml"
                                value="http://www.w3.org/1999/xhtml"/>
                     <namespace prefix="xlog"
                                value="https://www.daliboris.cz/ns/xproc/logging/1.0"/>
                     <namespace prefix="xs"
                                value="http://www.w3.org/2001/XMLSchema"/>
                     <namespace prefix="xml"
                                value="http://www.w3.org/XML/1998/namespace"/>
                  </namespaces>
                  <options>
                     <option name="debug-path"
                             select="()"
                             as="xs:string?"/>
                     <option name="base-uri"
                             as="xs:anyURI"
                             select="static-base-uri()"/>
                     <option name="output-directory"
                             required="true"
                             as="xs:string"/>
                     <option name="pause-before-request"
                             select="2"
                             as="xs:integer"/>
                  </options>
                  <ports>
                     <input port="source"
                            primary="true"
                            sequence="true"/>
                     <input port="report-in"
                            sequence="true"/>
                     <output port="result"
                             primary="true"
                             sequence="true"/>
                     <output port="report"
                             primary="false"
                             sequence="false"
                             pipe="report-in@downloading-document-data"/>
                  </ports>
               </prolog>
               <body>
                  <documentation length="511">
                     <xhtml:section xml:lang="en"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:mods="http://www.loc.gov/mods/v3"
                                    xmlns:err="http://www.w3.org/ns/xproc-error"
                                    xmlns:laa="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:lac="https://www.mzk.cz/ns/libri-augmentati/conversion/1.0"
                                    xmlns:lae="https://www.mzk.cz/ns/libri-augmentati/enrichment/1.0"
                                    xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                                    xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                                    xmlns:mox="http://www.xml-project.com/morganaxproc"
                                    xmlns:lap="https://www.mzk.cz/ns/libri-augmentati/processing/1.0"
                                    xmlns:lar="https://www.mzk.cz/ns/libri-augmentati/report/1.0"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Download document data</xhtml:h2>
                        <xhtml:p>Gathers all requested data and metadata about the publication. Downloads the content (files) of the virtual document from external targets.</xhtml:p>
                        <xhtml:p>Saves data to the disk and enhance input data by adding info about local path of the requested resources.</xhtml:p>
                     </xhtml:section>
                     <xhtml:section xml:lang="cs"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:mods="http://www.loc.gov/mods/v3"
                                    xmlns:err="http://www.w3.org/ns/xproc-error"
                                    xmlns:laa="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:lac="https://www.mzk.cz/ns/libri-augmentati/conversion/1.0"
                                    xmlns:lae="https://www.mzk.cz/ns/libri-augmentati/enrichment/1.0"
                                    xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                                    xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                                    xmlns:mox="http://www.xml-project.com/morganaxproc"
                                    xmlns:lap="https://www.mzk.cz/ns/libri-augmentati/processing/1.0"
                                    xmlns:lar="https://www.mzk.cz/ns/libri-augmentati/report/1.0"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Stažení dat virtuálního dokumentu</xhtml:h2>
                        <xhtml:p>Shromáždí všechna požadovaná data a metadata publikace. Stáhne obsah (soubory) virutálního dokumentu z externích odkazů.</xhtml:p>
                        <xhtml:p>Uloží data na disk a obohatí vstupní data přidáním informace o lokálním uložení zdrojů.</xhtml:p>
                     </xhtml:section>
                  </documentation>
                  <call step="p:viewport">
                     <parameter name="match"
                                value="lad:document"/>
                     <parameter name="p:variable"
                                value=""/>
                     <parameter name="p:variable"
                                value=""/>
                     <parameter name="p:variable"
                                value=""/>
                     <parameter name="p:variable"
                                value=""/>
                     <parameter name="p:add-attribute"
                                value=""/>
                     <parameter name="p:viewport"
                                value="&#xA;    &#xA;    &#xA;    &#xA;     &#xA;    &#xA;   "/>
                     <parameter name="p:viewport"
                                value="&#xA;    &#xA;    &#xA;    &#xA;    &#xA;     &#xA;    &#xA;   "/>
                  </call>
                  <call step="p:viewport">
                     <parameter name="match"
                                value="lad:document"/>
                     <parameter name="p:variable"
                                value=""/>
                     <parameter name="p:variable"
                                value=""/>
                     <parameter name="p:variable"
                                value=""/>
                     <parameter name="p:variable"
                                value=""/>
                     <parameter name="p:variable"
                                value=""/>
                     <parameter name="p:variable"
                                value=""/>
                     <parameter name="p:variable"
                                value=""/>
                     <parameter name="p:if"
                                value="&#xA;     &#xA;   "/>
                     <parameter name="p:if"
                                value="&#xA;     &#xA;   "/>
                     <parameter name="p:if"
                                value="&#xA;     &#xA;   "/>
                  </call>
               </body>
            </step>
            <step type="lax:download-document-resources">
               <prolog>
                  <documentation length="398">
                     <xhtml:section xml:lang="en"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:mods="http://www.loc.gov/mods/v3"
                                    xmlns:err="http://www.w3.org/ns/xproc-error"
                                    xmlns:laa="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:lac="https://www.mzk.cz/ns/libri-augmentati/conversion/1.0"
                                    xmlns:lae="https://www.mzk.cz/ns/libri-augmentati/enrichment/1.0"
                                    xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                                    xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                                    xmlns:mox="http://www.xml-project.com/morganaxproc"
                                    xmlns:lap="https://www.mzk.cz/ns/libri-augmentati/processing/1.0"
                                    xmlns:lar="https://www.mzk.cz/ns/libri-augmentati/report/1.0"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Download document resources</xhtml:h2>
                        <xhtml:p>Downloads the content (files) of the document-related resources from external targets.</xhtml:p>
                        <xhtml:p>Saves data to the disk and enhance input data by adding info about local path of the requested resources.</xhtml:p>
                     </xhtml:section>
                     <xhtml:section xml:lang="cs"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:mods="http://www.loc.gov/mods/v3"
                                    xmlns:err="http://www.w3.org/ns/xproc-error"
                                    xmlns:laa="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:lac="https://www.mzk.cz/ns/libri-augmentati/conversion/1.0"
                                    xmlns:lae="https://www.mzk.cz/ns/libri-augmentati/enrichment/1.0"
                                    xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                                    xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                                    xmlns:mox="http://www.xml-project.com/morganaxproc"
                                    xmlns:lap="https://www.mzk.cz/ns/libri-augmentati/processing/1.0"
                                    xmlns:lar="https://www.mzk.cz/ns/libri-augmentati/report/1.0"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Stažení zdrojů dokumentu</xhtml:h2>
                        <xhtml:p>Stáhne obsah (soubory) virutálního dokumentu z externích odkazů.</xhtml:p>
                        <xhtml:p>Uloží data na disk a obohatí vstupní data přidáním informace o lokálním uložení zdrojů.</xhtml:p>
                     </xhtml:section>
                  </documentation>
                  <namespaces>
                     <namespace prefix="array"
                                value="http://www.w3.org/2005/xpath-functions/array"/>
                     <namespace prefix="c"
                                value="http://www.w3.org/ns/xproc-step"/>
                     <namespace prefix="err"
                                value="http://www.w3.org/ns/xproc-error"/>
                     <namespace prefix="laa"
                                value="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"/>
                     <namespace prefix="lac"
                                value="https://www.mzk.cz/ns/libri-augmentati/conversion/1.0"/>
                     <namespace prefix="lad"
                                value="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"/>
                     <namespace prefix="lae"
                                value="https://www.mzk.cz/ns/libri-augmentati/enrichment/1.0"/>
                     <namespace prefix="lap"
                                value="https://www.mzk.cz/ns/libri-augmentati/processing/1.0"/>
                     <namespace prefix="lar"
                                value="https://www.mzk.cz/ns/libri-augmentati/report/1.0"/>
                     <namespace prefix="las"
                                value="https://www.mzk.cz/ns/libri-augmentati/settings/1.0"/>
                     <namespace prefix="lax"
                                value="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"/>
                     <namespace prefix="map"
                                value="http://www.w3.org/2005/xpath-functions/map"/>
                     <namespace prefix="mods"
                                value="http://www.loc.gov/mods/v3"/>
                     <namespace prefix="mox"
                                value="http://www.xml-project.com/morganaxproc"/>
                     <namespace prefix="p"
                                value="http://www.w3.org/ns/xproc"/>
                     <namespace prefix="xhtml"
                                value="http://www.w3.org/1999/xhtml"/>
                     <namespace prefix="xlog"
                                value="https://www.daliboris.cz/ns/xproc/logging/1.0"/>
                     <namespace prefix="xs"
                                value="http://www.w3.org/2001/XMLSchema"/>
                     <namespace prefix="xml"
                                value="http://www.w3.org/XML/1998/namespace"/>
                  </namespaces>
                  <options>
                     <option name="debug-path"
                             select="()"
                             as="xs:string?"/>
                     <option name="base-uri"
                             as="xs:anyURI"
                             select="static-base-uri()"/>
                     <option name="output-directory"
                             required="true"
                             as="xs:string"/>
                     <option name="position"
                             required="true"/>
                     <option name="type"
                             required="true"
                             as="xs:string"/>
                     <option name="pause-before-request"
                             required="true"
                             as="xs:integer"/>
                  </options>
                  <ports>
                     <input port="source"
                            primary="true"
                            sequence="true"/>
                     <output port="result"
                             primary="true"
                             sequence="true"/>
                  </ports>
               </prolog>
               <body>
                  <documentation length="398">
                     <xhtml:section xml:lang="en"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:mods="http://www.loc.gov/mods/v3"
                                    xmlns:err="http://www.w3.org/ns/xproc-error"
                                    xmlns:laa="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:lac="https://www.mzk.cz/ns/libri-augmentati/conversion/1.0"
                                    xmlns:lae="https://www.mzk.cz/ns/libri-augmentati/enrichment/1.0"
                                    xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                                    xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                                    xmlns:mox="http://www.xml-project.com/morganaxproc"
                                    xmlns:lap="https://www.mzk.cz/ns/libri-augmentati/processing/1.0"
                                    xmlns:lar="https://www.mzk.cz/ns/libri-augmentati/report/1.0"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Download document resources</xhtml:h2>
                        <xhtml:p>Downloads the content (files) of the document-related resources from external targets.</xhtml:p>
                        <xhtml:p>Saves data to the disk and enhance input data by adding info about local path of the requested resources.</xhtml:p>
                     </xhtml:section>
                     <xhtml:section xml:lang="cs"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:mods="http://www.loc.gov/mods/v3"
                                    xmlns:err="http://www.w3.org/ns/xproc-error"
                                    xmlns:laa="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:lac="https://www.mzk.cz/ns/libri-augmentati/conversion/1.0"
                                    xmlns:lae="https://www.mzk.cz/ns/libri-augmentati/enrichment/1.0"
                                    xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                                    xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                                    xmlns:mox="http://www.xml-project.com/morganaxproc"
                                    xmlns:lap="https://www.mzk.cz/ns/libri-augmentati/processing/1.0"
                                    xmlns:lar="https://www.mzk.cz/ns/libri-augmentati/report/1.0"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Stažení zdrojů dokumentu</xhtml:h2>
                        <xhtml:p>Stáhne obsah (soubory) virutálního dokumentu z externích odkazů.</xhtml:p>
                        <xhtml:p>Uloží data na disk a obohatí vstupní data přidáním informace o lokálním uložení zdrojů.</xhtml:p>
                     </xhtml:section>
                  </documentation>
                  <call step="p:variable"
                        name="debug">
                     <parameter name="select"
                                value="$debug-path || '' ne ''"/>
                  </call>
                  <call step="p:variable"
                        name="debug-path-uri">
                     <parameter name="select"
                                value="resolve-uri($debug-path, $base-uri)"/>
                  </call>
                  <call step="p:variable"
                        name="output-directory-uri">
                     <parameter name="select"
                                value="resolve-uri($output-directory, $base-uri)"/>
                  </call>
                  <call step="p:viewport">
                     <parameter name="match"
                                value="lad:resource"/>
                     <parameter name="p:variable"
                                value=""/>
                     <parameter name="p:variable"
                                value=""/>
                     <parameter name="p:variable"
                                value=""/>
                     <parameter name="p:variable"
                                value=""/>
                     <parameter name="p:variable"
                                value=""/>
                     <parameter name="p:variable"
                                value=""/>
                     <parameter name="p:variable"
                                value=""/>
                     <parameter name="p:set-attributes"
                                value=""/>
                     <parameter name="lax:check-local-file-exists"
                                value=""/>
                     <parameter name="p:variable"
                                value=""/>
                     <parameter name="p:if"
                                value="&#xA;    &#xA;   "/>
                     <parameter name="lax:check-local-file-exists"
                                value="&#xA;    &#xA;   "/>
                  </call>
               </body>
            </step>
            <step type="lax:check-local-file-exists"
                  name="checking-local-file-exists">
               <prolog>
                  <documentation length="164">
                     <xhtml:section xml:lang="en"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:mods="http://www.loc.gov/mods/v3"
                                    xmlns:err="http://www.w3.org/ns/xproc-error"
                                    xmlns:laa="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:lac="https://www.mzk.cz/ns/libri-augmentati/conversion/1.0"
                                    xmlns:lae="https://www.mzk.cz/ns/libri-augmentati/enrichment/1.0"
                                    xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                                    xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                                    xmlns:mox="http://www.xml-project.com/morganaxproc"
                                    xmlns:lap="https://www.mzk.cz/ns/libri-augmentati/processing/1.0"
                                    xmlns:lar="https://www.mzk.cz/ns/libri-augmentati/report/1.0"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Check local file exists</xhtml:h2>
                        <xhtml:p>Checks if the file is stored on the local computer.</xhtml:p>
                     </xhtml:section>
                     <xhtml:section xml:lang="cs"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:mods="http://www.loc.gov/mods/v3"
                                    xmlns:err="http://www.w3.org/ns/xproc-error"
                                    xmlns:laa="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:lac="https://www.mzk.cz/ns/libri-augmentati/conversion/1.0"
                                    xmlns:lae="https://www.mzk.cz/ns/libri-augmentati/enrichment/1.0"
                                    xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                                    xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                                    xmlns:mox="http://www.xml-project.com/morganaxproc"
                                    xmlns:lap="https://www.mzk.cz/ns/libri-augmentati/processing/1.0"
                                    xmlns:lar="https://www.mzk.cz/ns/libri-augmentati/report/1.0"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Zjištění existence místního souboru</xhtml:h2>
                        <xhtml:p>Zjistí, jestli je soubor stažen na místním počítači.</xhtml:p>
                     </xhtml:section>
                  </documentation>
                  <namespaces>
                     <namespace prefix="array"
                                value="http://www.w3.org/2005/xpath-functions/array"/>
                     <namespace prefix="c"
                                value="http://www.w3.org/ns/xproc-step"/>
                     <namespace prefix="err"
                                value="http://www.w3.org/ns/xproc-error"/>
                     <namespace prefix="laa"
                                value="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"/>
                     <namespace prefix="lac"
                                value="https://www.mzk.cz/ns/libri-augmentati/conversion/1.0"/>
                     <namespace prefix="lad"
                                value="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"/>
                     <namespace prefix="lae"
                                value="https://www.mzk.cz/ns/libri-augmentati/enrichment/1.0"/>
                     <namespace prefix="lap"
                                value="https://www.mzk.cz/ns/libri-augmentati/processing/1.0"/>
                     <namespace prefix="lar"
                                value="https://www.mzk.cz/ns/libri-augmentati/report/1.0"/>
                     <namespace prefix="las"
                                value="https://www.mzk.cz/ns/libri-augmentati/settings/1.0"/>
                     <namespace prefix="lax"
                                value="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"/>
                     <namespace prefix="map"
                                value="http://www.w3.org/2005/xpath-functions/map"/>
                     <namespace prefix="mods"
                                value="http://www.loc.gov/mods/v3"/>
                     <namespace prefix="mox"
                                value="http://www.xml-project.com/morganaxproc"/>
                     <namespace prefix="p"
                                value="http://www.w3.org/ns/xproc"/>
                     <namespace prefix="xhtml"
                                value="http://www.w3.org/1999/xhtml"/>
                     <namespace prefix="xlog"
                                value="https://www.daliboris.cz/ns/xproc/logging/1.0"/>
                     <namespace prefix="xs"
                                value="http://www.w3.org/2001/XMLSchema"/>
                     <namespace prefix="xml"
                                value="http://www.w3.org/XML/1998/namespace"/>
                  </namespaces>
                  <options>
                     <option name="debug-path"
                             select="()"
                             as="xs:string?"/>
                     <option name="base-uri"
                             as="xs:anyURI"
                             select="static-base-uri()"/>
                  </options>
                  <ports>
                     <input port="source"
                            primary="true"/>
                     <output port="result"
                             primary="true"/>
                  </ports>
               </prolog>
               <body>
                  <documentation length="164">
                     <xhtml:section xml:lang="en"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:mods="http://www.loc.gov/mods/v3"
                                    xmlns:err="http://www.w3.org/ns/xproc-error"
                                    xmlns:laa="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:lac="https://www.mzk.cz/ns/libri-augmentati/conversion/1.0"
                                    xmlns:lae="https://www.mzk.cz/ns/libri-augmentati/enrichment/1.0"
                                    xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                                    xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                                    xmlns:mox="http://www.xml-project.com/morganaxproc"
                                    xmlns:lap="https://www.mzk.cz/ns/libri-augmentati/processing/1.0"
                                    xmlns:lar="https://www.mzk.cz/ns/libri-augmentati/report/1.0"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Check local file exists</xhtml:h2>
                        <xhtml:p>Checks if the file is stored on the local computer.</xhtml:p>
                     </xhtml:section>
                     <xhtml:section xml:lang="cs"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:mods="http://www.loc.gov/mods/v3"
                                    xmlns:err="http://www.w3.org/ns/xproc-error"
                                    xmlns:laa="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:lac="https://www.mzk.cz/ns/libri-augmentati/conversion/1.0"
                                    xmlns:lae="https://www.mzk.cz/ns/libri-augmentati/enrichment/1.0"
                                    xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                                    xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                                    xmlns:mox="http://www.xml-project.com/morganaxproc"
                                    xmlns:lap="https://www.mzk.cz/ns/libri-augmentati/processing/1.0"
                                    xmlns:lar="https://www.mzk.cz/ns/libri-augmentati/report/1.0"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Zjištění existence místního souboru</xhtml:h2>
                        <xhtml:p>Zjistí, jestli je soubor stažen na místním počítači.</xhtml:p>
                     </xhtml:section>
                  </documentation>
                  <call step="p:variable"
                        name="debug">
                     <parameter name="select"
                                value="$debug-path || '' ne ''"/>
                  </call>
                  <call step="p:variable"
                        name="debug-path-uri">
                     <parameter name="select"
                                value="resolve-uri($debug-path, $base-uri)"/>
                  </call>
                  <call step="p:variable"
                        name="local-path">
                     <parameter name="select"
                                value="/*/@local-uri"/>
                  </call>
                  <call step="p:file-info">
                     <parameter name="href"
                                value="{$local-path}"/>
                     <parameter name="fail-on-error"
                                value="false"/>
                  </call>
                  <call step="p:variable"
                        name="file-exists">
                     <parameter name="select"
                                value="exists(/c:file)"/>
                  </call>
                  <call step="p:add-attribute">
                     <parameter name="attribute-name"
                                value="local-file-exists"/>
                     <parameter name="attribute-value"
                                value="{$file-exists}"/>
                     <port name="source">
                        <parameter name="pipe"
                                   value="source@checking-local-file-exists"/>
                     </port>
                  </call>
               </body>
            </step>
            <step type="lax:download-document-data-items">
               <prolog>
                  <documentation length="147">
                     <xhtml:section xml:lang="en"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:mods="http://www.loc.gov/mods/v3"
                                    xmlns:err="http://www.w3.org/ns/xproc-error"
                                    xmlns:laa="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:lac="https://www.mzk.cz/ns/libri-augmentati/conversion/1.0"
                                    xmlns:lae="https://www.mzk.cz/ns/libri-augmentati/enrichment/1.0"
                                    xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                                    xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                                    xmlns:mox="http://www.xml-project.com/morganaxproc"
                                    xmlns:lap="https://www.mzk.cz/ns/libri-augmentati/processing/1.0"
                                    xmlns:lar="https://www.mzk.cz/ns/libri-augmentati/report/1.0"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Download document data items</xhtml:h2>
                        <xhtml:p>Downloads all data of the virtual document.</xhtml:p>
                     </xhtml:section>
                     <xhtml:section xml:lang="cs"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:mods="http://www.loc.gov/mods/v3"
                                    xmlns:err="http://www.w3.org/ns/xproc-error"
                                    xmlns:laa="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:lac="https://www.mzk.cz/ns/libri-augmentati/conversion/1.0"
                                    xmlns:lae="https://www.mzk.cz/ns/libri-augmentati/enrichment/1.0"
                                    xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                                    xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                                    xmlns:mox="http://www.xml-project.com/morganaxproc"
                                    xmlns:lap="https://www.mzk.cz/ns/libri-augmentati/processing/1.0"
                                    xmlns:lar="https://www.mzk.cz/ns/libri-augmentati/report/1.0"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Stáhnout všechna data dokumentu</xhtml:h2>
                        <xhtml:p>Stáhne všechna data virtuálního dokumentu.</xhtml:p>
                     </xhtml:section>
                  </documentation>
                  <namespaces>
                     <namespace prefix="array"
                                value="http://www.w3.org/2005/xpath-functions/array"/>
                     <namespace prefix="c"
                                value="http://www.w3.org/ns/xproc-step"/>
                     <namespace prefix="err"
                                value="http://www.w3.org/ns/xproc-error"/>
                     <namespace prefix="laa"
                                value="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"/>
                     <namespace prefix="lac"
                                value="https://www.mzk.cz/ns/libri-augmentati/conversion/1.0"/>
                     <namespace prefix="lad"
                                value="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"/>
                     <namespace prefix="lae"
                                value="https://www.mzk.cz/ns/libri-augmentati/enrichment/1.0"/>
                     <namespace prefix="lap"
                                value="https://www.mzk.cz/ns/libri-augmentati/processing/1.0"/>
                     <namespace prefix="lar"
                                value="https://www.mzk.cz/ns/libri-augmentati/report/1.0"/>
                     <namespace prefix="las"
                                value="https://www.mzk.cz/ns/libri-augmentati/settings/1.0"/>
                     <namespace prefix="lax"
                                value="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"/>
                     <namespace prefix="map"
                                value="http://www.w3.org/2005/xpath-functions/map"/>
                     <namespace prefix="mods"
                                value="http://www.loc.gov/mods/v3"/>
                     <namespace prefix="mox"
                                value="http://www.xml-project.com/morganaxproc"/>
                     <namespace prefix="p"
                                value="http://www.w3.org/ns/xproc"/>
                     <namespace prefix="xhtml"
                                value="http://www.w3.org/1999/xhtml"/>
                     <namespace prefix="xlog"
                                value="https://www.daliboris.cz/ns/xproc/logging/1.0"/>
                     <namespace prefix="xs"
                                value="http://www.w3.org/2001/XMLSchema"/>
                     <namespace prefix="xml"
                                value="http://www.w3.org/XML/1998/namespace"/>
                  </namespaces>
                  <options>
                     <option name="debug-path"
                             select="()"
                             as="xs:string?"/>
                     <option name="base-uri"
                             as="xs:anyURI"
                             select="static-base-uri()"/>
                     <option name="output-directory"
                             required="true"/>
                     <option name="type"
                             required="true"
                             as="xs:string"/>
                     <option name="pause-before-request"
                             required="true"
                             as="xs:integer"/>
                  </options>
                  <ports>
                     <input port="source"
                            primary="true"
                            sequence="true"/>
                     <output port="result"
                             primary="true"
                             sequence="true"/>
                  </ports>
               </prolog>
               <body>
                  <documentation length="147">
                     <xhtml:section xml:lang="en"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:mods="http://www.loc.gov/mods/v3"
                                    xmlns:err="http://www.w3.org/ns/xproc-error"
                                    xmlns:laa="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:lac="https://www.mzk.cz/ns/libri-augmentati/conversion/1.0"
                                    xmlns:lae="https://www.mzk.cz/ns/libri-augmentati/enrichment/1.0"
                                    xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                                    xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                                    xmlns:mox="http://www.xml-project.com/morganaxproc"
                                    xmlns:lap="https://www.mzk.cz/ns/libri-augmentati/processing/1.0"
                                    xmlns:lar="https://www.mzk.cz/ns/libri-augmentati/report/1.0"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Download document data items</xhtml:h2>
                        <xhtml:p>Downloads all data of the virtual document.</xhtml:p>
                     </xhtml:section>
                     <xhtml:section xml:lang="cs"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:mods="http://www.loc.gov/mods/v3"
                                    xmlns:err="http://www.w3.org/ns/xproc-error"
                                    xmlns:laa="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:lac="https://www.mzk.cz/ns/libri-augmentati/conversion/1.0"
                                    xmlns:lae="https://www.mzk.cz/ns/libri-augmentati/enrichment/1.0"
                                    xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                                    xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                                    xmlns:mox="http://www.xml-project.com/morganaxproc"
                                    xmlns:lap="https://www.mzk.cz/ns/libri-augmentati/processing/1.0"
                                    xmlns:lar="https://www.mzk.cz/ns/libri-augmentati/report/1.0"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Stáhnout všechna data dokumentu</xhtml:h2>
                        <xhtml:p>Stáhne všechna data virtuálního dokumentu.</xhtml:p>
                     </xhtml:section>
                  </documentation>
                  <call step="p:for-each">
                     <port name="anonymous">
                        <parameter name="select"
                                   value="."/>
                     </port>
                  </call>
               </body>
            </step>
            <step type="lax:download-document">
               <prolog>
                  <documentation length="102">
                     <xhtml:section xml:lang="en"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:mods="http://www.loc.gov/mods/v3"
                                    xmlns:err="http://www.w3.org/ns/xproc-error"
                                    xmlns:laa="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:lac="https://www.mzk.cz/ns/libri-augmentati/conversion/1.0"
                                    xmlns:lae="https://www.mzk.cz/ns/libri-augmentati/enrichment/1.0"
                                    xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                                    xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                                    xmlns:mox="http://www.xml-project.com/morganaxproc"
                                    xmlns:lap="https://www.mzk.cz/ns/libri-augmentati/processing/1.0"
                                    xmlns:lar="https://www.mzk.cz/ns/libri-augmentati/report/1.0"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Download document</xhtml:h2>
                        <xhtml:p>Downloads one document from the web.</xhtml:p>
                     </xhtml:section>
                     <xhtml:section xml:lang="cs"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:mods="http://www.loc.gov/mods/v3"
                                    xmlns:err="http://www.w3.org/ns/xproc-error"
                                    xmlns:laa="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:lac="https://www.mzk.cz/ns/libri-augmentati/conversion/1.0"
                                    xmlns:lae="https://www.mzk.cz/ns/libri-augmentati/enrichment/1.0"
                                    xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                                    xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                                    xmlns:mox="http://www.xml-project.com/morganaxproc"
                                    xmlns:lap="https://www.mzk.cz/ns/libri-augmentati/processing/1.0"
                                    xmlns:lar="https://www.mzk.cz/ns/libri-augmentati/report/1.0"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Stáhnout dokument</xhtml:h2>
                        <xhtml:p>Stáhne z webu jeden dokument.</xhtml:p>
                     </xhtml:section>
                  </documentation>
                  <namespaces>
                     <namespace prefix="array"
                                value="http://www.w3.org/2005/xpath-functions/array"/>
                     <namespace prefix="c"
                                value="http://www.w3.org/ns/xproc-step"/>
                     <namespace prefix="err"
                                value="http://www.w3.org/ns/xproc-error"/>
                     <namespace prefix="laa"
                                value="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"/>
                     <namespace prefix="lac"
                                value="https://www.mzk.cz/ns/libri-augmentati/conversion/1.0"/>
                     <namespace prefix="lad"
                                value="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"/>
                     <namespace prefix="lae"
                                value="https://www.mzk.cz/ns/libri-augmentati/enrichment/1.0"/>
                     <namespace prefix="lap"
                                value="https://www.mzk.cz/ns/libri-augmentati/processing/1.0"/>
                     <namespace prefix="lar"
                                value="https://www.mzk.cz/ns/libri-augmentati/report/1.0"/>
                     <namespace prefix="las"
                                value="https://www.mzk.cz/ns/libri-augmentati/settings/1.0"/>
                     <namespace prefix="lax"
                                value="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"/>
                     <namespace prefix="map"
                                value="http://www.w3.org/2005/xpath-functions/map"/>
                     <namespace prefix="mods"
                                value="http://www.loc.gov/mods/v3"/>
                     <namespace prefix="mox"
                                value="http://www.xml-project.com/morganaxproc"/>
                     <namespace prefix="p"
                                value="http://www.w3.org/ns/xproc"/>
                     <namespace prefix="xhtml"
                                value="http://www.w3.org/1999/xhtml"/>
                     <namespace prefix="xlog"
                                value="https://www.daliboris.cz/ns/xproc/logging/1.0"/>
                     <namespace prefix="xs"
                                value="http://www.w3.org/2001/XMLSchema"/>
                     <namespace prefix="xml"
                                value="http://www.w3.org/XML/1998/namespace"/>
                  </namespaces>
                  <options>
                     <option name="debug-path"
                             select="()"
                             as="xs:string?"/>
                     <option name="base-uri"
                             as="xs:anyURI"
                             select="static-base-uri()"/>
                     <option name="url"
                             as="xs:anyURI"/>
                     <option name="local-path"
                             as="xs:string"/>
                     <option name="pause-before-request"
                             required="true"
                             as="xs:integer"/>
                  </options>
                  <ports>
                     <input port="source"
                            sequence="true"/>
                     <output port="result"
                             primary="true"
                             sequence="true"/>
                  </ports>
               </prolog>
               <body>
                  <documentation length="102">
                     <xhtml:section xml:lang="en"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:mods="http://www.loc.gov/mods/v3"
                                    xmlns:err="http://www.w3.org/ns/xproc-error"
                                    xmlns:laa="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:lac="https://www.mzk.cz/ns/libri-augmentati/conversion/1.0"
                                    xmlns:lae="https://www.mzk.cz/ns/libri-augmentati/enrichment/1.0"
                                    xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                                    xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                                    xmlns:mox="http://www.xml-project.com/morganaxproc"
                                    xmlns:lap="https://www.mzk.cz/ns/libri-augmentati/processing/1.0"
                                    xmlns:lar="https://www.mzk.cz/ns/libri-augmentati/report/1.0"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Download document</xhtml:h2>
                        <xhtml:p>Downloads one document from the web.</xhtml:p>
                     </xhtml:section>
                     <xhtml:section xml:lang="cs"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:mods="http://www.loc.gov/mods/v3"
                                    xmlns:err="http://www.w3.org/ns/xproc-error"
                                    xmlns:laa="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:lac="https://www.mzk.cz/ns/libri-augmentati/conversion/1.0"
                                    xmlns:lae="https://www.mzk.cz/ns/libri-augmentati/enrichment/1.0"
                                    xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                                    xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                                    xmlns:mox="http://www.xml-project.com/morganaxproc"
                                    xmlns:lap="https://www.mzk.cz/ns/libri-augmentati/processing/1.0"
                                    xmlns:lar="https://www.mzk.cz/ns/libri-augmentati/report/1.0"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Stáhnout dokument</xhtml:h2>
                        <xhtml:p>Stáhne z webu jeden dokument.</xhtml:p>
                     </xhtml:section>
                  </documentation>
                  <call step="p:variable"
                        name="content-type">
                     <parameter name="select"
                                value="if(ends-with($url, '.txt')) then 'text/plain' else if(ends-with($url, '.djvu')) then 'image/vnd.djvu' else '*/*'"/>
                  </call>
                  <call step="p:variable"
                        name="local-path-uri">
                     <parameter name="select"
                                value="resolve-uri($local-path, $base-uri)"/>
                  </call>
                  <call step="p:try">
                     <parameter name="p:http-request"
                                value=""/>
                     <parameter name="p:if"
                                value="&#xA;    &#xA;   "/>
                     <parameter name="p:store"
                                value=""/>
                     <parameter name="p:catch"
                                value="&#xA;    &#xA;    &#xA;     &#xA;      File {$url} not downloaded&#xA;     &#xA;    &#xA;   "/>
                     <parameter name="p:catch"
                                value="&#xA;    &#xA;    &#xA;     &#xA;      File {$url} not downloaded&#xA;     &#xA;    &#xA;   "/>
                  </call>
               </body>
            </step>
            <step type="lax:enrich-document-data"
                  name="enriching-document-data">
               <prolog>
                  <documentation length="208">
                     <xhtml:section xml:lang="en"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:mods="http://www.loc.gov/mods/v3"
                                    xmlns:err="http://www.w3.org/ns/xproc-error"
                                    xmlns:laa="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:lac="https://www.mzk.cz/ns/libri-augmentati/conversion/1.0"
                                    xmlns:lae="https://www.mzk.cz/ns/libri-augmentati/enrichment/1.0"
                                    xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                                    xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                                    xmlns:mox="http://www.xml-project.com/morganaxproc"
                                    xmlns:lap="https://www.mzk.cz/ns/libri-augmentati/processing/1.0"
                                    xmlns:lar="https://www.mzk.cz/ns/libri-augmentati/report/1.0"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Enrich document data</xhtml:h2>
                        <xhtml:p>Enriches available (textual) data of the digital book by available services.</xhtml:p>
                     </xhtml:section>
                     <xhtml:section xml:lang="cs"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:mods="http://www.loc.gov/mods/v3"
                                    xmlns:err="http://www.w3.org/ns/xproc-error"
                                    xmlns:laa="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:lac="https://www.mzk.cz/ns/libri-augmentati/conversion/1.0"
                                    xmlns:lae="https://www.mzk.cz/ns/libri-augmentati/enrichment/1.0"
                                    xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                                    xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                                    xmlns:mox="http://www.xml-project.com/morganaxproc"
                                    xmlns:lap="https://www.mzk.cz/ns/libri-augmentati/processing/1.0"
                                    xmlns:lar="https://www.mzk.cz/ns/libri-augmentati/report/1.0"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Obohacení dat dokumentu</xhtml:h2>
                        <xhtml:p>Obohatí dostupná dostupná (textová) data digitální publikací pomocí dostupných služeb.</xhtml:p>
                     </xhtml:section>
                  </documentation>
                  <namespaces>
                     <namespace prefix="array"
                                value="http://www.w3.org/2005/xpath-functions/array"/>
                     <namespace prefix="c"
                                value="http://www.w3.org/ns/xproc-step"/>
                     <namespace prefix="err"
                                value="http://www.w3.org/ns/xproc-error"/>
                     <namespace prefix="laa"
                                value="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"/>
                     <namespace prefix="lac"
                                value="https://www.mzk.cz/ns/libri-augmentati/conversion/1.0"/>
                     <namespace prefix="lad"
                                value="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"/>
                     <namespace prefix="lae"
                                value="https://www.mzk.cz/ns/libri-augmentati/enrichment/1.0"/>
                     <namespace prefix="lap"
                                value="https://www.mzk.cz/ns/libri-augmentati/processing/1.0"/>
                     <namespace prefix="lar"
                                value="https://www.mzk.cz/ns/libri-augmentati/report/1.0"/>
                     <namespace prefix="las"
                                value="https://www.mzk.cz/ns/libri-augmentati/settings/1.0"/>
                     <namespace prefix="lax"
                                value="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"/>
                     <namespace prefix="map"
                                value="http://www.w3.org/2005/xpath-functions/map"/>
                     <namespace prefix="mods"
                                value="http://www.loc.gov/mods/v3"/>
                     <namespace prefix="mox"
                                value="http://www.xml-project.com/morganaxproc"/>
                     <namespace prefix="p"
                                value="http://www.w3.org/ns/xproc"/>
                     <namespace prefix="xhtml"
                                value="http://www.w3.org/1999/xhtml"/>
                     <namespace prefix="xlog"
                                value="https://www.daliboris.cz/ns/xproc/logging/1.0"/>
                     <namespace prefix="xs"
                                value="http://www.w3.org/2001/XMLSchema"/>
                     <namespace prefix="xml"
                                value="http://www.w3.org/XML/1998/namespace"/>
                  </namespaces>
                  <options>
                     <option name="debug-path"
                             select="()"
                             as="xs:string?"/>
                     <option name="base-uri"
                             as="xs:anyURI"
                             select="static-base-uri()"/>
                     <option name="output-directory"
                             required="true"
                             as="xs:string"/>
                     <option name="pause-before-request"
                             select="2"
                             as="xs:integer"/>
                     <option name="output-format"
                             values="('ALTO', 'TEXT', 'TEI')"
                             as="xs:string*"/>
                     <option name="enrichment"
                             values="('ENTITIES', 'MORPHOLOGY')"
                             as="xs:string*"/>
                  </options>
                  <ports>
                     <input port="source"
                            primary="true"
                            sequence="true"/>
                     <input port="settings"
                            primary="false"/>
                     <input port="report-in"
                            sequence="true"/>
                     <output port="result"
                             primary="true"
                             sequence="true"/>
                     <output port="report"
                             pipe="report-in@enriching-document-data"/>
                  </ports>
               </prolog>
               <body>
                  <documentation length="208">
                     <xhtml:section xml:lang="en"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:mods="http://www.loc.gov/mods/v3"
                                    xmlns:err="http://www.w3.org/ns/xproc-error"
                                    xmlns:laa="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:lac="https://www.mzk.cz/ns/libri-augmentati/conversion/1.0"
                                    xmlns:lae="https://www.mzk.cz/ns/libri-augmentati/enrichment/1.0"
                                    xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                                    xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                                    xmlns:mox="http://www.xml-project.com/morganaxproc"
                                    xmlns:lap="https://www.mzk.cz/ns/libri-augmentati/processing/1.0"
                                    xmlns:lar="https://www.mzk.cz/ns/libri-augmentati/report/1.0"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Enrich document data</xhtml:h2>
                        <xhtml:p>Enriches available (textual) data of the digital book by available services.</xhtml:p>
                     </xhtml:section>
                     <xhtml:section xml:lang="cs"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:mods="http://www.loc.gov/mods/v3"
                                    xmlns:err="http://www.w3.org/ns/xproc-error"
                                    xmlns:laa="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:lac="https://www.mzk.cz/ns/libri-augmentati/conversion/1.0"
                                    xmlns:lae="https://www.mzk.cz/ns/libri-augmentati/enrichment/1.0"
                                    xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                                    xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                                    xmlns:mox="http://www.xml-project.com/morganaxproc"
                                    xmlns:lap="https://www.mzk.cz/ns/libri-augmentati/processing/1.0"
                                    xmlns:lar="https://www.mzk.cz/ns/libri-augmentati/report/1.0"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Obohacení dat dokumentu</xhtml:h2>
                        <xhtml:p>Obohatí dostupná dostupná (textová) data digitální publikací pomocí dostupných služeb.</xhtml:p>
                     </xhtml:section>
                  </documentation>
                  <call step="p:viewport">
                     <parameter name="match"
                                value="lad:document"/>
                     <parameter name="use-when"
                                value="false()"/>
                     <parameter name="p:viewport"
                                value="&#xA;    &#xA;    &#xA;     &#xA;      &#xA;      &#xA;      &#xA;      &#xA;     &#xA;    &#xA;   "/>
                  </call>
                  <call step="lae:enrich-data">
                     <parameter name="output-directory"
                                value="{$output-directory}"/>
                     <parameter name="debug-path"
                                value="{$debug-path}"/>
                     <parameter name="base-uri"
                                value="{$base-uri}"/>
                     <parameter name="output-format"
                                value="$output-format"/>
                     <parameter name="enrichment"
                                value="$enrichment"/>
                     <port name="settings">
                        <parameter name="pipe"
                                   value="settings@enriching-document-data"/>
                     </port>
                     <port name="report-in">
                        <parameter name="pipe"
                                   value="report-in@enriching-document-data"/>
                     </port>
                  </call>
               </body>
            </step>
            <step type="lax:create-report"
                  name="creating-report">
               <prolog>
                  <documentation length="162">
                     <xhtml:section xml:lang="en"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:mods="http://www.loc.gov/mods/v3"
                                    xmlns:err="http://www.w3.org/ns/xproc-error"
                                    xmlns:laa="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:lac="https://www.mzk.cz/ns/libri-augmentati/conversion/1.0"
                                    xmlns:lae="https://www.mzk.cz/ns/libri-augmentati/enrichment/1.0"
                                    xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                                    xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                                    xmlns:mox="http://www.xml-project.com/morganaxproc"
                                    xmlns:lap="https://www.mzk.cz/ns/libri-augmentati/processing/1.0"
                                    xmlns:lar="https://www.mzk.cz/ns/libri-augmentati/report/1.0"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Create report</xhtml:h2>
                        <xhtml:p>Creates report with links to original, downloaded and enriched data.</xhtml:p>
                     </xhtml:section>
                     <xhtml:section xml:lang="cs"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:mods="http://www.loc.gov/mods/v3"
                                    xmlns:err="http://www.w3.org/ns/xproc-error"
                                    xmlns:laa="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:lac="https://www.mzk.cz/ns/libri-augmentati/conversion/1.0"
                                    xmlns:lae="https://www.mzk.cz/ns/libri-augmentati/enrichment/1.0"
                                    xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                                    xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                                    xmlns:mox="http://www.xml-project.com/morganaxproc"
                                    xmlns:lap="https://www.mzk.cz/ns/libri-augmentati/processing/1.0"
                                    xmlns:lar="https://www.mzk.cz/ns/libri-augmentati/report/1.0"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Vytvořit přehled</xhtml:h2>
                        <xhtml:p>Vytvoří přehled s odkazy na původní, stažená a obohacená data.</xhtml:p>
                     </xhtml:section>
                  </documentation>
                  <namespaces>
                     <namespace prefix="array"
                                value="http://www.w3.org/2005/xpath-functions/array"/>
                     <namespace prefix="c"
                                value="http://www.w3.org/ns/xproc-step"/>
                     <namespace prefix="err"
                                value="http://www.w3.org/ns/xproc-error"/>
                     <namespace prefix="laa"
                                value="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"/>
                     <namespace prefix="lac"
                                value="https://www.mzk.cz/ns/libri-augmentati/conversion/1.0"/>
                     <namespace prefix="lad"
                                value="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"/>
                     <namespace prefix="lae"
                                value="https://www.mzk.cz/ns/libri-augmentati/enrichment/1.0"/>
                     <namespace prefix="lap"
                                value="https://www.mzk.cz/ns/libri-augmentati/processing/1.0"/>
                     <namespace prefix="lar"
                                value="https://www.mzk.cz/ns/libri-augmentati/report/1.0"/>
                     <namespace prefix="las"
                                value="https://www.mzk.cz/ns/libri-augmentati/settings/1.0"/>
                     <namespace prefix="lax"
                                value="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"/>
                     <namespace prefix="map"
                                value="http://www.w3.org/2005/xpath-functions/map"/>
                     <namespace prefix="mods"
                                value="http://www.loc.gov/mods/v3"/>
                     <namespace prefix="mox"
                                value="http://www.xml-project.com/morganaxproc"/>
                     <namespace prefix="p"
                                value="http://www.w3.org/ns/xproc"/>
                     <namespace prefix="xhtml"
                                value="http://www.w3.org/1999/xhtml"/>
                     <namespace prefix="xlog"
                                value="https://www.daliboris.cz/ns/xproc/logging/1.0"/>
                     <namespace prefix="xs"
                                value="http://www.w3.org/2001/XMLSchema"/>
                     <namespace prefix="xml"
                                value="http://www.w3.org/XML/1998/namespace"/>
                  </namespaces>
                  <options>
                     <option name="debug-path"
                             select="()"
                             as="xs:string?"/>
                     <option name="base-uri"
                             as="xs:anyURI"
                             select="static-base-uri()"/>
                     <option name="output-directory"
                             select="()"
                             as="xs:string?"/>
                  </options>
                  <ports>
                     <input port="source"
                            primary="true"
                            sequence="true"/>
                     <output port="result"
                             primary="true"
                             sequence="true"
                             pipe="result@documents-loop"/>
                     <output port="result-uri"
                             primary="false"
                             sequence="true"
                             pipe="result-uri@documents-loop"/>
                  </ports>
               </prolog>
               <body>
                  <documentation length="162">
                     <xhtml:section xml:lang="en"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:mods="http://www.loc.gov/mods/v3"
                                    xmlns:err="http://www.w3.org/ns/xproc-error"
                                    xmlns:laa="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:lac="https://www.mzk.cz/ns/libri-augmentati/conversion/1.0"
                                    xmlns:lae="https://www.mzk.cz/ns/libri-augmentati/enrichment/1.0"
                                    xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                                    xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                                    xmlns:mox="http://www.xml-project.com/morganaxproc"
                                    xmlns:lap="https://www.mzk.cz/ns/libri-augmentati/processing/1.0"
                                    xmlns:lar="https://www.mzk.cz/ns/libri-augmentati/report/1.0"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Create report</xhtml:h2>
                        <xhtml:p>Creates report with links to original, downloaded and enriched data.</xhtml:p>
                     </xhtml:section>
                     <xhtml:section xml:lang="cs"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:mods="http://www.loc.gov/mods/v3"
                                    xmlns:err="http://www.w3.org/ns/xproc-error"
                                    xmlns:laa="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:lac="https://www.mzk.cz/ns/libri-augmentati/conversion/1.0"
                                    xmlns:lae="https://www.mzk.cz/ns/libri-augmentati/enrichment/1.0"
                                    xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                                    xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                                    xmlns:mox="http://www.xml-project.com/morganaxproc"
                                    xmlns:lap="https://www.mzk.cz/ns/libri-augmentati/processing/1.0"
                                    xmlns:lar="https://www.mzk.cz/ns/libri-augmentati/report/1.0"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Vytvořit přehled</xhtml:h2>
                        <xhtml:p>Vytvoří přehled s odkazy na původní, stažená a obohacená data.</xhtml:p>
                     </xhtml:section>
                  </documentation>
                  <call step="p:variable"
                        name="debug">
                     <parameter name="select"
                                value="$debug-path || '' ne ''"/>
                  </call>
                  <call step="p:variable"
                        name="debug-path-uri">
                     <parameter name="select"
                                value="resolve-uri($debug-path, $base-uri)"/>
                  </call>
                  <call step="p:variable"
                        name="save-output">
                     <parameter name="select"
                                value="$output-directory || '' ne ''"/>
                  </call>
                  <call step="p:variable"
                        name="output-directory-uri">
                     <parameter name="select"
                                value="resolve-uri($output-directory, $base-uri)"/>
                  </call>
                  <call step="p:for-each">
                     <port name="anonymous">
                        <parameter name="select"
                                   value="/*"/>
                     </port>
                  </call>
               </body>
            </step>
            <step type="lax:get-document-id">
               <prolog>
                  <documentation length="215">
                     <xhtml:section xml:lang="en"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:mods="http://www.loc.gov/mods/v3"
                                    xmlns:err="http://www.w3.org/ns/xproc-error"
                                    xmlns:laa="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:lac="https://www.mzk.cz/ns/libri-augmentati/conversion/1.0"
                                    xmlns:lae="https://www.mzk.cz/ns/libri-augmentati/enrichment/1.0"
                                    xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                                    xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                                    xmlns:mox="http://www.xml-project.com/morganaxproc"
                                    xmlns:lap="https://www.mzk.cz/ns/libri-augmentati/processing/1.0"
                                    xmlns:lar="https://www.mzk.cz/ns/libri-augmentati/report/1.0"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Get document id</xhtml:h2>
                        <xhtml:p>Gets nickname or id of the document (without leading 'uuid:') in plain text.</xhtml:p>
                     </xhtml:section>
                     <xhtml:section xml:lang="cs"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:mods="http://www.loc.gov/mods/v3"
                                    xmlns:err="http://www.w3.org/ns/xproc-error"
                                    xmlns:laa="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:lac="https://www.mzk.cz/ns/libri-augmentati/conversion/1.0"
                                    xmlns:lae="https://www.mzk.cz/ns/libri-augmentati/enrichment/1.0"
                                    xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                                    xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                                    xmlns:mox="http://www.xml-project.com/morganaxproc"
                                    xmlns:lap="https://www.mzk.cz/ns/libri-augmentati/processing/1.0"
                                    xmlns:lar="https://www.mzk.cz/ns/libri-augmentati/report/1.0"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Získat id dokumentu</xhtml:h2>
                        <xhtml:p>Získá uživatelské jméno nedo identifikátor dokumentu (bez úvodního 'uuid:') ve formátu prostého textu.</xhtml:p>
                     </xhtml:section>
                  </documentation>
                  <namespaces>
                     <namespace prefix="array"
                                value="http://www.w3.org/2005/xpath-functions/array"/>
                     <namespace prefix="c"
                                value="http://www.w3.org/ns/xproc-step"/>
                     <namespace prefix="err"
                                value="http://www.w3.org/ns/xproc-error"/>
                     <namespace prefix="laa"
                                value="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"/>
                     <namespace prefix="lac"
                                value="https://www.mzk.cz/ns/libri-augmentati/conversion/1.0"/>
                     <namespace prefix="lad"
                                value="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"/>
                     <namespace prefix="lae"
                                value="https://www.mzk.cz/ns/libri-augmentati/enrichment/1.0"/>
                     <namespace prefix="lap"
                                value="https://www.mzk.cz/ns/libri-augmentati/processing/1.0"/>
                     <namespace prefix="lar"
                                value="https://www.mzk.cz/ns/libri-augmentati/report/1.0"/>
                     <namespace prefix="las"
                                value="https://www.mzk.cz/ns/libri-augmentati/settings/1.0"/>
                     <namespace prefix="lax"
                                value="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"/>
                     <namespace prefix="map"
                                value="http://www.w3.org/2005/xpath-functions/map"/>
                     <namespace prefix="mods"
                                value="http://www.loc.gov/mods/v3"/>
                     <namespace prefix="mox"
                                value="http://www.xml-project.com/morganaxproc"/>
                     <namespace prefix="p"
                                value="http://www.w3.org/ns/xproc"/>
                     <namespace prefix="xhtml"
                                value="http://www.w3.org/1999/xhtml"/>
                     <namespace prefix="xlog"
                                value="https://www.daliboris.cz/ns/xproc/logging/1.0"/>
                     <namespace prefix="xs"
                                value="http://www.w3.org/2001/XMLSchema"/>
                     <namespace prefix="xml"
                                value="http://www.w3.org/XML/1998/namespace"/>
                  </namespaces>
                  <ports>
                     <input port="source"/>
                     <output port="result"
                             primary="true"/>
                  </ports>
               </prolog>
               <body>
                  <documentation length="215">
                     <xhtml:section xml:lang="en"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:mods="http://www.loc.gov/mods/v3"
                                    xmlns:err="http://www.w3.org/ns/xproc-error"
                                    xmlns:laa="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:lac="https://www.mzk.cz/ns/libri-augmentati/conversion/1.0"
                                    xmlns:lae="https://www.mzk.cz/ns/libri-augmentati/enrichment/1.0"
                                    xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                                    xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                                    xmlns:mox="http://www.xml-project.com/morganaxproc"
                                    xmlns:lap="https://www.mzk.cz/ns/libri-augmentati/processing/1.0"
                                    xmlns:lar="https://www.mzk.cz/ns/libri-augmentati/report/1.0"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Get document id</xhtml:h2>
                        <xhtml:p>Gets nickname or id of the document (without leading 'uuid:') in plain text.</xhtml:p>
                     </xhtml:section>
                     <xhtml:section xml:lang="cs"
                                    xmlns:lax="https://www.mzk.cz/ns/libri-augmentati/xproc/1.0"
                                    xmlns:mods="http://www.loc.gov/mods/v3"
                                    xmlns:err="http://www.w3.org/ns/xproc-error"
                                    xmlns:laa="https://www.mzk.cz/ns/libri-augmentati/alto/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:lac="https://www.mzk.cz/ns/libri-augmentati/conversion/1.0"
                                    xmlns:lae="https://www.mzk.cz/ns/libri-augmentati/enrichment/1.0"
                                    xmlns:xlog="https://www.daliboris.cz/ns/xproc/logging/1.0"
                                    xmlns:array="http://www.w3.org/2005/xpath-functions/array"
                                    xmlns:mox="http://www.xml-project.com/morganaxproc"
                                    xmlns:lap="https://www.mzk.cz/ns/libri-augmentati/processing/1.0"
                                    xmlns:lar="https://www.mzk.cz/ns/libri-augmentati/report/1.0"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Získat id dokumentu</xhtml:h2>
                        <xhtml:p>Získá uživatelské jméno nedo identifikátor dokumentu (bez úvodního 'uuid:') ve formátu prostého textu.</xhtml:p>
                     </xhtml:section>
                  </documentation>
                  <call step="p:identity">
                     <port name="source"/>
                  </call>
               </body>
            </step>
         </body>
      </library>
   </analysis>
   <analysis file-name="nametag.xpl"
             path="file:///V:/Projekty/Github/MZK/libri-augmentati/src/xproc/nametag.xpl"
             xmlns="https://www.daliboris.cz/ns/xproc/analysis"
             xmlns:xhtml="http://www.w3.org/1999/xhtml">
      <library semver="1.0.0">
         <prolog>
            <documentation length="189">
               <xhtml:meta name="version"
                           content="1.0.0"
                           xmlns:lant="https://www.mzk.cz/ns/libri-augmentati/nametag/1.0"
                           xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                           xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                           xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0"/>
               <xhtml:section xml:lang="en"
                              xmlns:lant="https://www.mzk.cz/ns/libri-augmentati/nametag/1.0"
                              xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                              xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                              xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                  <xhtml:h1>Library for NameTag data processing</xhtml:h1>
                  <xhtml:p>Steps for standalone operations with NameTag service and data.</xhtml:p>
               </xhtml:section>
               <xhtml:section xml:lang="cs"
                              xmlns:lant="https://www.mzk.cz/ns/libri-augmentati/nametag/1.0"
                              xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                              xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                              xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                  <xhtml:h1>Kihovna pro zpracování dat NameTag</xhtml:h1>
                  <xhtml:p>Kroky pro samostatné operace se službou a daty NameTag.</xhtml:p>
               </xhtml:section>
            </documentation>
            <namespaces>
               <namespace prefix="lad"
                          value="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"/>
               <namespace prefix="lant"
                          value="https://www.mzk.cz/ns/libri-augmentati/nametag/1.0"/>
               <namespace prefix="las"
                          value="https://www.mzk.cz/ns/libri-augmentati/settings/1.0"/>
               <namespace prefix="map"
                          value="http://www.w3.org/2005/xpath-functions/map"/>
               <namespace prefix="p"
                          value="http://www.w3.org/ns/xproc"/>
               <namespace prefix="xhtml"
                          value="http://www.w3.org/1999/xhtml"/>
               <namespace prefix="xs"
                          value="http://www.w3.org/2001/XMLSchema"/>
               <namespace prefix="xml"
                          value="http://www.w3.org/XML/1998/namespace"/>
            </namespaces>
         </prolog>
         <body>
            <documentation length="189">
               <xhtml:meta name="version"
                           content="1.0.0"
                           xmlns:lant="https://www.mzk.cz/ns/libri-augmentati/nametag/1.0"
                           xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                           xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                           xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0"/>
               <xhtml:section xml:lang="en"
                              xmlns:lant="https://www.mzk.cz/ns/libri-augmentati/nametag/1.0"
                              xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                              xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                              xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                  <xhtml:h1>Library for NameTag data processing</xhtml:h1>
                  <xhtml:p>Steps for standalone operations with NameTag service and data.</xhtml:p>
               </xhtml:section>
               <xhtml:section xml:lang="cs"
                              xmlns:lant="https://www.mzk.cz/ns/libri-augmentati/nametag/1.0"
                              xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                              xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                              xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                  <xhtml:h1>Kihovna pro zpracování dat NameTag</xhtml:h1>
                  <xhtml:p>Kroky pro samostatné operace se službou a daty NameTag.</xhtml:p>
               </xhtml:section>
            </documentation>
            <step type="lant:get-nametag-analysis"
                  name="getting-nametag-analysis">
               <prolog>
                  <documentation length="264">
                     <xhtml:section xml:lang="en"
                                    xmlns:lant="https://www.mzk.cz/ns/libri-augmentati/nametag/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Get NameTag analysis</xhtml:h2>
                        <xhtml:p>It calls the REST API of the NameTag service, passes it the text to recognize, and returns the result in JSON format.</xhtml:p>
                     </xhtml:section>
                     <xhtml:section xml:lang="cs"
                                    xmlns:lant="https://www.mzk.cz/ns/libri-augmentati/nametag/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Analýza textu NameTagem</xhtml:h2>
                        <xhtml:p>Zavolá rozhraní REST API služby NameTag, předá jí text k rozpoznání a vrátí výsledek ve formátu JSON.</xhtml:p>
                     </xhtml:section>
                  </documentation>
                  <namespaces>
                     <namespace prefix="lad"
                                value="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"/>
                     <namespace prefix="lant"
                                value="https://www.mzk.cz/ns/libri-augmentati/nametag/1.0"/>
                     <namespace prefix="las"
                                value="https://www.mzk.cz/ns/libri-augmentati/settings/1.0"/>
                     <namespace prefix="map"
                                value="http://www.w3.org/2005/xpath-functions/map"/>
                     <namespace prefix="p"
                                value="http://www.w3.org/ns/xproc"/>
                     <namespace prefix="xhtml"
                                value="http://www.w3.org/1999/xhtml"/>
                     <namespace prefix="xs"
                                value="http://www.w3.org/2001/XMLSchema"/>
                     <namespace prefix="xml"
                                value="http://www.w3.org/XML/1998/namespace"/>
                  </namespaces>
                  <options>
                     <option name="debug-path"
                             select="()"
                             as="xs:string?"/>
                     <option name="base-uri"
                             as="xs:anyURI"
                             select="static-base-uri()"/>
                     <option name="file-stem"
                             as="xs:string?"/>
                     <option name="language"
                             as="xs:string?"
                             select="'cze'"/>
                  </options>
                  <ports>
                     <input port="source"
                            primary="true"/>
                     <input port="settings"
                            primary="false"/>
                     <input port="report-in"
                            primary="false"/>
                     <output port="result"
                             primary="true"/>
                     <output port="report"
                             pipe="report-in@getting-nametag-analysis"/>
                  </ports>
               </prolog>
               <body>
                  <documentation length="264">
                     <xhtml:section xml:lang="en"
                                    xmlns:lant="https://www.mzk.cz/ns/libri-augmentati/nametag/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Get NameTag analysis</xhtml:h2>
                        <xhtml:p>It calls the REST API of the NameTag service, passes it the text to recognize, and returns the result in JSON format.</xhtml:p>
                     </xhtml:section>
                     <xhtml:section xml:lang="cs"
                                    xmlns:lant="https://www.mzk.cz/ns/libri-augmentati/nametag/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Analýza textu NameTagem</xhtml:h2>
                        <xhtml:p>Zavolá rozhraní REST API služby NameTag, předá jí text k rozpoznání a vrátí výsledek ve formátu JSON.</xhtml:p>
                     </xhtml:section>
                  </documentation>
                  <call step="p:variable"
                        name="debug">
                     <parameter name="select"
                                value="$debug-path || '' ne ''"/>
                  </call>
                  <call step="p:variable"
                        name="debug-path-uri">
                     <parameter name="select"
                                value="resolve-uri($debug-path, $base-uri)"/>
                  </call>
                  <call step="p:variable"
                        name="language-models">
                     <parameter name="select"
                                value="map {    'cze': 'czech',    'ces': 'czech',    'dut': 'dutch',    'nld': 'dutch',    'eng': 'english',    'deu': 'german',    'ger': 'german',    'spa': 'spanish',    'multi' : 'multilingual'    }"/>
                  </call>
                  <call step="p:variable"
                        name="language-model">
                     <parameter name="select"
                                value="if(map:contains($language-models, $language))      then $language-models?($language)      else $language-models?multi"/>
                  </call>
                  <call step="p:variable"
                        name="service">
                     <parameter name="select"
                                value="//las:service[@code='nametag']"/>
                     <parameter name="pipe"
                                value="settings@getting-nametag-analysis"/>
                  </call>
                  <call step="p:variable"
                        name="service-url">
                     <parameter name="select"
                                value="$service/las:api/@url"/>
                     <parameter name="p:documentation"
                                value="&#xA;    &#xA;     URL of the REST service.&#xA;    &#xA;    &#xA;     URL RESTové služby.&#xA;    &#xA;   "/>
                  </call>
                  <call step="p:variable"
                        name="api-id">
                     <parameter name="select"
                                value="substring-after($service/las:api/@ref, '#')"/>
                     <parameter name="p:documentation"
                                value="&#xA;    &#xA;     Identifier of the REST service.&#xA;    &#xA;    &#xA;     Identifikátor RESTové služby.&#xA;    &#xA;   "/>
                  </call>
                  <call step="p:variable"
                        name="feature">
                     <parameter name="select"
                                value="//las:api[@xml:id=$api-id]/las:feature[@type='entities'][@method='post']"/>
                     <parameter name="pipe"
                                value="settings@getting-nametag-analysis"/>
                  </call>
                  <call step="p:variable"
                        name="step-url">
                     <parameter name="select"
                                value="concat($service-url, $feature/@url)"/>
                  </call>
                  <call step="p:variable"
                        name="step-params">
                     <parameter name="select"
                                value="string-join($feature/las:param[@place='body'][not(@name =('data','model'))]//concat(@name, '=', @value), '&amp;') "/>
                  </call>
                  <call step="p:variable"
                        name="step-params">
                     <parameter name="select"
                                value="$step-params || '&amp;model=' || $language-model"/>
                  </call>
                  <call step="p:variable"
                        name="full-text">
                     <parameter name="select"
                                value="."/>
                  </call>
                  <call step="p:if">
                     <parameter name="test"
                                value="$debug"/>
                     <parameter name="p:store"
                                value="&#xA;    &#xA;   "/>
                  </call>
                  <call step="p:http-request">
                     <parameter name="href"
                                value="{$step-url}"/>
                     <parameter name="method"
                                value="'POST'"/>
                     <parameter name="p:documentation"
                                value="&#xA;    &#xA;     Calling the NameTag service API using the POST method. The input parameter to the service is plain text, encoded for the URI.&#xA;    &#xA;    &#xA;     Volání API služby NameTag pomocí metodyPOST. Jako vstupní parametr služby se předává prostý text, kódovaný pro URI.&#xA;    &#xA;   "/>
                     <port name="anonymous"/>
                  </call>
                  <call step="p:identity"
                        name="final"/>
                  <call step="p:if">
                     <parameter name="test"
                                value="$debug"/>
                     <parameter name="p:store"
                                value=""/>
                  </call>
               </body>
            </step>
            <step type="lant:convert-nametag-analysis-to-xml">
               <prolog>
                  <documentation length="196">
                     <xhtml:section xml:lang="en"
                                    xmlns:lant="https://www.mzk.cz/ns/libri-augmentati/nametag/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Convert NameTag analysis to XML</xhtml:h2>
                        <xhtml:p>Converts the analysis output in JSON format to an XML document.</xhtml:p>
                     </xhtml:section>
                     <xhtml:section xml:lang="cs"
                                    xmlns:lant="https://www.mzk.cz/ns/libri-augmentati/nametag/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Konverze analýzy NameTagem do XML</xhtml:h2>
                        <xhtml:p>Převede výstup analýzy ve formátu JSON na dokument ve formátu XML.</xhtml:p>
                     </xhtml:section>
                  </documentation>
                  <namespaces>
                     <namespace prefix="lad"
                                value="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"/>
                     <namespace prefix="lant"
                                value="https://www.mzk.cz/ns/libri-augmentati/nametag/1.0"/>
                     <namespace prefix="las"
                                value="https://www.mzk.cz/ns/libri-augmentati/settings/1.0"/>
                     <namespace prefix="map"
                                value="http://www.w3.org/2005/xpath-functions/map"/>
                     <namespace prefix="p"
                                value="http://www.w3.org/ns/xproc"/>
                     <namespace prefix="xhtml"
                                value="http://www.w3.org/1999/xhtml"/>
                     <namespace prefix="xs"
                                value="http://www.w3.org/2001/XMLSchema"/>
                     <namespace prefix="xml"
                                value="http://www.w3.org/XML/1998/namespace"/>
                  </namespaces>
                  <ports>
                     <input port="source"
                            primary="true"
                            content-types="application/json"/>
                     <output port="result"
                             primary="true"
                             content-types="application/xml"/>
                  </ports>
               </prolog>
               <body>
                  <documentation length="196">
                     <xhtml:section xml:lang="en"
                                    xmlns:lant="https://www.mzk.cz/ns/libri-augmentati/nametag/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Convert NameTag analysis to XML</xhtml:h2>
                        <xhtml:p>Converts the analysis output in JSON format to an XML document.</xhtml:p>
                     </xhtml:section>
                     <xhtml:section xml:lang="cs"
                                    xmlns:lant="https://www.mzk.cz/ns/libri-augmentati/nametag/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Konverze analýzy NameTagem do XML</xhtml:h2>
                        <xhtml:p>Převede výstup analýzy ve formátu JSON na dokument ve formátu XML.</xhtml:p>
                     </xhtml:section>
                  </documentation>
                  <call step="p:variable"
                        name="model">
                     <parameter name="select"
                                value="normalize-space(.?model)"/>
                  </call>
                  <call step="p:cast-content-type">
                     <parameter name="content-type"
                                value="application/xml"/>
                     <port name="source">
                        <parameter name="select"
                                   value=".?result"/>
                     </port>
                  </call>
                  <call step="p:xslt">
                     <parameter name="version"
                                value="3.0"/>
                     <port name="stylesheet">
                        <parameter name="href"
                                   value="../xslt/nametag/nametag-json-to-xml-text.xsl"/>
                     </port>
                  </call>
                  <call step="p:cast-content-type">
                     <parameter name="content-type"
                                value="application/xml"/>
                  </call>
                  <call step="p:choose"
                        length="1"/>
               </body>
            </step>
            <step type="lant:get-nametag-analyses"
                  name="getting-nametag-analyses">
               <prolog>
                  <documentation length="375">
                     <xhtml:section xml:lang="en"
                                    xmlns:lant="https://www.mzk.cz/ns/libri-augmentati/nametag/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Get NameTag analyses</xhtml:h2>
                        <xhtml:p>For each page of the virtual document, it gets its text, sends it to the REST interface of the <xhtml:a href="https://ufal.mff.cuni.cz/nametag/2"
                                    alt="NameTag">NameTag</xhtml:a> service, converts the result to XML format and stores it in a folder.</xhtml:p>
                     </xhtml:section>
                     <xhtml:section xml:lang="cs"
                                    xmlns:lant="https://www.mzk.cz/ns/libri-augmentati/nametag/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Analýzy textu NameTagem</xhtml:h2>
                        <xhtml:p>Pro každou stránku virtuálního dokumentu získá její text, odešle ho na RESTové rozhraní služby <xhtml:a href="https://ufal.mff.cuni.cz/nametag/2"
                                    alt="NameTag">NameTag</xhtml:a>, výsledek konvertuje do formátu XML a uloží do složky.</xhtml:p>
                     </xhtml:section>
                  </documentation>
                  <namespaces>
                     <namespace prefix="lad"
                                value="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"/>
                     <namespace prefix="lant"
                                value="https://www.mzk.cz/ns/libri-augmentati/nametag/1.0"/>
                     <namespace prefix="las"
                                value="https://www.mzk.cz/ns/libri-augmentati/settings/1.0"/>
                     <namespace prefix="map"
                                value="http://www.w3.org/2005/xpath-functions/map"/>
                     <namespace prefix="p"
                                value="http://www.w3.org/ns/xproc"/>
                     <namespace prefix="xhtml"
                                value="http://www.w3.org/1999/xhtml"/>
                     <namespace prefix="xs"
                                value="http://www.w3.org/2001/XMLSchema"/>
                     <namespace prefix="xml"
                                value="http://www.w3.org/XML/1998/namespace"/>
                  </namespaces>
                  <options>
                     <option name="debug-path"
                             select="()"
                             as="xs:string?"/>
                     <option name="base-uri"
                             as="xs:anyURI"
                             select="static-base-uri()"/>
                     <option name="output-directory"
                             required="true"
                             as="xs:string"/>
                  </options>
                  <ports>
                     <input port="source"
                            primary="true"/>
                     <input port="settings"
                            primary="false"/>
                     <input port="report-in"
                            primary="false"/>
                     <output port="result"
                             primary="true"
                             pipe="@final"/>
                     <output port="report"
                             pipe="result@final-report"/>
                  </ports>
               </prolog>
               <body>
                  <documentation length="375">
                     <xhtml:section xml:lang="en"
                                    xmlns:lant="https://www.mzk.cz/ns/libri-augmentati/nametag/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Get NameTag analyses</xhtml:h2>
                        <xhtml:p>For each page of the virtual document, it gets its text, sends it to the REST interface of the <xhtml:a href="https://ufal.mff.cuni.cz/nametag/2"
                                    alt="NameTag">NameTag</xhtml:a> service, converts the result to XML format and stores it in a folder.</xhtml:p>
                     </xhtml:section>
                     <xhtml:section xml:lang="cs"
                                    xmlns:lant="https://www.mzk.cz/ns/libri-augmentati/nametag/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Analýzy textu NameTagem</xhtml:h2>
                        <xhtml:p>Pro každou stránku virtuálního dokumentu získá její text, odešle ho na RESTové rozhraní služby <xhtml:a href="https://ufal.mff.cuni.cz/nametag/2"
                                    alt="NameTag">NameTag</xhtml:a>, výsledek konvertuje do formátu XML a uloží do složky.</xhtml:p>
                     </xhtml:section>
                  </documentation>
                  <call step="p:variable"
                        name="debug">
                     <parameter name="select"
                                value="$debug-path || '' ne ''"/>
                  </call>
                  <call step="p:variable"
                        name="debug-path-uri">
                     <parameter name="select"
                                value="resolve-uri($debug-path, $base-uri)"/>
                  </call>
                  <call step="p:variable"
                        name="result-directory-path">
                     <parameter name="select"
                                value="concat($output-directory, '/nametag')"/>
                     <parameter name="p:documentation"
                                value="&#xA;    &#xA;     The folder where downloaded documents are saved. The path to the folder can be absolute or relative.&#xA;    &#xA;    &#xA;     Složka, do níž se uloží stažené dokumenty. Cesta ke složce může být absolutní i relativní.&#xA;    &#xA;   "/>
                  </call>
                  <call step="p:variable"
                        name="result-directory-uri">
                     <parameter name="select"
                                value="resolve-uri($result-directory-path, $base-uri)"/>
                  </call>
                  <call step="p:variable"
                        name="language">
                     <parameter name="select"
                                value="/lad:document/@language"/>
                  </call>
                  <call step="p:if">
                     <parameter name="test"
                                value="$debug"/>
                     <parameter name="p:store"
                                value="&#xA;    &#xA;   "/>
                  </call>
                  <call step="p:viewport">
                     <parameter name="match"
                                value="lad:pages/lad:page/lad:resource[@type='udpipe'][@local-file-exists='true']"/>
                     <parameter name="use-when"
                                value="true()"/>
                     <parameter name="p:variable"
                                value=""/>
                     <parameter name="p:if"
                                value="&#xA;     &#xA;     &#xA;     &#xA;     &#xA;     &#xA;    &#xA;     &#xA;     &#xA;     &#xA;      &#xA;       &#xA;      &#xA;     &#xA;     &#xA;     &#xA;     &#xA;     &#xA;     &#xA;      &#xA;      &#xA;     &#xA;     &#xA;     &#xA;      &#xA;     &#xA;     &#xA;     &#xA;     &#xA;     &#xA;      &#xA;     &#xA;     &#xA;     &#xA;      &#xA;          &#xA;    &#xA;    &#xA;    &#xA;     &#xA;      &#xA;     &#xA;    &#xA;    &#xA;    &#xA;    &#xA;     &#xA;    &#xA;    &#xA;    "/>
                  </call>
                  <call step="p:identity"
                        name="final"/>
                  <call step="p:if">
                     <parameter name="test"
                                value="$debug"/>
                     <parameter name="p:store"
                                value=""/>
                  </call>
                  <call step="p:identity"
                        name="metadata"/>
                  <call step="p:insert"
                        name="final-report">
                     <parameter name="match"
                                value="lant:report/lant:result"/>
                     <parameter name="position"
                                value="last-child"/>
                     <port name="source">
                        <parameter name="pipe"
                                   value="source@getting-nametag-analyses"/>
                     </port>
                     <port name="insertion">
                        <parameter name="pipe"
                                   value="@metadata"/>
                     </port>
                  </call>
               </body>
            </step>
         </body>
      </library>
   </analysis>
   <analysis file-name="tei.xpl"
             path="file:///V:/Projekty/Github/MZK/libri-augmentati/src/xproc/tei.xpl"
             xmlns="https://www.daliboris.cz/ns/xproc/analysis"
             xmlns:xhtml="http://www.w3.org/1999/xhtml">
      <library semver="1.0.0">
         <prolog>
            <documentation length="161">
               <xhtml:meta name="version"
                           content="1.0.0"
                           xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                           xmlns:tei="http://www.tei-c.org/ns/1.0"
                           xmlns:lat="https://www.mzk.cz/ns/libri-augmentati/tei/1.0"/>
               <xhtml:section xml:lang="en"
                              xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                              xmlns:tei="http://www.tei-c.org/ns/1.0"
                              xmlns:lat="https://www.mzk.cz/ns/libri-augmentati/tei/1.0">
                  <xhtml:h1>Library for TEI data processing</xhtml:h1>
                  <xhtml:p>Steps for standalone operations with TEI data.</xhtml:p>
               </xhtml:section>
               <xhtml:section xml:lang="cs"
                              xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                              xmlns:tei="http://www.tei-c.org/ns/1.0"
                              xmlns:lat="https://www.mzk.cz/ns/libri-augmentati/tei/1.0">
                  <xhtml:h1>Kihovna pro zpracování dat TEI</xhtml:h1>
                  <xhtml:p>Kroky pro samostatné operace s daty ve formátu TEI.</xhtml:p>
               </xhtml:section>
            </documentation>
            <namespaces>
               <namespace prefix="lad"
                          value="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"/>
               <namespace prefix="lat"
                          value="https://www.mzk.cz/ns/libri-augmentati/tei/1.0"/>
               <namespace prefix="p"
                          value="http://www.w3.org/ns/xproc"/>
               <namespace prefix="tei"
                          value="http://www.tei-c.org/ns/1.0"/>
               <namespace prefix="xhtml"
                          value="http://www.w3.org/1999/xhtml"/>
               <namespace prefix="xs"
                          value="http://www.w3.org/2001/XMLSchema"/>
               <namespace prefix="xml"
                          value="http://www.w3.org/XML/1998/namespace"/>
            </namespaces>
         </prolog>
         <body>
            <documentation length="161">
               <xhtml:meta name="version"
                           content="1.0.0"
                           xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                           xmlns:tei="http://www.tei-c.org/ns/1.0"
                           xmlns:lat="https://www.mzk.cz/ns/libri-augmentati/tei/1.0"/>
               <xhtml:section xml:lang="en"
                              xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                              xmlns:tei="http://www.tei-c.org/ns/1.0"
                              xmlns:lat="https://www.mzk.cz/ns/libri-augmentati/tei/1.0">
                  <xhtml:h1>Library for TEI data processing</xhtml:h1>
                  <xhtml:p>Steps for standalone operations with TEI data.</xhtml:p>
               </xhtml:section>
               <xhtml:section xml:lang="cs"
                              xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                              xmlns:tei="http://www.tei-c.org/ns/1.0"
                              xmlns:lat="https://www.mzk.cz/ns/libri-augmentati/tei/1.0">
                  <xhtml:h1>Kihovna pro zpracování dat TEI</xhtml:h1>
                  <xhtml:p>Kroky pro samostatné operace s daty ve formátu TEI.</xhtml:p>
               </xhtml:section>
            </documentation>
            <step type="lat:convert-alto-to-tei"
                  name="converting-alto-to-tei">
               <prolog>
                  <documentation length="148">
                     <xhtml:section xml:lang="en"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:tei="http://www.tei-c.org/ns/1.0"
                                    xmlns:lat="https://www.mzk.cz/ns/libri-augmentati/tei/1.0">
                        <xhtml:h2>Convert ALTO to TEI</xhtml:h2>
                        <xhtml:p>Converts one document in ALTO format to TEI P5.</xhtml:p>
                     </xhtml:section>
                     <xhtml:section xml:lang="cs"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:tei="http://www.tei-c.org/ns/1.0"
                                    xmlns:lat="https://www.mzk.cz/ns/libri-augmentati/tei/1.0">
                        <xhtml:h2>Konverze ALTO na TEI</xhtml:h2>
                        <xhtml:p>Konvertuje jeden dokument ve formátu ALTO na formát TEI P5.</xhtml:p>
                     </xhtml:section>
                  </documentation>
                  <namespaces>
                     <namespace prefix="lad"
                                value="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"/>
                     <namespace prefix="lat"
                                value="https://www.mzk.cz/ns/libri-augmentati/tei/1.0"/>
                     <namespace prefix="p"
                                value="http://www.w3.org/ns/xproc"/>
                     <namespace prefix="tei"
                                value="http://www.tei-c.org/ns/1.0"/>
                     <namespace prefix="xhtml"
                                value="http://www.w3.org/1999/xhtml"/>
                     <namespace prefix="xs"
                                value="http://www.w3.org/2001/XMLSchema"/>
                     <namespace prefix="xml"
                                value="http://www.w3.org/XML/1998/namespace"/>
                  </namespaces>
                  <options>
                     <option name="debug-path"
                             select="()"
                             as="xs:string?"/>
                     <option name="base-uri"
                             as="xs:anyURI"
                             select="static-base-uri()"/>
                     <option name="page-number"
                             as="xs:string?"/>
                  </options>
                  <ports>
                     <input port="source"
                            primary="true"/>
                     <input port="report-in"
                            primary="false"/>
                     <output port="result"
                             primary="true"
                             pipe="@final"/>
                     <output port="report"
                             pipe="result@final-report"/>
                  </ports>
               </prolog>
               <body>
                  <documentation length="148">
                     <xhtml:section xml:lang="en"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:tei="http://www.tei-c.org/ns/1.0"
                                    xmlns:lat="https://www.mzk.cz/ns/libri-augmentati/tei/1.0">
                        <xhtml:h2>Convert ALTO to TEI</xhtml:h2>
                        <xhtml:p>Converts one document in ALTO format to TEI P5.</xhtml:p>
                     </xhtml:section>
                     <xhtml:section xml:lang="cs"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:tei="http://www.tei-c.org/ns/1.0"
                                    xmlns:lat="https://www.mzk.cz/ns/libri-augmentati/tei/1.0">
                        <xhtml:h2>Konverze ALTO na TEI</xhtml:h2>
                        <xhtml:p>Konvertuje jeden dokument ve formátu ALTO na formát TEI P5.</xhtml:p>
                     </xhtml:section>
                  </documentation>
                  <call step="p:variable"
                        name="debug">
                     <parameter name="select"
                                value="$debug-path || '' ne ''"/>
                  </call>
                  <call step="p:variable"
                        name="debug-path-uri">
                     <parameter name="select"
                                value="resolve-uri($debug-path, $base-uri)"/>
                  </call>
                  <call step="p:xslt">
                     <port name="stylesheet">
                        <parameter name="href"
                                   value="../xslt/conversion/alto2tei.xsl"/>
                     </port>
                     <parameter name="parameters"
                                value="map {'page-number' : $page-number }"/>
                  </call>
                  <call step="p:identity"
                        name="final"/>
                  <call step="p:identity"
                        name="final-report">
                     <port name="source">
                        <parameter name="pipe"
                                   value="report-in@converting-alto-to-tei"/>
                     </port>
                  </call>
               </body>
            </step>
            <step type="lat:convert-nametag-to-tei"
                  name="converting-nametag-to-tei">
               <prolog>
                  <documentation length="176">
                     <xhtml:section xml:lang="en"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:tei="http://www.tei-c.org/ns/1.0"
                                    xmlns:lat="https://www.mzk.cz/ns/libri-augmentati/tei/1.0">
                        <xhtml:h2>Convert NameTag XML to TEI</xhtml:h2>
                        <xhtml:p>Converts one document in NameTag XML format to TEI P5.</xhtml:p>
                     </xhtml:section>
                     <xhtml:section xml:lang="cs"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:tei="http://www.tei-c.org/ns/1.0"
                                    xmlns:lat="https://www.mzk.cz/ns/libri-augmentati/tei/1.0">
                        <xhtml:h2>Konverze NameTag XML na TEI</xhtml:h2>
                        <xhtml:p>Konvertuje jeden dokument ve formátu NameTag XML na formát TEI P5.</xhtml:p>
                     </xhtml:section>
                  </documentation>
                  <namespaces>
                     <namespace prefix="lad"
                                value="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"/>
                     <namespace prefix="lat"
                                value="https://www.mzk.cz/ns/libri-augmentati/tei/1.0"/>
                     <namespace prefix="p"
                                value="http://www.w3.org/ns/xproc"/>
                     <namespace prefix="tei"
                                value="http://www.tei-c.org/ns/1.0"/>
                     <namespace prefix="xhtml"
                                value="http://www.w3.org/1999/xhtml"/>
                     <namespace prefix="xs"
                                value="http://www.w3.org/2001/XMLSchema"/>
                     <namespace prefix="xml"
                                value="http://www.w3.org/XML/1998/namespace"/>
                  </namespaces>
                  <options>
                     <option name="debug-path"
                             select="()"
                             as="xs:string?"/>
                     <option name="base-uri"
                             as="xs:anyURI"
                             select="static-base-uri()"/>
                     <option name="page-number"
                             as="xs:string?"/>
                  </options>
                  <ports>
                     <input port="source"
                            primary="true"/>
                     <input port="report-in"
                            primary="false"/>
                     <output port="result"
                             primary="true"
                             pipe="@final"/>
                     <output port="report"
                             pipe="result@final-report"/>
                  </ports>
               </prolog>
               <body>
                  <documentation length="176">
                     <xhtml:section xml:lang="en"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:tei="http://www.tei-c.org/ns/1.0"
                                    xmlns:lat="https://www.mzk.cz/ns/libri-augmentati/tei/1.0">
                        <xhtml:h2>Convert NameTag XML to TEI</xhtml:h2>
                        <xhtml:p>Converts one document in NameTag XML format to TEI P5.</xhtml:p>
                     </xhtml:section>
                     <xhtml:section xml:lang="cs"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:tei="http://www.tei-c.org/ns/1.0"
                                    xmlns:lat="https://www.mzk.cz/ns/libri-augmentati/tei/1.0">
                        <xhtml:h2>Konverze NameTag XML na TEI</xhtml:h2>
                        <xhtml:p>Konvertuje jeden dokument ve formátu NameTag XML na formát TEI P5.</xhtml:p>
                     </xhtml:section>
                  </documentation>
                  <call step="p:variable"
                        name="debug">
                     <parameter name="select"
                                value="$debug-path || '' ne ''"/>
                  </call>
                  <call step="p:variable"
                        name="debug-path-uri">
                     <parameter name="select"
                                value="resolve-uri($debug-path, $base-uri)"/>
                  </call>
                  <call step="p:xslt">
                     <port name="stylesheet">
                        <parameter name="href"
                                   value="../xslt/nametag/nametag-xml-to-tei.xsl"/>
                     </port>
                     <parameter name="parameters"
                                value="map {'page-number' : $page-number }"/>
                  </call>
                  <call step="p:identity"
                        name="final"/>
                  <call step="p:identity"
                        name="final-report">
                     <port name="source">
                        <parameter name="pipe"
                                   value="report-in@converting-nametag-to-tei"/>
                     </port>
                  </call>
               </body>
            </step>
            <step type="lat:convert-udpipe-to-tei"
                  name="converting-udpipe-to-tei">
               <prolog>
                  <documentation length="204">
                     <xhtml:section xml:lang="en"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:tei="http://www.tei-c.org/ns/1.0"
                                    xmlns:lat="https://www.mzk.cz/ns/libri-augmentati/tei/1.0">
                        <xhtml:h2>:Convert UDPipe to TEI</xhtml:h2>
                        <xhtml:p>Converts one page in <xhtml:a href="https://universaldependencies.org/docs/format.html"
                                    title="CoNLLLu">CoNLLLu</xhtml:a> format, generated by <xhtml:a href="https://ufal.mff.cuni.cz/udpipe/1/users-manual"
                                    title="UDPipe">UDPipe</xhtml:a> to <xhtml:a href="https://tei-c.org/release/doc/tei-p5-doc/en/html/index.html"
                                    title="TEI">TEI P5</xhtml:a>.</xhtml:p>
                     </xhtml:section>
                     <xhtml:section xml:lang="cs"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:tei="http://www.tei-c.org/ns/1.0"
                                    xmlns:lat="https://www.mzk.cz/ns/libri-augmentati/tei/1.0">
                        <xhtml:h2>:Konverze UDPipe na TEI</xhtml:h2>
                        <xhtml:p>Převede jednu stranu s daty ve formátu <xhtml:a href="https://universaldependencies.org/docs/format.html"
                                    title="CoNLLLu">CoNLLLu</xhtml:a>, který generuje <xhtml:a href="https://ufal.mff.cuni.cz/udpipe/1/users-manual"
                                    title="UDPipe">UDPipe</xhtml:a>, do formátu <xhtml:a href="https://tei-c.org/release/doc/tei-p5-doc/en/html/index.html"
                                    title="TEI">TEI P5</xhtml:a>.</xhtml:p>
                     </xhtml:section>
                  </documentation>
                  <namespaces>
                     <namespace prefix="lad"
                                value="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"/>
                     <namespace prefix="lat"
                                value="https://www.mzk.cz/ns/libri-augmentati/tei/1.0"/>
                     <namespace prefix="p"
                                value="http://www.w3.org/ns/xproc"/>
                     <namespace prefix="tei"
                                value="http://www.tei-c.org/ns/1.0"/>
                     <namespace prefix="xhtml"
                                value="http://www.w3.org/1999/xhtml"/>
                     <namespace prefix="xs"
                                value="http://www.w3.org/2001/XMLSchema"/>
                     <namespace prefix="xml"
                                value="http://www.w3.org/XML/1998/namespace"/>
                  </namespaces>
                  <options>
                     <option name="debug-path"
                             select="()"
                             as="xs:string?"/>
                     <option name="base-uri"
                             as="xs:anyURI"
                             select="static-base-uri()"/>
                     <option name="page-number"
                             as="xs:string?"/>
                  </options>
                  <ports>
                     <input port="source"
                            primary="true"/>
                     <input port="report-in"
                            primary="false"/>
                     <output port="result"
                             primary="true"
                             pipe="@final"/>
                     <output port="report"
                             pipe="result@final-report"/>
                  </ports>
               </prolog>
               <body>
                  <documentation length="204">
                     <xhtml:section xml:lang="en"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:tei="http://www.tei-c.org/ns/1.0"
                                    xmlns:lat="https://www.mzk.cz/ns/libri-augmentati/tei/1.0">
                        <xhtml:h2>:Convert UDPipe to TEI</xhtml:h2>
                        <xhtml:p>Converts one page in <xhtml:a href="https://universaldependencies.org/docs/format.html"
                                    title="CoNLLLu">CoNLLLu</xhtml:a> format, generated by <xhtml:a href="https://ufal.mff.cuni.cz/udpipe/1/users-manual"
                                    title="UDPipe">UDPipe</xhtml:a> to <xhtml:a href="https://tei-c.org/release/doc/tei-p5-doc/en/html/index.html"
                                    title="TEI">TEI P5</xhtml:a>.</xhtml:p>
                     </xhtml:section>
                     <xhtml:section xml:lang="cs"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:tei="http://www.tei-c.org/ns/1.0"
                                    xmlns:lat="https://www.mzk.cz/ns/libri-augmentati/tei/1.0">
                        <xhtml:h2>:Konverze UDPipe na TEI</xhtml:h2>
                        <xhtml:p>Převede jednu stranu s daty ve formátu <xhtml:a href="https://universaldependencies.org/docs/format.html"
                                    title="CoNLLLu">CoNLLLu</xhtml:a>, který generuje <xhtml:a href="https://ufal.mff.cuni.cz/udpipe/1/users-manual"
                                    title="UDPipe">UDPipe</xhtml:a>, do formátu <xhtml:a href="https://tei-c.org/release/doc/tei-p5-doc/en/html/index.html"
                                    title="TEI">TEI P5</xhtml:a>.</xhtml:p>
                     </xhtml:section>
                  </documentation>
                  <call step="p:variable"
                        name="debug">
                     <parameter name="select"
                                value="$debug-path || '' ne ''"/>
                  </call>
                  <call step="p:variable"
                        name="debug-path-uri">
                     <parameter name="select"
                                value="resolve-uri($debug-path, $base-uri)"/>
                  </call>
                  <call step="p:variable"
                        name="udpipe-text">
                     <parameter name="select"
                                value="."/>
                  </call>
                  <call step="p:if">
                     <parameter name="test"
                                value="$debug"/>
                     <parameter name="p:store"
                                value=""/>
                  </call>
                  <call step="p:xslt">
                     <parameter name="parameters"
                                value="map{'input': $udpipe-text}"/>
                     <port name="stylesheet">
                        <parameter name="href"
                                   value="../xslt/conversion/conllu-to-xml.xsl"/>
                     </port>
                  </call>
                  <call step="p:if">
                     <parameter name="test"
                                value="$debug"/>
                     <parameter name="p:store"
                                value=""/>
                  </call>
                  <call step="p:xslt">
                     <port name="stylesheet">
                        <parameter name="href"
                                   value="../xslt/conversion/conllu-xml-to-hierarchy.xsl"/>
                     </port>
                  </call>
                  <call step="p:if">
                     <parameter name="test"
                                value="$debug"/>
                     <parameter name="p:store"
                                value=""/>
                  </call>
                  <call step="p:xslt">
                     <port name="stylesheet">
                        <parameter name="href"
                                   value="../xslt/conversion/conllu-xml-hierarchy-to-tei.xsl"/>
                     </port>
                     <parameter name="parameters"
                                value="map {'page-number' : $page-number }"/>
                  </call>
                  <call step="p:if">
                     <parameter name="test"
                                value="$debug"/>
                     <parameter name="p:store"
                                value=""/>
                  </call>
                  <call step="p:identity"
                        name="final"/>
                  <call step="p:identity"
                        name="final-report">
                     <port name="source">
                        <parameter name="pipe"
                                   value="report-in@converting-udpipe-to-tei"/>
                     </port>
                  </call>
               </body>
            </step>
            <step type="lat:merge-tei-representations"
                  name="merging-tei-representations">
               <prolog>
                  <documentation length="300">
                     <xhtml:section xml:lang="en"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:tei="http://www.tei-c.org/ns/1.0"
                                    xmlns:lat="https://www.mzk.cz/ns/libri-augmentati/tei/1.0">
                        <xhtml:h2>Merge TEI representations</xhtml:h2>
                        <xhtml:p>Merge different representation of one page in TEI, comming from different sources, like ALTO, NameTag, and UDPipe.</xhtml:p>
                     </xhtml:section>
                     <xhtml:section xml:lang="en"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:tei="http://www.tei-c.org/ns/1.0"
                                    xmlns:lat="https://www.mzk.cz/ns/libri-augmentati/tei/1.0">
                        <xhtml:h2>Kombinace reprezentace TEI</xhtml:h2>
                        <xhtml:p>Zkombinuje různé reprezentace stejné stránky ve formátu TEI, které pocházejí z různých zdrojů, jako např. ALTO, NameTag nebo UDPipe.</xhtml:p>
                     </xhtml:section>
                  </documentation>
                  <namespaces>
                     <namespace prefix="lad"
                                value="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"/>
                     <namespace prefix="lat"
                                value="https://www.mzk.cz/ns/libri-augmentati/tei/1.0"/>
                     <namespace prefix="p"
                                value="http://www.w3.org/ns/xproc"/>
                     <namespace prefix="tei"
                                value="http://www.tei-c.org/ns/1.0"/>
                     <namespace prefix="xhtml"
                                value="http://www.w3.org/1999/xhtml"/>
                     <namespace prefix="xs"
                                value="http://www.w3.org/2001/XMLSchema"/>
                     <namespace prefix="xml"
                                value="http://www.w3.org/XML/1998/namespace"/>
                  </namespaces>
                  <options>
                     <option name="debug-path"
                             select="()"
                             as="xs:string?"/>
                     <option name="base-uri"
                             as="xs:anyURI"
                             select="static-base-uri()"/>
                     <option name="file-stem"
                             as="xs:string?"/>
                  </options>
                  <ports>
                     <input port="source"
                            primary="true"/>
                     <input port="udpipe"
                            primary="false"/>
                     <input port="alto"
                            primary="false"/>
                     <input port="report-in"
                            primary="false"/>
                     <output port="result"
                             primary="true"
                             pipe="@final"/>
                     <output port="report"
                             pipe="result@final-report"/>
                  </ports>
               </prolog>
               <body>
                  <documentation length="300">
                     <xhtml:section xml:lang="en"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:tei="http://www.tei-c.org/ns/1.0"
                                    xmlns:lat="https://www.mzk.cz/ns/libri-augmentati/tei/1.0">
                        <xhtml:h2>Merge TEI representations</xhtml:h2>
                        <xhtml:p>Merge different representation of one page in TEI, comming from different sources, like ALTO, NameTag, and UDPipe.</xhtml:p>
                     </xhtml:section>
                     <xhtml:section xml:lang="en"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:tei="http://www.tei-c.org/ns/1.0"
                                    xmlns:lat="https://www.mzk.cz/ns/libri-augmentati/tei/1.0">
                        <xhtml:h2>Kombinace reprezentace TEI</xhtml:h2>
                        <xhtml:p>Zkombinuje různé reprezentace stejné stránky ve formátu TEI, které pocházejí z různých zdrojů, jako např. ALTO, NameTag nebo UDPipe.</xhtml:p>
                     </xhtml:section>
                  </documentation>
                  <call step="p:variable"
                        name="debug">
                     <parameter name="select"
                                value="$debug-path || '' ne ''"/>
                  </call>
                  <call step="p:variable"
                        name="debug-path-uri">
                     <parameter name="select"
                                value="resolve-uri($debug-path, $base-uri)"/>
                  </call>
                  <call step="p:variable"
                        name="udpipe-root">
                     <parameter name="select"
                                value="/*"/>
                     <parameter name="pipe"
                                value="udpipe@merging-tei-representations"/>
                  </call>
                  <call step="p:xslt">
                     <parameter name="parameters"
                                value="map{'udpipe': $udpipe-root}"/>
                     <port name="stylesheet">
                        <parameter name="href"
                                   value="../xslt/tei/merge-nametag-with-udpipe.xsl"/>
                     </port>
                  </call>
                  <call step="p:if">
                     <parameter name="test"
                                value="$debug"/>
                     <parameter name="p:store"
                                value=""/>
                  </call>
                  <call step="p:identity"
                        name="final"/>
                  <call step="p:identity"
                        name="final-report">
                     <port name="source">
                        <parameter name="pipe"
                                   value="report-in@merging-tei-representations"/>
                     </port>
                  </call>
               </body>
            </step>
            <step type="lat:convert-to-tei"
                  name="converting-to-tei">
               <prolog>
                  <documentation length="233">
                     <xhtml:section xml:lang="en"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:tei="http://www.tei-c.org/ns/1.0"
                                    xmlns:lat="https://www.mzk.cz/ns/libri-augmentati/tei/1.0">
                        <xhtml:h2>Convert to TEI</xhtml:h2>
                        <xhtml:p>Converts a virtual document to TEI P5 format, both at the page level and the whole document level.</xhtml:p>
                     </xhtml:section>
                     <xhtml:section xml:lang="cs"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:tei="http://www.tei-c.org/ns/1.0"
                                    xmlns:lat="https://www.mzk.cz/ns/libri-augmentati/tei/1.0">
                        <xhtml:h2>Konverze do TEI</xhtml:h2>
                        <xhtml:p>Konvertuje virtuální dokument do formátu TEI P5, a to na úrovni jednotlivýh stránek i celého dokumentu.</xhtml:p>
                     </xhtml:section>
                  </documentation>
                  <namespaces>
                     <namespace prefix="lad"
                                value="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"/>
                     <namespace prefix="lat"
                                value="https://www.mzk.cz/ns/libri-augmentati/tei/1.0"/>
                     <namespace prefix="p"
                                value="http://www.w3.org/ns/xproc"/>
                     <namespace prefix="tei"
                                value="http://www.tei-c.org/ns/1.0"/>
                     <namespace prefix="xhtml"
                                value="http://www.w3.org/1999/xhtml"/>
                     <namespace prefix="xs"
                                value="http://www.w3.org/2001/XMLSchema"/>
                     <namespace prefix="xml"
                                value="http://www.w3.org/XML/1998/namespace"/>
                  </namespaces>
                  <options>
                     <option name="debug-path"
                             select="()"
                             as="xs:string?"/>
                     <option name="base-uri"
                             as="xs:anyURI"
                             select="static-base-uri()"/>
                     <option name="output-directory"
                             required="true"
                             as="xs:string"/>
                  </options>
                  <ports>
                     <input port="source"
                            primary="true"/>
                     <input port="report-in"
                            primary="false"/>
                     <output port="result"
                             primary="true"
                             pipe="@final"/>
                     <output port="report"
                             pipe="result@final-report"/>
                  </ports>
               </prolog>
               <body>
                  <documentation length="233">
                     <xhtml:section xml:lang="en"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:tei="http://www.tei-c.org/ns/1.0"
                                    xmlns:lat="https://www.mzk.cz/ns/libri-augmentati/tei/1.0">
                        <xhtml:h2>Convert to TEI</xhtml:h2>
                        <xhtml:p>Converts a virtual document to TEI P5 format, both at the page level and the whole document level.</xhtml:p>
                     </xhtml:section>
                     <xhtml:section xml:lang="cs"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:tei="http://www.tei-c.org/ns/1.0"
                                    xmlns:lat="https://www.mzk.cz/ns/libri-augmentati/tei/1.0">
                        <xhtml:h2>Konverze do TEI</xhtml:h2>
                        <xhtml:p>Konvertuje virtuální dokument do formátu TEI P5, a to na úrovni jednotlivýh stránek i celého dokumentu.</xhtml:p>
                     </xhtml:section>
                  </documentation>
                  <call step="p:variable"
                        name="debug">
                     <parameter name="select"
                                value="$debug-path || '' ne ''"/>
                  </call>
                  <call step="p:variable"
                        name="debug-path-uri">
                     <parameter name="select"
                                value="resolve-uri($debug-path, $base-uri)"/>
                  </call>
                  <call step="p:variable"
                        name="result-directory-path">
                     <parameter name="select"
                                value="concat($output-directory, '/tei')"/>
                     <parameter name="p:documentation"
                                value="&#xA;    &#xA;     The folder where generated documents are saved. The path to the folder can be absolute or relative.&#xA;    &#xA;    &#xA;     Složka, do níž se uloží vygenerované dokumenty. Cesta ke složce může být absolutní i relativní.&#xA;    &#xA;   "/>
                  </call>
                  <call step="p:variable"
                        name="result-directory-uri">
                     <parameter name="select"
                                value="resolve-uri($result-directory-path, $base-uri)"/>
                  </call>
                  <call step="p:viewport">
                     <parameter name="match"
                                value="lad:pages/lad:page"/>
                     <parameter name="use-when"
                                value="true()"/>
                     <parameter name="p:variable"
                                value=""/>
                     <parameter name="p:variable"
                                value=""/>
                     <parameter name="p:variable"
                                value=""/>
                     <parameter name="p:variable"
                                value=""/>
                     <parameter name="p:if"
                                value="&#xA;    &#xA;    &#xA;    &#xA;    &#xA;    &#xA;    &#xA;    &#xA;     &#xA;     &#xA;      &#xA;      &#xA;     &#xA;     &#xA;      &#xA;     &#xA;     &#xA;     &#xA;      &#xA;      &#xA;     &#xA;     &#xA;      &#xA;     &#xA;     &#xA;     &#xA;      &#xA;      &#xA;     &#xA;     &#xA;      &#xA;     &#xA;     &#xA;     &#xA;      &#xA;      &#xA;      &#xA;      &#xA;     &#xA;     &#xA;     &#xA;      &#xA;     &#xA;     &#xA;     &#xA;      &#xA;     &#xA;     &#xA;      &#xA;          &#xA;    &#xA;    &#xA;    &#xA;     &#xA;      &#xA;     &#xA;    &#xA;    &#xA;    &#xA;    &#xA;     &#xA;    &#xA;    &#xA;    &#xA;   "/>
                  </call>
                  <call step="p:identity"
                        name="mid-final"/>
                  <call step="p:identity"
                        name="mid-report">
                     <port name="source">
                        <parameter name="pipe"
                                   value="report-in@converting-to-tei"/>
                     </port>
                  </call>
                  <call step="lat:combine-tei-pages"
                        name="combining-tei-pages">
                     <parameter name="output-directory"
                                value="{$output-directory}"/>
                     <parameter name="debug-path"
                                value="{$debug-path}"/>
                     <parameter name="base-uri"
                                value="{$base-uri}"/>
                     <port name="source">
                        <parameter name="pipe"
                                   value="@mid-final"/>
                     </port>
                     <port name="report-in">
                        <parameter name="pipe"
                                   value="@mid-report"/>
                     </port>
                  </call>
                  <call step="p:identity"
                        name="final"/>
                  <call step="p:identity"
                        name="final-report">
                     <port name="source">
                        <parameter name="pipe"
                                   value="report@combining-tei-pages"/>
                     </port>
                  </call>
               </body>
            </step>
            <step type="lat:combine-tei-pages"
                  name="combining-tei-pages">
               <prolog>
                  <documentation length="138">
                     <xhtml:section xml:lang="en"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:tei="http://www.tei-c.org/ns/1.0"
                                    xmlns:lat="https://www.mzk.cz/ns/libri-augmentati/tei/1.0">
                        <xhtml:h2>Combine TEI pages</xhtml:h2>
                        <xhtml:p>Combines available TEI pages to one document.</xhtml:p>
                     </xhtml:section>
                     <xhtml:section xml:lang="cs"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:tei="http://www.tei-c.org/ns/1.0"
                                    xmlns:lat="https://www.mzk.cz/ns/libri-augmentati/tei/1.0">
                        <xhtml:h2>Sloučení stránek TEI</xhtml:h2>
                        <xhtml:p>Sloučí dostupné TEI stránky do jednoho TEI dokumentu.</xhtml:p>
                     </xhtml:section>
                  </documentation>
                  <namespaces>
                     <namespace prefix="lad"
                                value="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"/>
                     <namespace prefix="lat"
                                value="https://www.mzk.cz/ns/libri-augmentati/tei/1.0"/>
                     <namespace prefix="p"
                                value="http://www.w3.org/ns/xproc"/>
                     <namespace prefix="tei"
                                value="http://www.tei-c.org/ns/1.0"/>
                     <namespace prefix="xhtml"
                                value="http://www.w3.org/1999/xhtml"/>
                     <namespace prefix="xs"
                                value="http://www.w3.org/2001/XMLSchema"/>
                     <namespace prefix="xml"
                                value="http://www.w3.org/XML/1998/namespace"/>
                  </namespaces>
                  <options>
                     <option name="debug-path"
                             select="()"
                             as="xs:string?"/>
                     <option name="base-uri"
                             as="xs:anyURI"
                             select="static-base-uri()"/>
                     <option name="output-directory"
                             required="true"
                             as="xs:string"/>
                  </options>
                  <ports>
                     <input port="source"
                            primary="true"/>
                     <input port="report-in"
                            primary="false"/>
                     <output port="result"
                             primary="true"
                             pipe="@final"/>
                     <output port="report"
                             pipe="result@final-report"/>
                  </ports>
               </prolog>
               <body>
                  <documentation length="138">
                     <xhtml:section xml:lang="en"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:tei="http://www.tei-c.org/ns/1.0"
                                    xmlns:lat="https://www.mzk.cz/ns/libri-augmentati/tei/1.0">
                        <xhtml:h2>Combine TEI pages</xhtml:h2>
                        <xhtml:p>Combines available TEI pages to one document.</xhtml:p>
                     </xhtml:section>
                     <xhtml:section xml:lang="cs"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:tei="http://www.tei-c.org/ns/1.0"
                                    xmlns:lat="https://www.mzk.cz/ns/libri-augmentati/tei/1.0">
                        <xhtml:h2>Sloučení stránek TEI</xhtml:h2>
                        <xhtml:p>Sloučí dostupné TEI stránky do jednoho TEI dokumentu.</xhtml:p>
                     </xhtml:section>
                  </documentation>
                  <call step="p:variable"
                        name="debug">
                     <parameter name="select"
                                value="$debug-path || '' ne ''"/>
                  </call>
                  <call step="p:variable"
                        name="debug-path-uri">
                     <parameter name="select"
                                value="resolve-uri($debug-path, $base-uri)"/>
                  </call>
                  <call step="p:variable"
                        name="result-directory-path">
                     <parameter name="select"
                                value="$output-directory"/>
                     <parameter name="p:documentation"
                                value="&#xA;    &#xA;     The folder where generated documents are saved. The path to the folder can be absolute or relative.&#xA;    &#xA;    &#xA;     Složka, do níž se uloží vygenerované dokumenty. Cesta ke složce může být absolutní i relativní.&#xA;    &#xA;   "/>
                  </call>
                  <call step="p:variable"
                        name="result-directory-uri">
                     <parameter name="select"
                                value="resolve-uri($result-directory-path, $base-uri)"/>
                  </call>
                  <call step="p:variable"
                        name="foxml">
                     <parameter name="select"
                                value="/lad:document/lad:resource[@type='foxml'][@local-file-exists='true']"/>
                  </call>
                  <call step="p:variable"
                        name="teis">
                     <parameter name="select"
                                value="/lad:document/lad:pages/lad:page/lad:resource[@type='tei'][@local-file-exists='true']"/>
                  </call>
                  <call step="p:if">
                     <parameter name="test"
                                value="$debug"/>
                     <parameter name="p:store"
                                value=""/>
                  </call>
                  <call step="p:if">
                     <parameter name="test"
                                value="exists($foxml) and exists($teis)"/>
                     <parameter name="p:variable"
                                value=""/>
                     <parameter name="p:variable"
                                value=""/>
                     <parameter name="p:variable"
                                value=""/>
                     <parameter name="p:if"
                                value="&#xA;     &#xA;     &#xA;      &#xA;       &#xA;      &#xA;     &#xA;     &#xA;     &#xA;     &#xA;      &#xA;      &#xA;      &#xA;     &#xA;     &#xA;     &#xA;     &#xA;      &#xA;     &#xA;&#xA;     &#xA;      &#xA;       &#xA;       &#xA;       &#xA;        &#xA;       &#xA;      &#xA;      &#xA;     &#xA;     &#xA;     &#xA;      &#xA;          &#xA;    "/>
                     <parameter name="p:identity"
                                value="&#xA;     &#xA;      &#xA;     &#xA;    "/>
                     <parameter name="p:namespace-delete"
                                value=""/>
                     <parameter name="p:insert"
                                value="&#xA;     &#xA;     &#xA;    "/>
                  </call>
                  <call step="p:identity"
                        name="final"/>
                  <call step="p:identity"
                        name="final-report">
                     <port name="source">
                        <parameter name="pipe"
                                   value="report-in@combining-tei-pages"/>
                     </port>
                  </call>
               </body>
            </step>
         </body>
      </library>
   </analysis>
   <analysis file-name="text.xpl"
             path="file:///V:/Projekty/Github/MZK/libri-augmentati/src/xproc/text.xpl"
             xmlns="https://www.daliboris.cz/ns/xproc/analysis"
             xmlns:xhtml="http://www.w3.org/1999/xhtml">
      <library semver="1.0.0">
         <prolog>
            <documentation length="192">
               <xhtml:meta name="version"
                           content="1.0.0"
                           xmlns:latx="https://www.mzk.cz/ns/libri-augmentati/text/1.0"
                           xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"/>
               <xhtml:section xml:lang="en"
                              xmlns:latx="https://www.mzk.cz/ns/libri-augmentati/text/1.0"
                              xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0">
                  <xhtml:h1>Library for plain text data processing</xhtml:h1>
                  <xhtml:p>Steps for standalone operations with plain text data.</xhtml:p>
               </xhtml:section>
               <xhtml:section xml:lang="cs"
                              xmlns:latx="https://www.mzk.cz/ns/libri-augmentati/text/1.0"
                              xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0">
                  <xhtml:h1>Kihovna pro zpracování textových dat</xhtml:h1>
                  <xhtml:p>Kroky pro samostatné operace s daty ve formátu prostého textu.</xhtml:p>
               </xhtml:section>
            </documentation>
            <namespaces>
               <namespace prefix="c"
                          value="http://www.w3.org/ns/xproc-step"/>
               <namespace prefix="lad"
                          value="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"/>
               <namespace prefix="latx"
                          value="https://www.mzk.cz/ns/libri-augmentati/text/1.0"/>
               <namespace prefix="p"
                          value="http://www.w3.org/ns/xproc"/>
               <namespace prefix="xhtml"
                          value="http://www.w3.org/1999/xhtml"/>
               <namespace prefix="xs"
                          value="http://www.w3.org/2001/XMLSchema"/>
               <namespace prefix="xml"
                          value="http://www.w3.org/XML/1998/namespace"/>
            </namespaces>
         </prolog>
         <body>
            <documentation length="192">
               <xhtml:meta name="version"
                           content="1.0.0"
                           xmlns:latx="https://www.mzk.cz/ns/libri-augmentati/text/1.0"
                           xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"/>
               <xhtml:section xml:lang="en"
                              xmlns:latx="https://www.mzk.cz/ns/libri-augmentati/text/1.0"
                              xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0">
                  <xhtml:h1>Library for plain text data processing</xhtml:h1>
                  <xhtml:p>Steps for standalone operations with plain text data.</xhtml:p>
               </xhtml:section>
               <xhtml:section xml:lang="cs"
                              xmlns:latx="https://www.mzk.cz/ns/libri-augmentati/text/1.0"
                              xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0">
                  <xhtml:h1>Kihovna pro zpracování textových dat</xhtml:h1>
                  <xhtml:p>Kroky pro samostatné operace s daty ve formátu prostého textu.</xhtml:p>
               </xhtml:section>
            </documentation>
            <step type="latx:combine-text-pages"
                  name="combining-text-pages">
               <prolog>
                  <documentation length="138">
                     <xhtml:section xml:lang="en"
                                    xmlns:latx="https://www.mzk.cz/ns/libri-augmentati/text/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0">
                        <xhtml:h2>Combine TEI pages</xhtml:h2>
                        <xhtml:p>Combines available TEI pages to one document.</xhtml:p>
                     </xhtml:section>
                     <xhtml:section xml:lang="cs"
                                    xmlns:latx="https://www.mzk.cz/ns/libri-augmentati/text/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0">
                        <xhtml:h2>Sloučení stránek TEI</xhtml:h2>
                        <xhtml:p>Sloučí dostupné TEI stránky do jednoho TEI dokumentu.</xhtml:p>
                     </xhtml:section>
                  </documentation>
                  <namespaces>
                     <namespace prefix="c"
                                value="http://www.w3.org/ns/xproc-step"/>
                     <namespace prefix="lad"
                                value="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"/>
                     <namespace prefix="latx"
                                value="https://www.mzk.cz/ns/libri-augmentati/text/1.0"/>
                     <namespace prefix="p"
                                value="http://www.w3.org/ns/xproc"/>
                     <namespace prefix="xhtml"
                                value="http://www.w3.org/1999/xhtml"/>
                     <namespace prefix="xs"
                                value="http://www.w3.org/2001/XMLSchema"/>
                     <namespace prefix="xml"
                                value="http://www.w3.org/XML/1998/namespace"/>
                  </namespaces>
                  <options>
                     <option name="debug-path"
                             select="()"
                             as="xs:string?"/>
                     <option name="base-uri"
                             as="xs:anyURI"
                             select="static-base-uri()"/>
                     <option name="output-directory"
                             required="true"
                             as="xs:string"/>
                  </options>
                  <ports>
                     <input port="source"
                            primary="true"/>
                     <input port="report-in"
                            primary="false"/>
                     <output port="result"
                             primary="true"
                             pipe="@final"/>
                     <output port="report"
                             pipe="result@final-report"/>
                  </ports>
               </prolog>
               <body>
                  <documentation length="138">
                     <xhtml:section xml:lang="en"
                                    xmlns:latx="https://www.mzk.cz/ns/libri-augmentati/text/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0">
                        <xhtml:h2>Combine TEI pages</xhtml:h2>
                        <xhtml:p>Combines available TEI pages to one document.</xhtml:p>
                     </xhtml:section>
                     <xhtml:section xml:lang="cs"
                                    xmlns:latx="https://www.mzk.cz/ns/libri-augmentati/text/1.0"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0">
                        <xhtml:h2>Sloučení stránek TEI</xhtml:h2>
                        <xhtml:p>Sloučí dostupné TEI stránky do jednoho TEI dokumentu.</xhtml:p>
                     </xhtml:section>
                  </documentation>
                  <call step="p:variable"
                        name="debug">
                     <parameter name="select"
                                value="$debug-path || '' ne ''"/>
                  </call>
                  <call step="p:variable"
                        name="debug-path-uri">
                     <parameter name="select"
                                value="resolve-uri($debug-path, $base-uri)"/>
                  </call>
                  <call step="p:variable"
                        name="result-directory-path">
                     <parameter name="select"
                                value="$output-directory"/>
                     <parameter name="p:documentation"
                                value="&#xA;    &#xA;     The folder where generated documents are saved. The path to the folder can be absolute or relative.&#xA;    &#xA;    &#xA;     Složka, do níž se uloží vygenerované dokumenty. Cesta ke složce může být absolutní i relativní.&#xA;    &#xA;   "/>
                  </call>
                  <call step="p:variable"
                        name="result-directory-uri">
                     <parameter name="select"
                                value="resolve-uri($result-directory-path, $base-uri)"/>
                  </call>
                  <call step="p:variable"
                        name="resources">
                     <parameter name="select"
                                value="/lad:document/lad:pages/lad:page/lad:resource[@type='text'][@local-file-exists='true']"/>
                  </call>
                  <call step="p:if">
                     <parameter name="test"
                                value="$debug"/>
                     <parameter name="p:store"
                                value=""/>
                  </call>
                  <call step="p:if">
                     <parameter name="test"
                                value="exists($resources)"/>
                     <parameter name="p:variable"
                                value=""/>
                     <parameter name="p:variable"
                                value=""/>
                     <parameter name="p:variable"
                                value=""/>
                     <parameter name="p:file-info"
                                value=""/>
                     <parameter name="p:if"
                                value="&#xA;    &#xA;     &#xA;      &#xA;      &#xA;      &#xA;       &#xA;      &#xA;     &#xA;     &#xA;    &#xA;    &#xA;     &#xA;         &#xA;   "/>
                     <parameter name="p:identity"
                                value="&#xA;    &#xA;     &#xA;    &#xA;   "/>
                     <parameter name="p:namespace-delete"
                                value=""/>
                     <parameter name="p:insert"
                                value="&#xA;    &#xA;    &#xA;   "/>
                  </call>
                  <call step="p:identity"
                        name="final"/>
                  <call step="p:identity"
                        name="final-report">
                     <port name="source">
                        <parameter name="pipe"
                                   value="report-in@combining-text-pages"/>
                     </port>
                  </call>
               </body>
            </step>
         </body>
      </library>
   </analysis>
   <analysis file-name="udpipe.xpl"
             path="file:///V:/Projekty/Github/MZK/libri-augmentati/src/xproc/udpipe.xpl"
             xmlns="https://www.daliboris.cz/ns/xproc/analysis"
             xmlns:xhtml="http://www.w3.org/1999/xhtml">
      <library semver="1.0.0">
         <prolog>
            <documentation length="185">
               <xhtml:meta name="version"
                           content="1.0.0"
                           xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                           xmlns:laud="https://www.mzk.cz/ns/libri-augmentati/udpipe/1.0"
                           xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0"/>
               <xhtml:section xml:lang="en"
                              xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                              xmlns:laud="https://www.mzk.cz/ns/libri-augmentati/udpipe/1.0"
                              xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                  <xhtml:h1>Library for UDPipe data processing</xhtml:h1>
                  <xhtml:p>Steps for standalone operations with UDPipe service and data.</xhtml:p>
               </xhtml:section>
               <xhtml:section xml:lang="cs"
                              xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                              xmlns:laud="https://www.mzk.cz/ns/libri-augmentati/udpipe/1.0"
                              xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                  <xhtml:h1>Kihovna pro zpracování dat UDPipe</xhtml:h1>
                  <xhtml:p>Kroky pro samostatné operace se službou a daty UDPipe.</xhtml:p>
               </xhtml:section>
            </documentation>
            <namespaces>
               <namespace prefix="c"
                          value="http://www.w3.org/ns/xproc-step"/>
               <namespace prefix="lad"
                          value="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"/>
               <namespace prefix="las"
                          value="https://www.mzk.cz/ns/libri-augmentati/settings/1.0"/>
               <namespace prefix="laud"
                          value="https://www.mzk.cz/ns/libri-augmentati/udpipe/1.0"/>
               <namespace prefix="p"
                          value="http://www.w3.org/ns/xproc"/>
               <namespace prefix="xhtml"
                          value="http://www.w3.org/1999/xhtml"/>
               <namespace prefix="xs"
                          value="http://www.w3.org/2001/XMLSchema"/>
               <namespace prefix="xml"
                          value="http://www.w3.org/XML/1998/namespace"/>
            </namespaces>
         </prolog>
         <body>
            <documentation length="185">
               <xhtml:meta name="version"
                           content="1.0.0"
                           xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                           xmlns:laud="https://www.mzk.cz/ns/libri-augmentati/udpipe/1.0"
                           xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0"/>
               <xhtml:section xml:lang="en"
                              xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                              xmlns:laud="https://www.mzk.cz/ns/libri-augmentati/udpipe/1.0"
                              xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                  <xhtml:h1>Library for UDPipe data processing</xhtml:h1>
                  <xhtml:p>Steps for standalone operations with UDPipe service and data.</xhtml:p>
               </xhtml:section>
               <xhtml:section xml:lang="cs"
                              xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                              xmlns:laud="https://www.mzk.cz/ns/libri-augmentati/udpipe/1.0"
                              xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                  <xhtml:h1>Kihovna pro zpracování dat UDPipe</xhtml:h1>
                  <xhtml:p>Kroky pro samostatné operace se službou a daty UDPipe.</xhtml:p>
               </xhtml:section>
            </documentation>
            <step type="laud:get-udpipe-analysis"
                  name="getting-udpipe-analysis">
               <prolog>
                  <documentation length="262">
                     <xhtml:section xml:lang="en"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:laud="https://www.mzk.cz/ns/libri-augmentati/udpipe/1.0"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Get UDPipe analysis</xhtml:h2>
                        <xhtml:p>Calls the REST API of the UDPipe service, passes it the text to recognize, and returns the result in JSON format.</xhtml:p>
                     </xhtml:section>
                     <xhtml:section xml:lang="cs"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:laud="https://www.mzk.cz/ns/libri-augmentati/udpipe/1.0"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Analýza textu pomocí UDPipe</xhtml:h2>
                        <xhtml:p>Zavolá rozhraní REST API služby UDPipe, předá jí text k rozpoznání a vrátí výsledek ve formátu JSON.</xhtml:p>
                     </xhtml:section>
                  </documentation>
                  <namespaces>
                     <namespace prefix="c"
                                value="http://www.w3.org/ns/xproc-step"/>
                     <namespace prefix="lad"
                                value="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"/>
                     <namespace prefix="las"
                                value="https://www.mzk.cz/ns/libri-augmentati/settings/1.0"/>
                     <namespace prefix="laud"
                                value="https://www.mzk.cz/ns/libri-augmentati/udpipe/1.0"/>
                     <namespace prefix="p"
                                value="http://www.w3.org/ns/xproc"/>
                     <namespace prefix="xhtml"
                                value="http://www.w3.org/1999/xhtml"/>
                     <namespace prefix="xs"
                                value="http://www.w3.org/2001/XMLSchema"/>
                     <namespace prefix="xml"
                                value="http://www.w3.org/XML/1998/namespace"/>
                  </namespaces>
                  <options>
                     <option name="debug-path"
                             select="()"
                             as="xs:string?"/>
                     <option name="base-uri"
                             as="xs:anyURI"
                             select="static-base-uri()"/>
                     <option name="language"
                             as="xs:string?"
                             select="'cze'"/>
                  </options>
                  <ports>
                     <input port="source"
                            primary="true"/>
                     <input port="settings"
                            primary="false"/>
                     <input port="report-in"
                            primary="false"/>
                     <output port="result"
                             primary="true"/>
                     <output port="report"
                             pipe="report-in@getting-udpipe-analysis"/>
                  </ports>
               </prolog>
               <body>
                  <documentation length="262">
                     <xhtml:section xml:lang="en"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:laud="https://www.mzk.cz/ns/libri-augmentati/udpipe/1.0"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Get UDPipe analysis</xhtml:h2>
                        <xhtml:p>Calls the REST API of the UDPipe service, passes it the text to recognize, and returns the result in JSON format.</xhtml:p>
                     </xhtml:section>
                     <xhtml:section xml:lang="cs"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:laud="https://www.mzk.cz/ns/libri-augmentati/udpipe/1.0"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Analýza textu pomocí UDPipe</xhtml:h2>
                        <xhtml:p>Zavolá rozhraní REST API služby UDPipe, předá jí text k rozpoznání a vrátí výsledek ve formátu JSON.</xhtml:p>
                     </xhtml:section>
                  </documentation>
                  <call step="p:variable"
                        name="debug">
                     <parameter name="select"
                                value="$debug-path || '' ne ''"/>
                  </call>
                  <call step="p:variable"
                        name="debug-path-uri">
                     <parameter name="select"
                                value="resolve-uri($debug-path, $base-uri)"/>
                  </call>
                  <call step="p:variable"
                        name="service">
                     <parameter name="select"
                                value="//las:service[@code='udpipe']"/>
                     <parameter name="pipe"
                                value="settings@getting-udpipe-analysis"/>
                  </call>
                  <call step="p:variable"
                        name="service-url">
                     <parameter name="select"
                                value="$service/las:api/@url"/>
                     <parameter name="p:documentation"
                                value="&#xA;    &#xA;     URL of the REST service&#xA;    &#xA;    &#xA;     URL RESTové služby&#xA;    &#xA;   "/>
                  </call>
                  <call step="p:variable"
                        name="api-id">
                     <parameter name="select"
                                value="substring-after($service/las:api/@ref, '#')"/>
                     <parameter name="p:documentation"
                                value="&#xA;    &#xA;     Identifier of the REST service&#xA;    &#xA;    &#xA;     Identifikátor RESTové služby&#xA;    &#xA;   "/>
                  </call>
                  <call step="p:variable"
                        name="feature">
                     <parameter name="select"
                                value="//las:api[@xml:id=$api-id]/las:feature[@type='process'][@method='post']"/>
                     <parameter name="pipe"
                                value="settings@getting-udpipe-analysis"/>
                  </call>
                  <call step="p:variable"
                        name="step-url">
                     <parameter name="select"
                                value="concat($service-url, $feature/@url)"/>
                  </call>
                  <call step="p:variable"
                        name="step-params">
                     <parameter name="select"
                                value="string-join($feature/las:param[@place='body'][not(@name =('data','model'))]//concat(@name, '=', @value), '&amp;')"/>
                  </call>
                  <call step="p:variable"
                        name="step-params">
                     <parameter name="select"
                                value="$step-params || '&amp;model=' || $language"/>
                  </call>
                  <call step="p:variable"
                        name="full-text">
                     <parameter name="select"
                                value="."/>
                  </call>
                  <call step="p:http-request">
                     <parameter name="href"
                                value="{$step-url}"/>
                     <parameter name="method"
                                value="'POST'"/>
                     <parameter name="p:documentation"
                                value="&#xA;    &#xA;     Calling the UDPipe service API using the POST method. The input parameter to the service is plain text, encoded for the URI.&#xA;    &#xA;    &#xA;     Volání API služby UDPipe pomocí metodyPOST. Jako vstupní parametr služby se předává prostý text, kódovaný pro URI.&#xA;    &#xA;   "/>
                     <port name="anonymous"/>
                  </call>
                  <call step="p:identity"
                        name="final"/>
                  <call step="p:if">
                     <parameter name="test"
                                value="$debug"/>
                     <parameter name="p:store"
                                value=""/>
                  </call>
               </body>
            </step>
            <step type="laud:convert-udpipe-analysis-to-text">
               <prolog>
                  <documentation length="192">
                     <xhtml:section xml:lang="en"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:laud="https://www.mzk.cz/ns/libri-augmentati/udpipe/1.0"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Convert UDPipe analysis to XML</xhtml:h2>
                        <xhtml:p>Converts the analysis output in JSON format to an XML document.</xhtml:p>
                     </xhtml:section>
                     <xhtml:section xml:lang="cs"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:laud="https://www.mzk.cz/ns/libri-augmentati/udpipe/1.0"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Konverze analýzy UDPipe do XML</xhtml:h2>
                        <xhtml:p>Převede výstup analýzy ve formátu JSON na dokument ve formátu XML.</xhtml:p>
                     </xhtml:section>
                  </documentation>
                  <namespaces>
                     <namespace prefix="c"
                                value="http://www.w3.org/ns/xproc-step"/>
                     <namespace prefix="lad"
                                value="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"/>
                     <namespace prefix="las"
                                value="https://www.mzk.cz/ns/libri-augmentati/settings/1.0"/>
                     <namespace prefix="laud"
                                value="https://www.mzk.cz/ns/libri-augmentati/udpipe/1.0"/>
                     <namespace prefix="p"
                                value="http://www.w3.org/ns/xproc"/>
                     <namespace prefix="xhtml"
                                value="http://www.w3.org/1999/xhtml"/>
                     <namespace prefix="xs"
                                value="http://www.w3.org/2001/XMLSchema"/>
                     <namespace prefix="xml"
                                value="http://www.w3.org/XML/1998/namespace"/>
                  </namespaces>
                  <options>
                     <option name="debug-path"
                             select="()"
                             as="xs:string?"/>
                     <option name="base-uri"
                             as="xs:anyURI"
                             select="static-base-uri()"/>
                     <option name="file-stem"
                             as="xs:string?"/>
                  </options>
                  <ports>
                     <input port="source"
                            primary="true"
                            content-types="application/json"/>
                     <output port="result"
                             primary="true"
                             content-types="text/plain"/>
                  </ports>
               </prolog>
               <body>
                  <documentation length="192">
                     <xhtml:section xml:lang="en"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:laud="https://www.mzk.cz/ns/libri-augmentati/udpipe/1.0"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Convert UDPipe analysis to XML</xhtml:h2>
                        <xhtml:p>Converts the analysis output in JSON format to an XML document.</xhtml:p>
                     </xhtml:section>
                     <xhtml:section xml:lang="cs"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:laud="https://www.mzk.cz/ns/libri-augmentati/udpipe/1.0"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Konverze analýzy UDPipe do XML</xhtml:h2>
                        <xhtml:p>Převede výstup analýzy ve formátu JSON na dokument ve formátu XML.</xhtml:p>
                     </xhtml:section>
                  </documentation>
                  <call step="p:variable"
                        name="debug">
                     <parameter name="select"
                                value="$debug-path || '' ne ''"/>
                  </call>
                  <call step="p:variable"
                        name="debug-path-uri">
                     <parameter name="select"
                                value="resolve-uri($debug-path, $base-uri)"/>
                  </call>
                  <call step="p:variable"
                        name="model">
                     <parameter name="select"
                                value="normalize-space(.?model)"/>
                  </call>
                  <call step="p:if">
                     <parameter name="test"
                                value="$debug"/>
                     <parameter name="p:store"
                                value=""/>
                  </call>
                  <call step="p:identity">
                     <parameter name="p:documentation"
                                value="&#xA;    &#xA;     Convert JSON to plain text without escaping characters.&#xA;    &#xA;    &#xA;     Převod formátu JSON do TXT bez zbytečných escapovaných textů.&#xA;    &#xA;   "/>
                     <port name="source"/>
                  </call>
                  <call step="p:if">
                     <parameter name="test"
                                value="$debug"/>
                     <parameter name="p:store"
                                value=""/>
                  </call>
                  <call step="p:xslt">
                     <parameter name="version"
                                value="3.0"/>
                     <port name="stylesheet">
                        <parameter name="href"
                                   value="../xslt/udpipe/udpipe-json-to-text.xsl"/>
                     </port>
                  </call>
                  <call step="p:if">
                     <parameter name="test"
                                value="$debug"/>
                     <parameter name="p:store"
                                value=""/>
                  </call>
               </body>
            </step>
            <step type="laud:get-udpipe-analyses"
                  name="getting-udpipe-analyses">
               <prolog>
                  <documentation length="419">
                     <xhtml:section xml:lang="en"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:laud="https://www.mzk.cz/ns/libri-augmentati/udpipe/1.0"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Get UDPipe (Universal Dependencies) analyses</xhtml:h2>
                        <xhtml:p>For each page of the virtual document, it gets its text, sends it to the REST interface of the <xhtml:a href="https://lindat.mff.cuni.cz/services/udpipe/"
                                    alt="UDPipe">UDPipe</xhtml:a> service, converts the result to XML format and stores it in a folder.</xhtml:p>
                     </xhtml:section>
                     <xhtml:section xml:lang="cs"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:laud="https://www.mzk.cz/ns/libri-augmentati/udpipe/1.0"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Analýzy textu UDPipe (Universal Dependencies)</xhtml:h2>
                        <xhtml:p>Pro každou stránku virtuálního dokumentu získá její text, odešle ho na RESTové rozhraní služby <xhtml:a href="https://lindat.mff.cuni.cz/services/udpipe/"
                                    alt="UDPipe">UDPipe</xhtml:a>, výsledek konvertuje do formátu XML a uloží do složky.</xhtml:p>
                     </xhtml:section>
                  </documentation>
                  <namespaces>
                     <namespace prefix="c"
                                value="http://www.w3.org/ns/xproc-step"/>
                     <namespace prefix="lad"
                                value="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"/>
                     <namespace prefix="las"
                                value="https://www.mzk.cz/ns/libri-augmentati/settings/1.0"/>
                     <namespace prefix="laud"
                                value="https://www.mzk.cz/ns/libri-augmentati/udpipe/1.0"/>
                     <namespace prefix="p"
                                value="http://www.w3.org/ns/xproc"/>
                     <namespace prefix="xhtml"
                                value="http://www.w3.org/1999/xhtml"/>
                     <namespace prefix="xs"
                                value="http://www.w3.org/2001/XMLSchema"/>
                     <namespace prefix="xml"
                                value="http://www.w3.org/XML/1998/namespace"/>
                  </namespaces>
                  <options>
                     <option name="debug-path"
                             select="()"
                             as="xs:string?"/>
                     <option name="base-uri"
                             as="xs:anyURI"
                             select="static-base-uri()"/>
                     <option name="output-directory"
                             required="true"
                             as="xs:string"/>
                  </options>
                  <ports>
                     <input port="source"
                            primary="true"/>
                     <input port="settings"
                            primary="false"/>
                     <input port="report-in"
                            primary="false"/>
                     <output port="result"
                             primary="true"
                             pipe="@final"/>
                     <output port="report"
                             pipe="result@final-report"/>
                  </ports>
               </prolog>
               <body>
                  <documentation length="419">
                     <xhtml:section xml:lang="en"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:laud="https://www.mzk.cz/ns/libri-augmentati/udpipe/1.0"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Get UDPipe (Universal Dependencies) analyses</xhtml:h2>
                        <xhtml:p>For each page of the virtual document, it gets its text, sends it to the REST interface of the <xhtml:a href="https://lindat.mff.cuni.cz/services/udpipe/"
                                    alt="UDPipe">UDPipe</xhtml:a> service, converts the result to XML format and stores it in a folder.</xhtml:p>
                     </xhtml:section>
                     <xhtml:section xml:lang="cs"
                                    xmlns:lad="https://www.mzk.cz/ns/libri-augmentati/documents/1.0"
                                    xmlns:laud="https://www.mzk.cz/ns/libri-augmentati/udpipe/1.0"
                                    xmlns:las="https://www.mzk.cz/ns/libri-augmentati/settings/1.0">
                        <xhtml:h2>Analýzy textu UDPipe (Universal Dependencies)</xhtml:h2>
                        <xhtml:p>Pro každou stránku virtuálního dokumentu získá její text, odešle ho na RESTové rozhraní služby <xhtml:a href="https://lindat.mff.cuni.cz/services/udpipe/"
                                    alt="UDPipe">UDPipe</xhtml:a>, výsledek konvertuje do formátu XML a uloží do složky.</xhtml:p>
                     </xhtml:section>
                  </documentation>
                  <call step="p:variable"
                        name="debug">
                     <parameter name="select"
                                value="$debug-path || '' ne ''"/>
                  </call>
                  <call step="p:variable"
                        name="debug-path-uri">
                     <parameter name="select"
                                value="resolve-uri($debug-path, $base-uri)"/>
                  </call>
                  <call step="p:variable"
                        name="result-directory-path">
                     <parameter name="select"
                                value="concat($output-directory, '/udpipe')"/>
                     <parameter name="p:documentation"
                                value="&#xA;    &#xA;     The folder where downloaded documents are saved. The path to the folder can be absolute or relative.&#xA;    &#xA;    &#xA;     Složka, do níž se uloží stažené dokumenty. Cesta ke složce může být absolutní i relativní.&#xA;    &#xA;   "/>
                  </call>
                  <call step="p:variable"
                        name="result-directory-uri">
                     <parameter name="select"
                                value="resolve-uri($result-directory-path, $base-uri)"/>
                  </call>
                  <call step="p:variable"
                        name="language">
                     <parameter name="select"
                                value="/lad:document/@language"/>
                  </call>
                  <call step="p:if">
                     <parameter name="test"
                                value="$debug"/>
                     <parameter name="p:store"
                                value="&#xA;    &#xA;   "/>
                  </call>
                  <call step="p:identity"/>
                  <call step="p:viewport">
                     <parameter name="match"
                                value="lad:pages/lad:page/lad:resource[@type='text'][@local-file-exists='true']"/>
                     <parameter name="use-when"
                                value="true()"/>
                     <port name="anonymous">
                        <parameter name="pipe"
                                   value="source@getting-udpipe-analyses"/>
                     </port>
                     <parameter name="p:variable"
                                value=""/>
                     <parameter name="p:if"
                                value="&#xA;    &#xA;    &#xA;    &#xA;    &#xA;    &#xA;    &#xA;    &#xA;    &#xA;     &#xA;     &#xA;     &#xA;     &#xA;     &#xA;      &#xA;       &#xA;        &#xA;       &#xA;      &#xA;      &#xA;       &#xA;       &#xA;       &#xA;       &#xA;      &#xA;      &#xA;       &#xA;        &#xA;       &#xA;       &#xA;      &#xA;     &#xA;     &#xA;     &#xA;      &#xA;     &#xA;     &#xA;     &#xA;      &#xA;      &#xA;     &#xA;     &#xA;     &#xA;      &#xA;     &#xA;     &#xA;     &#xA;     &#xA;     &#xA;      &#xA;     &#xA;     &#xA;     &#xA;      &#xA;          &#xA;    &#xA;    &#xA;    &#xA;     &#xA;      &#xA;     &#xA;    &#xA;    &#xA;    &#xA;    &#xA;     &#xA;    &#xA;    &#xA;   "/>
                  </call>
                  <call step="p:identity"
                        name="final"/>
                  <call step="p:if">
                     <parameter name="test"
                                value="$debug"/>
                     <parameter name="p:store"
                                value=""/>
                  </call>
                  <call step="p:identity"
                        name="metadata"/>
                  <call step="p:insert"
                        name="final-report">
                     <parameter name="match"
                                value="laud:report/laud:result"/>
                     <parameter name="position"
                                value="last-child"/>
                     <parameter name="p:documentation"
                                value="Doplnění zprávy o zpracovaných prvcích."/>
                     <port name="source">
                        <parameter name="pipe"
                                   value="source@getting-udpipe-analyses"/>
                     </port>
                     <port name="insertion">
                        <parameter name="pipe"
                                   value="@metadata"/>
                     </port>
                  </call>
               </body>
            </step>
         </body>
      </library>
   </analysis>
</xpan:report>